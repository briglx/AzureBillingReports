{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "## Azure WAF Cost Assessment Workbook\r\n### Change Log\r\n\r\n|Version|Date|Description|\r\n|---|---|---|\r\n|v1.1.1| 20/09/2021 | Initial Release\r\n|v1.1.2| 25/09/2021 | Sort resource groups and tags filter alphabetically\r\n|v1.1.3| 03/10/2021 |-Added export button to applicable queries<br>-Remove developer and express from SQL VMs query<br>-Fixed typo in overview tab notes<br>-Linux AHUB-filter RedHat and Suse only<br>-Added changelog\r\n|v1.1.4| 20/10/2021 | -Fixed bug in performance tab NIC drop down <br>-Added subscription filter to performance tab<br>-Added TimeRange parameter<br>-Added search filter field for the Resources tagged tile in the ResourceDetails group under Performance tab<br>-Fixed issue in VMs performance query<br>Simplified WebApps and AKS queries to avoid throttling\r\n|v1.1.5| 01/11/2021 | -Fixed Tag filter parameters to avoid empty tags in queries <br> -Fixed tag queries for performance and better results <br> -Fixed empty queries messages <br>-Change style of guidance messages<br>-Fixed bug for unattached IPs reporting with NAT gateways|\r\n|v1.1.6| 24/11/2021 | -Show only application gateways with empty backendpools|\r\n|v1.1.7| 27/01/2022 | -Fixed bug for unattached IPs reporting with NAT gateways with Tag Filters <br> -Added check for idle NICs with attached Public IPs|\r\n|v1.1.8| 16/02/2022 | -Added untagged resources list <br> -Added storage account tiers <br> -Added a link to storage account insights for each legacy storage account <br> -Added AHUB check for windows VMSS <br> -Fixed unattached disk query <br> -Fixed App service query (not showing all apps in a service plan) <br> -Added \"Cost Information\" tab|\r\n|v1.1.9| 14/06/2022 | - Fixed \"unattached disk\" query in the cost information tab |\r\n|v1.2.0| 24/07/2022 | - Removed FileStorage account type from V2 query <br> - Added new column in \"Cost Information\" tab to show total VM cost with AHUB <br> - Changed VPN metrics aggregation <br> - Changed column some names |\r\n|v1.2.1| 08/11/2022 | - Add Front Door metrics <br> - Changed cost information billing for VMs without AHUB to TheLastBillingMonth <br> - Increased row limit to in compute queries  <br> - Updated AKS query to show Spot VMs  <br> - Fixed Linux AHUB query to show RHEL license <br> - Add subscriptions advisor recommendations |\r\n|v1.2.2| December/2022 | - Minor fix to the Storage Advisor query |\r\n|v1.3.0 | March /2023 | - Fixed Cost Information Tab |\r\n|v2.0.0 | March /2023 | - Added Azure Hybrid Benefit tab|\r\n"
      },
      "conditionalVisibility": {
        "parameterName": "isVisible",
        "comparison": "isEqualTo",
        "value": "Never"
      },
      "name": "text - 12"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "ca40468d-4518-43bf-ac6e-0a11d7331e12",
            "cellValue": "SelectedTab",
            "linkTarget": "parameter",
            "linkLabel": "General",
            "subTarget": "General",
            "style": "link"
          },
          {
            "id": "96d6402c-ff6c-4cf8-961d-8fbe5c98be60",
            "cellValue": "SelectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Compute",
            "subTarget": "Compute",
            "preText": "VirtualMachines",
            "style": "link"
          },
          {
            "id": "34014531-76a5-4eab-9772-9944fa241fea",
            "cellValue": "SelectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Azure Hybrid Benefit",
            "subTarget": "AHUB",
            "style": "link"
          },
          {
            "id": "4f4786a7-c2df-4788-b5b6-63057bc0c24a",
            "cellValue": "SelectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Storage",
            "subTarget": "Storage",
            "style": "link"
          },
          {
            "id": "69dfc3f7-5937-49ba-9851-d6d2973a0c69",
            "cellValue": "SelectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Networking",
            "subTarget": "Networking",
            "style": "link"
          },
          {
            "id": "8a907379-c82a-4636-8b1a-903655992145",
            "cellValue": "SelectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Log Analytics",
            "subTarget": "Monitoring",
            "style": "link"
          },
          {
            "id": "ea5226fe-c21b-4af7-8ed3-cb84a06b3c81",
            "cellValue": "SelectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Reservations Dashboard",
            "subTarget": "Reservations",
            "style": "link"
          },
          {
            "id": "feefdffe-9b9b-4480-a0dd-3a2751cab365",
            "cellValue": "SelectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Cost Information",
            "subTarget": "CostInformation",
            "style": "link"
          }
        ]
      },
      "name": "links - 4"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "51aa3a9b-14e0-4c22-a60d-abdbf8813f00",
            "version": "KqlParameterItem/1.0",
            "name": "Subscription",
            "type": 6,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "includeAll": true,
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "defaultValue": "value::all"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isNotEqualTo",
        "value": "CostInformation"
      },
      "name": "parameters - 0"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "4b846956-4fa8-4d35-b396-74a87200f819",
            "version": "KqlParameterItem/1.0",
            "name": "RG_Filter",
            "label": "Filter By",
            "type": 2,
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "jsonData": "[\r\n    { \"value\":\"Resource Group\",\"selected\":\"true\"},\r\n    { \"value\":\"Tags\" }\r\n]",
            "timeContext": {
              "durationMs": 86400000
            }
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "SelectedTab",
          "comparison": "isNotEqualTo",
          "value": "General"
        },
        {
          "parameterName": "SelectedTab",
          "comparison": "isNotEqualTo",
          "value": "CostInformation"
        }
      ],
      "name": "parameters - 2"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "crossComponentResources": [
          "{Subscription}"
        ],
        "parameters": [
          {
            "id": "6cb303fd-4812-4097-a468-a177d8782913",
            "version": "KqlParameterItem/1.0",
            "name": "ResourceGroup",
            "label": "Resource Group",
            "type": 2,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "resourceContainers | where type == 'microsoft.resources/subscriptions/resourcegroups'\r\n| project resourceGroup\r\n| sort by resourceGroup asc",
            "crossComponentResources": [
              "{Subscription}"
            ],
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "defaultValue": "value::all",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "value": [
              "value::all"
            ]
          }
        ],
        "style": "pills",
        "queryType": 1,
        "resourceType": "microsoft.resourcegraph/resources"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "RG_Filter",
          "comparison": "isEqualTo",
          "value": "Resource Group"
        },
        {
          "parameterName": "SelectedTab",
          "comparison": "isNotEqualTo",
          "value": "General"
        },
        {
          "parameterName": "SelectedTab",
          "comparison": "isNotEqualTo",
          "value": "CostInformation"
        }
      ],
      "name": "parameters - 2"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "crossComponentResources": [
          "{Subscription}"
        ],
        "parameters": [
          {
            "id": "df2a5339-2dd6-478a-a2b1-2dce7651ed0a",
            "version": "KqlParameterItem/1.0",
            "name": "TagName",
            "label": "Tag Name",
            "type": 2,
            "isRequired": true,
            "query": "Resources\r\n| where tags != '' and tags != '[]'\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| distinct tagName\r\n| sort by tagName asc",
            "crossComponentResources": [
              "{Subscription}"
            ],
            "value": "ssv2excludevm",
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          }
        ],
        "style": "pills",
        "queryType": 1,
        "resourceType": "microsoft.resourcegraph/resources"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "RG_Filter",
          "comparison": "isEqualTo",
          "value": "Tags"
        },
        {
          "parameterName": "SelectedTab",
          "comparison": "isNotEqualTo",
          "value": "General"
        }
      ],
      "customWidth": "20",
      "name": "parameters - 3"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "crossComponentResources": [
          "{Subscription}"
        ],
        "parameters": [
          {
            "id": "d28a3428-b806-4716-a4c5-9f9816224aef",
            "version": "KqlParameterItem/1.0",
            "name": "TagValue",
            "type": 2,
            "isRequired": true,
            "query": "Resources\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tags != '' and tags != '[]' and tostring(bag_keys(tags)[0]) == '{TagName}'\r\n| distinct tagValue\r\n| sort by tagValue asc",
            "crossComponentResources": [
              "{Subscription}"
            ],
            "value": "true",
            "typeSettings": {
              "additionalResourceOptions": []
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          }
        ],
        "style": "pills",
        "queryType": 1,
        "resourceType": "microsoft.resourcegraph/resources"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "SelectedTab",
          "comparison": "isNotEqualTo",
          "value": "General"
        },
        {
          "parameterName": "RG_Filter",
          "comparison": "isEqualTo",
          "value": "Tags"
        },
        {
          "parameterName": "TagName",
          "comparison": "isNotEqualTo"
        }
      ],
      "customWidth": "20",
      "name": "parameters - 13"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Networking Group",
        "items": [
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "advisorresources\r\n| where type == \"microsoft.advisor/recommendations\"\r\n| where tostring (properties.category) has \"Cost\"\r\n| where properties.impactedField has \"Network\"\r\n| project AffectedResource=tostring(properties.resourceMetadata.resourceId),Impact=properties.impact,resourceGroup,AdditionaInfo=properties.extendedProperties,subscriptionId,Recommendation=tostring(properties.shortDescription.problem),name\r\n| where resourceGroup in ({ResourceGroup})",
                    "size": 0,
                    "title": "Azure advisor recommendations - Networking",
                    "noDataMessage": "You are following all of our cost recommendations for Networking",
                    "noDataMessageStyle": 3,
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "Recommendation"
                        ],
                        "expandTopLevel": true
                      }
                    }
                  },
                  "name": "query - 12"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# Recommendations for Application Gateways\r\nReview Application Gateways which include backend pools with no targets. Resources listed with 2 red signs are considered idle.",
                    "style": "upsell"
                  },
                  "name": "text - 0"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where type =~ 'Microsoft.Network/applicationGateways' and resourceGroup in ({ResourceGroup})\r\n| extend backendPoolsCount = array_length(properties.backendAddressPools),SKUName= tostring(properties.sku.name), SKUTier= tostring(properties.sku.tier),SKUCapacity=properties.sku.capacity,backendPools=properties.backendAddressPools , AppGwId = tostring(id)\r\n| project AppGwId, name, SKUName, SKUTier, SKUCapacity\r\n| join (\r\n    resources\r\n    | where type =~ 'Microsoft.Network/applicationGateways' and resourceGroup in ({ResourceGroup})\r\n    | mvexpand backendPools = properties.backendAddressPools\r\n    | extend backendIPCount = array_length(backendPools.properties.backendIPConfigurations)\r\n    | extend backendAddressesCount = array_length(backendPools.properties.backendAddresses)\r\n    | extend backendPoolName  = backendPools.properties.backendAddressPools.name\r\n    | extend AppGwId = tostring(id)\r\n    | summarize backendIPCount = sum(backendIPCount) ,backendAddressesCount=sum(backendAddressesCount) by AppGwId\r\n) on AppGwId\r\n| project-away AppGwId1\r\n| where  (backendIPCount == 0 or isempty(backendIPCount)) and (backendAddressesCount==0 or isempty(backendAddressesCount))\r\n| order by AppGwId asc",
                    "size": 0,
                    "title": "Application gateways with empty backend pools",
                    "noDataMessage": "You don't have any Application Gateways with empty backendpools",
                    "noDataMessageStyle": 3,
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "SKUCapacity",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "backendIPCount",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "0",
                                "representation": "disabled",
                                "text": ""
                              },
                              {
                                "operator": ">",
                                "thresholdValue": "0",
                                "representation": "success",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "success",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "backendAddressesCount",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "0",
                                "representation": "disabled",
                                "text": ""
                              },
                              {
                                "operator": ">",
                                "thresholdValue": "0",
                                "representation": "success",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "success",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Recommendation",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "No Backend targets",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "green",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "backendPoolIPTarget",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": ">",
                                "thresholdValue": "0",
                                "representation": "success",
                                "text": ""
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "0",
                                "representation": "disabled",
                                "text": ""
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "success",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "backendPoolVMTarget",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "is Empty",
                                "representation": "disabled",
                                "text": ""
                              },
                              {
                                "operator": ">",
                                "thresholdValue": "0",
                                "representation": "success",
                                "text": ""
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "success",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Recommednation",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "No Backend targets",
                                "representation": "redBright",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "green",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  },
                  "name": "query - 1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# Recommendations for Load Balancers\r\nReview Load balancers with no backend pools, and remove them if not needed.",
                    "style": "upsell"
                  },
                  "name": "text - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.network/loadbalancers' and tostring(properties.backendAddressPools) == '[]' \r\n| extend loadBalancerId=id,LBRG=resourceGroup, LoadBalancerName=name, SKU=sku, LBLocation=location\r\n| order by loadBalancerId asc\r\n| project loadBalancerId,LoadBalancerName, SKU.name,SKU.tier, LBLocation,LBRG, subscriptionId\r\n",
                    "size": 0,
                    "title": "Load Balancers with empty backend pools",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "subscriptionId",
                          "formatter": 15,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        }
                      ]
                    }
                  },
                  "name": "query - 3"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# Recommendations for Public IP Addresses\r\nReview unattached Public IP addresses, as they may represent additional cost.\r\n<br>This query will also show Public IPs attached to Idle network cards.\r\n",
                    "style": "upsell"
                  },
                  "name": "text - 4"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'Microsoft.Network/publicIPAddresses' and isempty(properties.ipConfiguration) and isempty(properties.natGateway) \r\n| extend PublicIpId=id, IPName=name, AllocationMethod=tostring(properties.publicIPAllocationMethod), SKUName=sku.name, Location=location \r\n| project PublicIpId,IPName, SKUName, resourceGroup, Location, AllocationMethod, subscriptionId\r\n| union (\r\n Resources \r\n | where type =~ 'microsoft.network/networkinterfaces' and isempty(properties.virtualMachine) and isnull(properties.privateEndpoint) and isnotempty(properties.ipConfigurations) \r\n | extend IPconfig = properties.ipConfigurations \r\n | mv-expand IPconfig \r\n | extend PublicIpId= tostring(IPconfig.properties.publicIPAddress.id)\r\n | project PublicIpId\r\n | join ( \r\n    resources \r\n    | where type =~ 'Microsoft.Network/publicIPAddresses'\r\n    | extend PublicIpId=id, IPName=name, AllocationMethod=tostring(properties.publicIPAllocationMethod), SKUName=sku.name, resourceGroup, Location=location \r\n ) on PublicIpId\r\n | project PublicIpId,IPName, SKUName, resourceGroup, Location, AllocationMethod, subscriptionId\r\n)\r\n",
                    "size": 0,
                    "title": "Unattached Public IPs",
                    "noDataMessage": "You have no unattached Public IPs",
                    "noDataMessageStyle": 3,
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "subscriptionId",
                          "formatter": 15,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        }
                      ]
                    }
                  },
                  "name": "query - 5"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# Recommendations for Azure Firewall\r\nReview Azure Firewall without network traffic. These resources are billed hourly, consider reconfiguring or deleting them if they are not in use.\r\n\r\n\r\n",
                    "style": "upsell"
                  },
                  "name": "text - 6"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "parameters": [
                      {
                        "id": "c5002ea2-7587-4816-99f5-1a2c37bb6160",
                        "version": "KqlParameterItem/1.0",
                        "name": "Firewall",
                        "label": "Azure Firewall",
                        "type": 5,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "resources\r\n| where type == \"microsoft.network/azurefirewalls\" and resourceGroup in ({ResourceGroup})\r\n| project id",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "typeSettings": {
                          "additionalResourceOptions": [
                            "value::all"
                          ],
                          "showDefault": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "defaultValue": "value::all",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources"
                      },
                      {
                        "id": "d6c92c8d-762c-4a63-88d0-830719b008cd",
                        "version": "KqlParameterItem/1.0",
                        "name": "TimeRangeFirewall",
                        "label": "Time range",
                        "type": 4,
                        "isRequired": true,
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 604800000
                            },
                            {
                              "durationMs": 1209600000
                            },
                            {
                              "durationMs": 2419200000
                            },
                            {
                              "durationMs": 2592000000
                            },
                            {
                              "durationMs": 5184000000
                            },
                            {
                              "durationMs": 7776000000
                            }
                          ],
                          "allowCustom": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": {
                          "durationMs": 2419200000
                        }
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.resourcegraph/resources"
                  },
                  "name": "parameters - 8"
                },
                {
                  "type": 10,
                  "content": {
                    "chartId": "workbookc9b8f2a1-5ab7-4815-8ea2-474bcfca994b",
                    "version": "MetricsItem/2.0",
                    "size": 0,
                    "chartType": 0,
                    "resourceType": "microsoft.network/azurefirewalls",
                    "metricScope": 0,
                    "resourceParameter": "Firewall",
                    "resourceIds": [
                      "{Firewall}"
                    ],
                    "timeContextFromParameter": "TimeRangeFirewall",
                    "timeContext": {
                      "durationMs": 2419200000
                    },
                    "metrics": [
                      {
                        "namespace": "microsoft.network/azurefirewalls",
                        "metric": "microsoft.network/azurefirewalls--DataProcessed",
                        "aggregation": 1
                      },
                      {
                        "namespace": "microsoft.network/azurefirewalls",
                        "metric": "microsoft.network/azurefirewalls--Throughput",
                        "aggregation": 4
                      }
                    ],
                    "title": "Azure Firewalls",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Subscription",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Name",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": "Resource",
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "microsoft.network/azurefirewalls--DataProcessed",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "is Empty",
                                "representation": "redDark",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "text": "{0}{1}"
                              }
                            ]
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal"
                            },
                            "emptyValCustomText": "0"
                          }
                        },
                        {
                          "columnMatch": "microsoft.network/azurefirewalls--DataProcessed Timeline",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "microsoft.network/azurefirewalls--Throughput",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "is Empty",
                                "representation": "redDark",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "text": "{0}{1}"
                              }
                            ]
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal"
                            },
                            "emptyValCustomText": "0"
                          }
                        },
                        {
                          "columnMatch": "microsoft.network/azurefirewalls--Throughput Timeline",
                          "formatter": 5
                        }
                      ],
                      "rowLimit": 10000,
                      "labelSettings": [
                        {
                          "columnId": "microsoft.network/azurefirewalls--DataProcessed",
                          "label": "Data processed (Sum)"
                        },
                        {
                          "columnId": "microsoft.network/azurefirewalls--DataProcessed Timeline",
                          "label": "Data processed Timeline"
                        },
                        {
                          "columnId": "microsoft.network/azurefirewalls--Throughput",
                          "label": "Throughput (Average)"
                        },
                        {
                          "columnId": "microsoft.network/azurefirewalls--Throughput Timeline",
                          "label": "Throughput Timeline"
                        }
                      ]
                    }
                  },
                  "name": "metric - 7"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# Recommendations for VPN Gateways\r\nReview VPN Gateways without network traffic. These gateways are billed hourly, consider reconfiguring or deleting them if they are not in use.",
                    "style": "upsell"
                  },
                  "name": "text - 9"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "parameters": [
                      {
                        "id": "abd9fd4f-3b1e-4d70-80d2-6948bfcf3a2f",
                        "version": "KqlParameterItem/1.0",
                        "name": "VPNGatewaySubscription",
                        "label": "Virtual network gateways",
                        "type": 5,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "Resources \r\n| where type =~ \"microsoft.network/virtualnetworkgateways\" and properties.gatewayType == \"Vpn\" and resourceGroup in ({ResourceGroup})\r\n| project id",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "typeSettings": {
                          "additionalResourceOptions": [
                            "value::all"
                          ],
                          "showDefault": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "defaultValue": "value::all",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources"
                      },
                      {
                        "id": "28f5f184-3c04-4c0e-8715-30686f64263e",
                        "version": "KqlParameterItem/1.0",
                        "name": "TimeRangeVPN",
                        "label": "Time Range",
                        "type": 4,
                        "value": {
                          "durationMs": 1209600000
                        },
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 604800000
                            },
                            {
                              "durationMs": 1209600000
                            },
                            {
                              "durationMs": 2419200000
                            },
                            {
                              "durationMs": 2592000000
                            },
                            {
                              "durationMs": 5184000000
                            },
                            {
                              "durationMs": 7776000000
                            }
                          ]
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      }
                    ],
                    "style": "pills",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources"
                  },
                  "name": "parameters - 10"
                },
                {
                  "type": 10,
                  "content": {
                    "chartId": "workbooka9ea46a6-d16a-43b9-a30d-81475a76a12a",
                    "version": "MetricsItem/2.0",
                    "size": 0,
                    "chartType": 0,
                    "resourceType": "microsoft.network/virtualnetworkgateways",
                    "metricScope": 0,
                    "resourceParameter": "VPNGatewaySubscription",
                    "resourceIds": [
                      "{VPNGatewaySubscription}"
                    ],
                    "timeContextFromParameter": "TimeRangeVPN",
                    "timeContext": {
                      "durationMs": 1209600000
                    },
                    "metrics": [
                      {
                        "namespace": "microsoft.network/virtualnetworkgateways",
                        "metric": "microsoft.network/virtualnetworkgateways-Traffic-TunnelTotalFlowCount",
                        "aggregation": 7
                      },
                      {
                        "namespace": "microsoft.network/virtualnetworkgateways",
                        "metric": "microsoft.network/virtualnetworkgateways-Traffic-TunnelAverageBandwidth",
                        "aggregation": 3
                      },
                      {
                        "namespace": "microsoft.network/virtualnetworkgateways",
                        "metric": "microsoft.network/virtualnetworkgateways-Traffic-P2SBandwidth",
                        "aggregation": 3
                      },
                      {
                        "namespace": "microsoft.network/virtualnetworkgateways",
                        "metric": "microsoft.network/virtualnetworkgateways-Traffic-AverageBandwidth",
                        "aggregation": 3
                      },
                      {
                        "namespace": "microsoft.network/virtualnetworkgateways",
                        "metric": "microsoft.network/virtualnetworkgateways-Traffic-P2SConnectionCount",
                        "aggregation": 7
                      }
                    ],
                    "title": "Virtual network gateways",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Subscription",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Name",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": "Resource"
                          }
                        },
                        {
                          "columnMatch": "microsoft.network/virtualnetworkgateways-Traffic-TunnelTotalFlowCount Timeline",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "microsoft.network/virtualnetworkgateways-Traffic-TunnelTotalFlowCount",
                          "formatter": 1,
                          "numberFormat": {
                            "unit": 0,
                            "options": null
                          }
                        },
                        {
                          "columnMatch": "microsoft.network/virtualnetworkgateways-Traffic-TunnelAverageBandwidth Timeline",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "microsoft.network/virtualnetworkgateways-Traffic-TunnelAverageBandwidth",
                          "formatter": 1,
                          "numberFormat": {
                            "unit": 11,
                            "options": null
                          }
                        },
                        {
                          "columnMatch": "microsoft.network/virtualnetworkgateways-Traffic-P2SConnectionCount Timeline",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "microsoft.network/virtualnetworkgateways-Traffic-P2SConnectionCount",
                          "formatter": 1,
                          "numberFormat": {
                            "unit": 0,
                            "options": null
                          }
                        },
                        {
                          "columnMatch": "microsoft.network/virtualnetworkgateways-Traffic-P2SBandwidth Timeline",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "microsoft.network/virtualnetworkgateways-Traffic-P2SBandwidth",
                          "formatter": 1,
                          "numberFormat": {
                            "unit": 11,
                            "options": null
                          }
                        },
                        {
                          "columnMatch": "microsoft.network/virtualnetworkgateways-Traffic-AverageBandwidth Timeline",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "microsoft.network/virtualnetworkgateways-Traffic-AverageBandwidth",
                          "formatter": 1,
                          "numberFormat": {
                            "unit": 11,
                            "options": null
                          }
                        },
                        {
                          "columnMatch": "Metric",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Aggregation",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Value",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Timeline",
                          "formatter": 9
                        },
                        {
                          "columnMatch": "microsoft.network/virtualnetworkgateways-Performance-ExpressRouteGatewayPacketsPerSecond",
                          "formatter": 1,
                          "numberFormat": {
                            "unit": 31,
                            "options": null
                          }
                        }
                      ],
                      "rowLimit": 10000,
                      "labelSettings": [
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-TunnelTotalFlowCount",
                          "label": "Tunnel Total Flow Count (Count)"
                        },
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-TunnelTotalFlowCount Timeline",
                          "label": "Tunnel Total Flow Count Timeline"
                        },
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-TunnelAverageBandwidth",
                          "label": "Tunnel Bandwidth (Average)"
                        },
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-TunnelAverageBandwidth Timeline",
                          "label": "Tunnel Bandwidth Timeline"
                        },
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-P2SBandwidth",
                          "label": "Gateway P2S Bandwidth (Average)"
                        },
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-P2SBandwidth Timeline",
                          "label": "Gateway P2S Bandwidth Timeline"
                        },
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-AverageBandwidth",
                          "label": "Gateway S2S Bandwidth (Average)"
                        },
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-AverageBandwidth Timeline",
                          "label": "Gateway S2S Bandwidth Timeline"
                        },
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-P2SConnectionCount",
                          "label": "P2S Connection Count (Count)"
                        },
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-P2SConnectionCount Timeline",
                          "label": "P2S Connection Count Timeline"
                        }
                      ]
                    }
                  },
                  "name": "metric - 11"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# Recommendations for Azure Front Door\r\nReview Azure Front Doors without network traffic. These resources are billed hourly, consider reconfiguring or deleting them if they are not in use.",
                    "style": "upsell"
                  },
                  "name": "text - 13"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "parameters": [
                      {
                        "id": "2e8b2804-6fc1-4ce5-b4b4-c76a68d37c6f",
                        "version": "KqlParameterItem/1.0",
                        "name": "AzureFrontDoor",
                        "label": "Azure Front Door",
                        "type": 5,
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "Resources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ \"microsoft.network/frontdoors\" or (type =~ 'microsoft.cdn/profiles' and kind =~ 'frontdoor')\r\n| project id",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "typeSettings": {
                          "additionalResourceOptions": [
                            "value::all"
                          ],
                          "showDefault": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "defaultValue": "value::all",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources"
                      },
                      {
                        "id": "52337af0-ed30-4ddb-b888-dd7567d7e469",
                        "version": "KqlParameterItem/1.0",
                        "name": "TimeRangeFrontDoor",
                        "label": "Time Range",
                        "type": 4,
                        "isRequired": true,
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 604800000
                            },
                            {
                              "durationMs": 1209600000
                            },
                            {
                              "durationMs": 2419200000
                            },
                            {
                              "durationMs": 2592000000
                            },
                            {
                              "durationMs": 5184000000
                            },
                            {
                              "durationMs": 7776000000
                            }
                          ]
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": {
                          "durationMs": 2592000000
                        }
                      }
                    ],
                    "style": "pills",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources"
                  },
                  "name": "parameters - 14"
                },
                {
                  "type": 10,
                  "content": {
                    "chartId": "workbook078c4654-5fee-406c-9895-a775ae351a98",
                    "version": "MetricsItem/2.0",
                    "size": 0,
                    "chartType": 2,
                    "resourceType": "microsoft.network/frontdoors",
                    "metricScope": 0,
                    "resourceParameter": "AzureFrontDoor",
                    "resourceIds": [
                      "{AzureFrontDoor}"
                    ],
                    "timeContextFromParameter": "TimeRangeFrontDoor",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "metrics": [
                      {
                        "namespace": "microsoft.network/frontdoors",
                        "metric": "microsoft.network/frontdoors--RequestCount",
                        "aggregation": 1,
                        "splitBy": null
                      }
                    ],
                    "title": "Azure Frontdoors",
                    "gridSettings": {
                      "rowLimit": 10000
                    }
                  },
                  "name": "metric - 15"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "RG_Filter",
              "comparison": "isNotEqualTo",
              "value": "Tags"
            },
            "name": "networking - Subscription"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "advisorresources\r\n| where type == \"microsoft.advisor/recommendations\"\r\n| where tostring (properties.category) has \"Cost\"\r\n| where (properties.impactedField) has \"Network\"\r\n| project AffectedResource=tolower(tostring(properties.resourceMetadata.resourceId)),Impact=properties.impact,resourceGroup,AdditionaInfo=properties.extendedProperties,subscriptionId,Recommendation=tostring(properties.shortDescription.problem),AffectedResourceName=tostring(properties.impactedValue)\r\n| join ( resources\r\n    | where type has \"Microsoft.Network\"\r\n    | extend AffectedResource=tolower(id)\r\n) on AffectedResource\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| project  AffectedResource, Impact,resourceGroup,AdditionaInfo, tagName, tagValue,Recommendation, SubscriptionName=subscriptionId",
                    "size": 0,
                    "title": "Azure advisor recommendations - Networking",
                    "noDataMessage": "You are following all Networking Advisor recommendations!",
                    "noDataMessageStyle": 3,
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "Recommendation"
                        ],
                        "expandTopLevel": true
                      }
                    }
                  },
                  "name": "query - 12"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# Recommendations for Application Gateways\r\nReview Application Gateways which include backend pools with no targets. Resources listed with 2 red signs are considered idle. \r\n",
                    "style": "upsell"
                  },
                  "name": "text - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where type =~ 'Microsoft.Network/applicationGateways'\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| extend backendPoolsCount = array_length(properties.backendAddressPools),SKUName= tostring(properties.sku.name), SKUTier= tostring(properties.sku.tier),SKUCapacity=properties.sku.capacity,backendPools=properties.backendAddressPools , AppGwId = tostring(id)\r\n| project AppGwId, name, SKUName, SKUTier, SKUCapacity\r\n| join (\r\n    resources\r\n    | where type =~ 'Microsoft.Network/applicationGateways' and (isnotempty(tags) and isnotnull(tags))\r\n    | mvexpand backendPools = properties.backendAddressPools\r\n    | extend backendIPCount = array_length(backendPools.properties.backendIPConfigurations)\r\n    | extend backendAddressesCount = array_length(backendPools.properties.backendAddresses)\r\n    | extend backendPoolName  = backendPools.properties.backendAddressPools.name\r\n    | extend AppGwId = tostring(id)\r\n    | summarize backendIPCount = sum(backendIPCount) ,backendAddressesCount=sum(backendAddressesCount) by AppGwId\r\n) on AppGwId\r\n| project-away AppGwId1\r\n| where  (backendIPCount == 0 or isempty(backendIPCount)) and (backendAddressesCount==0 or isempty(backendAddressesCount))\r\n| order by AppGwId asc",
                    "size": 0,
                    "title": "Application gateways with empty backend pools",
                    "noDataMessage": "You don't have any Application Gateways with empty backendpools",
                    "noDataMessageStyle": 3,
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "backendIPCount",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "0",
                                "representation": "disabled",
                                "text": ""
                              },
                              {
                                "operator": ">",
                                "thresholdValue": "0",
                                "representation": "success",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "success",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "backendAddressesCount",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "0",
                                "representation": "disabled",
                                "text": ""
                              },
                              {
                                "operator": ">",
                                "thresholdValue": "0",
                                "representation": "success",
                                "text": ""
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "success",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "tagName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Tags",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "tagValue",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Tags",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "backendPoolIPTarget",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": ">",
                                "thresholdValue": "0",
                                "representation": "success",
                                "text": ""
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "0",
                                "representation": "disabled",
                                "text": ""
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "success",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "backendPoolVMTarget",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "is Empty",
                                "representation": "disabled",
                                "text": ""
                              },
                              {
                                "operator": ">",
                                "thresholdValue": "0",
                                "representation": "success",
                                "text": ""
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "success",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  },
                  "name": "query - 0"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# Recommendations for Load Balancers\r\nReview Load balancers with no backend pools, and remove them if not needed.",
                    "style": "upsell"
                  },
                  "name": "text - 2"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where type =~ 'microsoft.network/loadbalancers'\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where tostring(properties.backendAddressPools) == '[]'\r\n| extend Details=id, LoadBalancerName=name, SKUname=sku.name,SkuTier=sku.tier, LBLocation=location, SubscriptionName=subscriptionId\r\n| project Details,LoadBalancerName,SKUname,SkuTier, LBLocation,tagName,tagValue,SubscriptionName\r\n| order by Details asc",
                    "size": 0,
                    "title": "Load balancers with empty backend pools found",
                    "noDataMessage": "You don't have any Azure Load Balancers!",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "tagName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Tags",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "tagValue",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Tags",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  },
                  "name": "query - 3"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# Recommendations for Public IP Addresses\r\nReview unattached Public IP addresses, as they may represent aditional cost.\r\n<br>This query will also show Public IPs attached to Idle network cards",
                    "style": "upsell"
                  },
                  "name": "text - 4"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where type =~ 'Microsoft.Network/publicIPAddresses'\r\n| where isempty(properties.ipConfiguration) and isempty(properties.natGateway) \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| extend PublicIpId=id, IPName=name, AllocationMethod=tostring(properties.publicIPAllocationMethod), SKUName=sku.name,resourceGroup, Location=location, SubscriptionName=subscriptionId\r\n| project PublicIpId,IPName, SKUName, resourceGroup, Location,tagName,tagValue, AllocationMethod, subscriptionId\r\n| union (\r\n Resources \r\n | where type =~ 'microsoft.network/networkinterfaces' and isempty(properties.virtualMachine) and isnull(properties.privateEndpoint) and isnotempty(properties.ipConfigurations)\r\n | extend IPconfig = properties.ipConfigurations \r\n | mv-expand IPconfig \r\n | extend PublicIpId= tostring(IPconfig.properties.publicIPAddress.id)\r\n | project PublicIpId\r\n | join ( \r\n    resources \r\n    | where type =~ 'Microsoft.Network/publicIPAddresses'\r\n    | where isnotempty(tags) and isnotnull(tags)\r\n    | mvexpand tags\r\n    | extend tagName = tostring(bag_keys(tags)[0])\r\n    | extend tagValue = tostring(tags[tagName])\r\n    | where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n    | extend PublicIpId=id, IPName=name, AllocationMethod=tostring(properties.publicIPAllocationMethod), SKUName=sku.name,resourceGroup, Location=location \r\n ) on PublicIpId\r\n | project PublicIpId,IPName, SKUName, resourceGroup, Location,tagName,tagValue, AllocationMethod, subscriptionId\r\n)\r\n",
                    "size": 0,
                    "title": "Unattached Public IPs",
                    "noDataMessage": "You don't have any unattached Public IPs",
                    "noDataMessageStyle": 3,
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "tagName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Tags",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "tagValue",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Tags",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  },
                  "name": "query - 5"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# Recommendations for Azure Firewall\r\nReview Azure Firewall without network traffic. These resources are billed hourly, consider reconfiguring or deleting them if they are not in use.",
                    "style": "upsell"
                  },
                  "name": "text - 6"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "parameters": [
                      {
                        "id": "b1762aaa-cd4a-4f72-bbfe-55c016908fb5",
                        "version": "KqlParameterItem/1.0",
                        "name": "FirewallTags",
                        "label": "Azure Firewall",
                        "type": 5,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": " resources\r\n| where type == \"microsoft.network/azurefirewalls\"\r\n| mvexpand tags\r\n| where tostring(bag_keys(tags)[0]) has '{TagName}' and tostring(tags['{TagName}']) has '{TagValue}'\r\n| project id\r\n",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "typeSettings": {
                          "additionalResourceOptions": [
                            "value::all"
                          ],
                          "showDefault": false
                        },
                        "timeContext": {
                          "durationMs": 2592000000
                        },
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "value": [
                          "value::all"
                        ]
                      },
                      {
                        "id": "784c94cb-7a2b-4b90-9f33-37389e809ab9",
                        "version": "KqlParameterItem/1.0",
                        "name": "TimeRangeFirewallTag",
                        "label": "Time range",
                        "type": 4,
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 300000
                            },
                            {
                              "durationMs": 900000
                            },
                            {
                              "durationMs": 1800000
                            },
                            {
                              "durationMs": 3600000
                            },
                            {
                              "durationMs": 14400000
                            },
                            {
                              "durationMs": 43200000
                            },
                            {
                              "durationMs": 86400000
                            },
                            {
                              "durationMs": 172800000
                            },
                            {
                              "durationMs": 259200000
                            },
                            {
                              "durationMs": 604800000
                            },
                            {
                              "durationMs": 1209600000
                            },
                            {
                              "durationMs": 2419200000
                            },
                            {
                              "durationMs": 2592000000
                            },
                            {
                              "durationMs": 5184000000
                            },
                            {
                              "durationMs": 7776000000
                            }
                          ]
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": {
                          "durationMs": 172800000
                        }
                      }
                    ],
                    "style": "pills",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources"
                  },
                  "name": "parameters - 7"
                },
                {
                  "type": 10,
                  "content": {
                    "chartId": "workbookf564883d-19b5-4838-80f9-d4ed5e7c73c2",
                    "version": "MetricsItem/2.0",
                    "size": 0,
                    "chartType": 2,
                    "resourceType": "microsoft.network/azurefirewalls",
                    "metricScope": 0,
                    "resourceParameter": "FirewallTags",
                    "resourceIds": [
                      "{FirewallTags}"
                    ],
                    "timeContextFromParameter": "TimeRangeFirewallTag",
                    "timeContext": {
                      "durationMs": 172800000
                    },
                    "metrics": [],
                    "title": "Azure Firewalls",
                    "gridSettings": {
                      "rowLimit": 10000
                    }
                  },
                  "name": "metric - 8"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# Recommendations for VPN Gateways\r\nReview VPN Gateways without network traffic. These gateways are billed hourly, consider reconfiguring or deleting them if they are not in use.",
                    "style": "upsell"
                  },
                  "name": "text - 9"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "parameters": [
                      {
                        "id": "e6cb9ce7-8251-4c94-9687-de5351ac1171",
                        "version": "KqlParameterItem/1.0",
                        "name": "VPNGatewaysTags",
                        "label": "Virtual network gateways",
                        "type": 5,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "Resources \r\n| where type =~ \"microsoft.network/virtualnetworkgateways\" and properties.gatewayType == \"Vpn\"\r\n| mvexpand tags\r\n| where tostring(bag_keys(tags)[0]) has '{TagName}' and tostring(tags['{TagName}']) has '{TagValue}'\r\n| project id\r\n",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "typeSettings": {
                          "additionalResourceOptions": [
                            "value::all"
                          ],
                          "showDefault": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "defaultValue": "value::all",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources"
                      },
                      {
                        "id": "13d85fc1-3da8-49c3-a6b1-26baa0fae24a",
                        "version": "KqlParameterItem/1.0",
                        "name": "TimeRangeVPNTags",
                        "label": "Time Range",
                        "type": 4,
                        "value": {
                          "durationMs": 5184000000
                        },
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 604800000
                            },
                            {
                              "durationMs": 1209600000
                            },
                            {
                              "durationMs": 2419200000
                            },
                            {
                              "durationMs": 2592000000
                            },
                            {
                              "durationMs": 5184000000
                            },
                            {
                              "durationMs": 7776000000
                            }
                          ]
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      }
                    ],
                    "style": "pills",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources"
                  },
                  "name": "parameters - 10"
                },
                {
                  "type": 10,
                  "content": {
                    "chartId": "workbook42ac488e-882e-4001-859f-86f54b10564c",
                    "version": "MetricsItem/2.0",
                    "size": 0,
                    "chartType": 0,
                    "resourceType": "microsoft.network/virtualnetworkgateways",
                    "metricScope": 0,
                    "resourceParameter": "VPNGatewaysTags",
                    "resourceIds": [
                      "{VPNGatewaysTags}"
                    ],
                    "timeContextFromParameter": "TimeRangeVPNTags",
                    "timeContext": {
                      "durationMs": 5184000000
                    },
                    "metrics": [
                      {
                        "namespace": "microsoft.network/virtualnetworkgateways",
                        "metric": "microsoft.network/virtualnetworkgateways-Traffic-TunnelTotalFlowCount",
                        "aggregation": 1
                      },
                      {
                        "namespace": "microsoft.network/virtualnetworkgateways",
                        "metric": "microsoft.network/virtualnetworkgateways-Traffic-TunnelAverageBandwidth",
                        "aggregation": 4
                      },
                      {
                        "namespace": "microsoft.network/virtualnetworkgateways",
                        "metric": "microsoft.network/virtualnetworkgateways-Traffic-P2SBandwidth",
                        "aggregation": 4
                      },
                      {
                        "namespace": "microsoft.network/virtualnetworkgateways",
                        "metric": "microsoft.network/virtualnetworkgateways-Traffic-AverageBandwidth",
                        "aggregation": 4
                      }
                    ],
                    "title": "Virtual network gateways",
                    "tileSettings": {
                      "showBorder": false,
                      "titleContent": {
                        "columnMatch": "Name",
                        "formatter": 13
                      },
                      "leftContent": {
                        "columnMatch": "Value",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    },
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Subscription",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Name",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": "Resource"
                          }
                        },
                        {
                          "columnMatch": "Metric",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Aggregation",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Value",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Timeline",
                          "formatter": 9
                        },
                        {
                          "columnMatch": "microsoft.network/virtualnetworkgateways-Traffic-TunnelTotalFlowCount",
                          "formatter": 1,
                          "numberFormat": {
                            "unit": 0,
                            "options": null
                          }
                        },
                        {
                          "columnMatch": "microsoft.network/virtualnetworkgateways-Traffic-TunnelAverageBandwidth",
                          "formatter": 1,
                          "numberFormat": {
                            "unit": 11,
                            "options": null
                          }
                        },
                        {
                          "columnMatch": "microsoft.network/virtualnetworkgateways-Traffic-P2SBandwidth",
                          "formatter": 1,
                          "numberFormat": {
                            "unit": 11,
                            "options": null
                          }
                        },
                        {
                          "columnMatch": "microsoft.network/virtualnetworkgateways-Traffic-AverageBandwidth",
                          "formatter": 1,
                          "numberFormat": {
                            "unit": 11,
                            "options": null
                          }
                        }
                      ],
                      "rowLimit": 10000,
                      "labelSettings": [
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-TunnelTotalFlowCount",
                          "label": "Tunnel Total Flow Count (Sum)"
                        },
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-TunnelTotalFlowCount Timeline",
                          "label": "Tunnel Total Flow Count Timeline"
                        },
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-TunnelAverageBandwidth",
                          "label": "Tunnel Bandwidth (Average)"
                        },
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-TunnelAverageBandwidth Timeline",
                          "label": "Tunnel Bandwidth Timeline"
                        },
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-P2SBandwidth",
                          "label": "Gateway P2S Bandwidth (Average)"
                        },
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-P2SBandwidth Timeline",
                          "label": "Gateway P2S Bandwidth Timeline"
                        },
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-AverageBandwidth",
                          "label": "Gateway S2S Bandwidth (Average)"
                        },
                        {
                          "columnId": "microsoft.network/virtualnetworkgateways-Traffic-AverageBandwidth Timeline",
                          "label": "Gateway S2S Bandwidth Timeline"
                        }
                      ]
                    }
                  },
                  "name": "metric - 11"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# Recommendations for Azure Front Door\r\nReview Azure Front Doors without network traffic. These front doors are billed hourly, consider reconfiguring or deleting them if they are not in use.\r\n",
                    "style": "upsell"
                  },
                  "name": "text - 13"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "crossComponentResources": [
                      ""
                    ],
                    "parameters": [
                      {
                        "id": "b2836f22-1d25-4398-88a0-fb6a60a2d1c5",
                        "version": "KqlParameterItem/1.0",
                        "name": "AzureFrontDoorTags",
                        "label": "Azure Front Door",
                        "type": 5,
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "resources\r\n| where type =~ 'microsoft.network/frontdoors' or (type =~ 'microsoft.cdn/profiles' and kind =~ 'frontdoor')\r\n| mvexpand tags\r\n| where tostring(bag_keys(tags)[0]) has '{TagName}' and tostring(tags['{TagName}']) has '{TagValue}'\r\n| project id\r\n",
                        "crossComponentResources": [
                          ""
                        ],
                        "typeSettings": {
                          "additionalResourceOptions": [
                            "value::all"
                          ],
                          "showDefault": false
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "defaultValue": "value::all",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "value": [
                          "value::all"
                        ]
                      },
                      {
                        "id": "88c7d0b5-c110-4251-acc0-866e422f2fce",
                        "version": "KqlParameterItem/1.0",
                        "name": "TimerRangeTags",
                        "label": "Time Range",
                        "type": 4,
                        "isRequired": true,
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 604800000
                            },
                            {
                              "durationMs": 1209600000
                            },
                            {
                              "durationMs": 2419200000
                            },
                            {
                              "durationMs": 2592000000
                            },
                            {
                              "durationMs": 5184000000
                            },
                            {
                              "durationMs": 7776000000
                            }
                          ]
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": {
                          "durationMs": 1209600000
                        }
                      }
                    ],
                    "style": "pills",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources"
                  },
                  "name": "parameters - 14"
                },
                {
                  "type": 10,
                  "content": {
                    "chartId": "workbooka4c0fdec-299b-4537-990d-8348f2888416",
                    "version": "MetricsItem/2.0",
                    "size": 0,
                    "chartType": 2,
                    "resourceType": "microsoft.cdn/profiles",
                    "metricScope": 0,
                    "resourceParameter": "AzureFrontDoorTags",
                    "resourceIds": [
                      "{AzureFrontDoorTags}"
                    ],
                    "timeContextFromParameter": "TimerRangeTags",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "metrics": [
                      {
                        "namespace": "microsoft.cdn/profiles",
                        "metric": "microsoft.cdn/profiles--RequestCount",
                        "aggregation": 1,
                        "splitBy": null
                      }
                    ],
                    "title": "Azure Front Door",
                    "gridSettings": {
                      "rowLimit": 10000
                    }
                  },
                  "name": "metric - 15"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "RG_Filter",
              "comparison": "isEqualTo",
              "value": "Tags"
            },
            "name": "networking - Tags"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isEqualTo",
        "value": "Networking"
      },
      "name": "NetworkingGroup",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Cost Information",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Subscription}"
              ],
              "parameters": [
                {
                  "id": "fffccc1f-fc7d-497c-b45b-29417117b862",
                  "version": "KqlParameterItem/1.0",
                  "name": "Subscription",
                  "type": 6,
                  "isRequired": true,
                  "value": "/subscriptions/1283e053-2e46-449f-87d6-842ef6df3272",
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "includeAll": true
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  }
                }
              ],
              "style": "pills",
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources"
            },
            "name": "parameters - 0"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "1b71c24e-3e21-4598-a1c4-10106dcdfeca",
                  "version": "KqlParameterItem/1.0",
                  "name": "RG_Filter",
                  "label": "Filter By",
                  "type": 2,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[\r\n    { \"value\":\"Resource Group\",\"selected\":\"true\"},\r\n    { \"value\":\"Tags\" }\r\n]",
                  "timeContext": {
                    "durationMs": 86400000
                  }
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "conditionalVisibility": {
              "parameterName": "SelectedTab",
              "comparison": "isNotEqualTo",
              "value": "General"
            },
            "name": "parameters - 5"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Subscription}"
              ],
              "parameters": [
                {
                  "id": "42099afa-2462-4f0e-88be-b87bb1d3c908",
                  "version": "KqlParameterItem/1.0",
                  "name": "ResourceGroup",
                  "label": "Resource Group",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "\"",
                  "delimiter": ",",
                  "query": "resourceContainers | where type == 'microsoft.resources/subscriptions/resourcegroups'\r\n| project resourceGroup\r\n| sort by resourceGroup asc",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "defaultValue": "value::all",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                }
              ],
              "style": "pills",
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "RG_Filter",
                "comparison": "isEqualTo",
                "value": "Resource Group"
              },
              {
                "parameterName": "SelectedTab",
                "comparison": "isNotEqualTo",
                "value": "General"
              }
            ],
            "name": "parameters - 6"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Subscription}"
              ],
              "parameters": [
                {
                  "id": "90a85a21-e4f8-48e6-92cb-87aa64a11f3b",
                  "version": "KqlParameterItem/1.0",
                  "name": "TagName",
                  "label": "Tag Name",
                  "type": 2,
                  "isRequired": true,
                  "query": "Resources\r\n| where tags != '' and tags != '[]'\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| distinct tagName\r\n| sort by tagName asc",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "value": "ssv2excludevm",
                  "typeSettings": {
                    "additionalResourceOptions": []
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.resourcegraph/resources"
            },
            "customWidth": "20",
            "conditionalVisibilities": [
              {
                "parameterName": "RG_Filter",
                "comparison": "isEqualTo",
                "value": "Tags"
              },
              {
                "parameterName": "SelectedTab",
                "comparison": "isNotEqualTo",
                "value": "General"
              }
            ],
            "name": "parameters - 7"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Subscription}"
              ],
              "parameters": [
                {
                  "id": "8bd3bf68-2f67-4bf7-a72a-c87817fc172c",
                  "version": "KqlParameterItem/1.0",
                  "name": "TagValue",
                  "label": "Tag Value",
                  "type": 2,
                  "isRequired": true,
                  "query": "Resources\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tags != '' and tags != '[]' and tostring(bag_keys(tags)[0]) == '{TagName}'\r\n| distinct tagValue\r\n| sort by tagValue asc",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "value": "true",
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                }
              ],
              "style": "pills",
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources"
            },
            "customWidth": "20",
            "conditionalVisibilities": [
              {
                "parameterName": "RG_Filter",
                "comparison": "isEqualTo",
                "value": "Tags"
              },
              {
                "parameterName": "SelectedTab",
                "comparison": "isNotEqualTo",
                "value": "General"
              },
              {
                "parameterName": "TagName",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "parameters - 8"
          },
          {
            "type": 1,
            "content": {
              "json": "# This Tab will show Information about idle resource that have impact on cost\r\n### Note: The cost information available  in this tab relates to the previous month.  If the resources was created less than 30 days ago, check the cost management and billing blade.\r\n### *Billing reader permission as a minimum is needed to populate cost information"
            },
            "name": "text - 1"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":\"{\\r\\n\\t\\\"type\\\": \\\"Usage\\\",\\r\\n\\t\\\"timeframe\\\": \\\"TheLastBillingMonth\\\",\\r\\n\\t\\\"dataset\\\": {\\r\\n\\t\\t\\\"granularity\\\": \\\"None\\\",\\r\\n\\t\\t\\\"filter\\\": {\\r\\n\\t\\t\\t\\\"and\\\": [\\r\\n\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\\"dimensions\\\": {\\r\\n\\t\\t\\t\\t\\t\\t\\\"name\\\": \\\"resourceType\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\\"operator\\\": \\\"In\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\\"values\\\": [\\r\\n\\t\\t\\t\\t\\t\\t\\t\\\"microsoft.compute/disks\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\t\\\"microsoft.network/applicationgateways\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\t\\\"microsoft.network/loadbalancers\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\t\\\"microsoft.network/publicIPAddresses\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\t\\\"microsoft.Compute/VirtualMachines\\\"\\r\\n\\t\\t\\t\\t\\t\\t]\\r\\n\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t},\\r\\n\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\\"dimensions\\\": {\\r\\n\\t\\t\\t\\t\\t\\t\\\"name\\\": \\\"ResourceGroup\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\\"operator\\\": \\\"In\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\\"values\\\": [\\r\\n\\t\\t\\t\\t\\t\\t\\t{ResourceGroup}\\r\\n\\t\\t\\t\\t\\t\\t\\t]\\r\\n\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t}\\r\\n\\t\\t\\t]\\r\\n\\t\\t},\\r\\n\\t\\t\\\"aggregation\\\": {\\r\\n\\t\\t\\t\\\"totalCost\\\": {\\r\\n\\t\\t\\t\\t\\\"name\\\": \\\"PreTaxCost\\\",\\r\\n\\t\\t\\t\\t\\\"function\\\": \\\"Sum\\\"\\r\\n\\t\\t\\t}\\r\\n\\t\\t},\\r\\n\\t\\t\\\"grouping\\\": [\\r\\n\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\\"type\\\": \\\"Dimension\\\",\\r\\n\\t\\t\\t\\t\\\"name\\\": \\\"ResourceId\\\"\\r\\n\\t\\t\\t}\\r\\n\\t\\t]\\r\\n\\t}\\r\\n}\",\"headers\":[],\"method\":\"POST\",\"path\":\"/subscriptions/{Subscription:id}/providers/Microsoft.CostManagement/query?\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2019-11-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.properties\",\"columns\":[]}}]}",
                    "size": 0,
                    "title": "GeCostIdleResources",
                    "queryType": 12,
                    "gridSettings": {
                      "sortBy": [
                        {
                          "itemKey": "ResourceId",
                          "sortOrder": 2
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "ResourceId",
                        "sortOrder": 2
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isVisible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "query - GeCostIdleResources"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources \r\n| where type =~ 'microsoft.compute/disks' and resourceGroup in ({ResourceGroup})\r\n| extend diskState = tostring(properties.diskState)\r\n| where managedBy == \"\" and diskState != 'ActiveSAS'\r\nor diskState == 'Unattached' and diskState != 'ActiveSAS'\r\n| extend DiskID=id, DiskName=name, SKUName=sku.name, SKUTier=sku.tier, DiskSizeGB=tostring(properties.diskSizeGB),DiskRG=resourceGroup, Location=location, TimeCreated=tostring(properties.timeCreated)\r\n| order by id asc \r\n| project DiskID,DiskName, DiskSizeGB, SKUName, SKUTier, DiskRG, Location, TimeCreated, subscriptionId",
                    "size": 0,
                    "title": "Unattached Disks",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isVisible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "query - GetUnattachedDisks"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\",\"mergeType\":\"innerunique\",\"leftTable\":\"query - GeCostIdleResources\",\"rightTable\":\"query - GetUnattachedDisks\",\"leftColumn\":\"ResourceId\",\"rightColumn\":\"DiskID\"}],\"projectRename\":[{\"originalName\":\"[query - GeCostIdleResources].PreTaxCost\",\"mergedName\":\"PreTaxCost\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GeCostIdleResources].ResourceId\",\"mergedName\":\"ResourceId\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GeCostIdleResources].Currency\",\"mergedName\":\"Currency\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].DiskID\",\"mergedName\":\"DiskID\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].DiskName\",\"mergedName\":\"DiskName\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].DiskSizeGB\",\"mergedName\":\"DiskSizeGB\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].DiskRG\",\"mergedName\":\"DiskRG\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].Location\",\"mergedName\":\"Location\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].TimeCreated\",\"mergedName\":\"TimeCreated\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetAllDisksCost].ResourceId\"},{\"originalName\":\"[query - GetUnattachedDisks].DiskName\"}]}",
                    "size": 0,
                    "title": "Unattached Managed Disks cost",
                    "showExportToExcel": true,
                    "exportToExcelOptions": "all",
                    "queryType": 7
                  },
                  "showPin": false,
                  "name": "query - Unattaached Disks Cost"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.network/loadbalancers' and tostring(properties.backendAddressPools) == '[]' \r\n| extend Details=id,LBRG=resourceGroup, LoadBalancerName=name, SKU=sku, LBLocation=location\r\n| order by id asc\r\n| project Details,LoadBalancerName, SKU.name,SKU.tier, LBLocation,LBRG, subscriptionId\r\n",
                          "size": 0,
                          "title": "query - GetUnattachedLoadBalancers",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "isVisible",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - GetUnattachedLoadBalancers"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"a4f6422d-06bc-42c4-809c-708dd791208a\",\"mergeType\":\"innerunique\",\"leftTable\":\"query - GeCostIdleResources\",\"rightTable\":\"query - GetUnattachedLoadBalancers\",\"leftColumn\":\"ResourceId\",\"rightColumn\":\"Details\"}],\"projectRename\":[{\"originalName\":\"[query - GeCostIdleResources].PreTaxCost\",\"mergedName\":\"PreTaxCost\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GeCostIdleResources].ResourceId\",\"mergedName\":\"ResourceId\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GeCostIdleResources].Currency\",\"mergedName\":\"Currency\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GetUnattachedLoadBalancers].Details\",\"mergedName\":\"Details\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GetUnattachedLoadBalancers].LoadBalancerName\",\"mergedName\":\"LoadBalancerName\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GetUnattachedLoadBalancers].SKU_name\",\"mergedName\":\"SKU_name\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GetUnattachedLoadBalancers].SKU_tier\",\"mergedName\":\"SKU_tier\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GetUnattachedLoadBalancers].LBLocation\",\"mergedName\":\"LBLocation\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GetUnattachedLoadBalancers].LBRG\",\"mergedName\":\"LBRG\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GetUnattachedLoadBalancers].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GetAllLoadBalancers].ResourceId\"},{\"originalName\":\"[query - GetUnattachedLoadBalancers].LoadBalancerName\"}]}",
                          "size": 0,
                          "title": "Unattached Load balancers Cost",
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 7
                        },
                        "showPin": false,
                        "name": "Merge - Unattaached Load balancers Cost"
                      }
                    ]
                  },
                  "name": "Load Balancer"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type =~ 'Microsoft.Network/applicationGateways' and resourceGroup in ({ResourceGroup})\r\n| extend backendPoolsCount = array_length(properties.backendAddressPools),SKUName= tostring(properties.sku.name), SKUTier= tostring(properties.sku.tier),SKUCapacity=properties.sku.capacity,backendPools=properties.backendAddressPools\r\n| project id, name, SKUName, SKUTier, SKUCapacity\r\n| join (\r\n    resources\r\n    | where type =~ 'Microsoft.Network/applicationGateways' and resourceGroup in ({ResourceGroup})\r\n    | mvexpand backendPools = properties.backendAddressPools\r\n    | extend backendIPCount = array_length(backendPools.properties.backendIPConfigurations)\r\n    | extend backendAddressesCount = array_length(backendPools.properties.backendAddresses)\r\n    | extend backendPoolName  = backendPools.properties.backendAddressPools.name\r\n    | summarize backendIPCount = sum(backendIPCount) ,backendAddressesCount=sum(backendAddressesCount) by id\r\n) on id\r\n| project-away id1\r\n| where  (backendIPCount == 0 or isempty(backendIPCount)) and (backendAddressesCount==0 or isempty(backendAddressesCount))\r\n| order by id asc",
                          "size": 0,
                          "title": "Unattached Application Gateways",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "isVisible",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - GetUnattachedApplicationGWs"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\",\"mergeType\":\"innerunique\",\"leftTable\":\"query - GeCostIdleResources\",\"rightTable\":\"query - GetUnattachedApplicationGWs\",\"leftColumn\":\"ResourceId\",\"rightColumn\":\"id\"}],\"projectRename\":[{\"originalName\":\"[query - GeCostIdleResources].PreTaxCost\",\"mergedName\":\"PreTaxCost\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GeCostIdleResources].ResourceId\",\"mergedName\":\"ResourceId\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GeCostIdleResources].Currency\",\"mergedName\":\"Currency\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GetUnattachedApplicationGWs].id\",\"mergedName\":\"id\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GetUnattachedApplicationGWs].name\",\"mergedName\":\"name\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GetUnattachedApplicationGWs].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GetUnattachedApplicationGWs].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GetUnattachedApplicationGWs].SKUCapacity\",\"mergedName\":\"SKUCapacity\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GetUnattachedApplicationGWs].backendIPCount\",\"mergedName\":\"backendIPCount\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GetUnattachedApplicationGWs].backendAddressesCount\",\"mergedName\":\"backendAddressesCount\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GetAllApplicationGWs].ResourceId\"},{\"originalName\":\"[query - GetUnattachedApplicationGWs].name\"}]}",
                          "size": 0,
                          "title": "Idle Application Gateways Cost",
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 7
                        },
                        "name": "query - Unattached ApplicationGWs Cost"
                      }
                    ]
                  },
                  "name": "Application Gateway"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'Microsoft.Network/publicIPAddresses' and isempty(properties.ipConfiguration) and isempty(properties.natGateway) \r\n| extend IdleIP=id, IPName=name, AllocationMethod=tostring(properties.publicIPAllocationMethod), SKUName=sku.name, PIPRG=resourceGroup, Location=location \r\n| project IdleIP,IPName, SKUName, PIPRG, Location, AllocationMethod, subscriptionId\r\n| union (\r\n Resources \r\n | where type =~ 'microsoft.network/networkinterfaces' and isempty(properties.virtualMachine) and isnull(properties.privateEndpoint) and isnotempty(properties.ipConfigurations) \r\n | extend IPconfig = properties.ipConfigurations \r\n | mv-expand IPconfig \r\n | extend IdleIP= tostring(IPconfig.properties.publicIPAddress.id)\r\n | project IdleIP\r\n | join ( \r\n    resources \r\n    | where type =~ 'Microsoft.Network/publicIPAddresses'\r\n    | extend IdleIP=id, IPName=name, AllocationMethod=tostring(properties.publicIPAllocationMethod), SKUName=sku.name, PIPRG=resourceGroup, Location=location \r\n ) on IdleIP\r\n | project IdleIP,IPName, SKUName, PIPRG, Location, AllocationMethod, subscriptionId\r\n)\r\n",
                          "size": 0,
                          "title": "Unattached Public IP Addresses",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "isVisible",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - GetUnattachedPublicIPAddresses"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\",\"mergeType\":\"innerunique\",\"leftTable\":\"query - GeCostIdleResources\",\"rightTable\":\"query - GetUnattachedPublicIPAddresses\",\"leftColumn\":\"ResourceId\",\"rightColumn\":\"IdleIP\"}],\"projectRename\":[{\"originalName\":\"[query - GeCostIdleResources].PreTaxCost\",\"mergedName\":\"PreTaxCost\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GeCostIdleResources].ResourceId\",\"mergedName\":\"ResourceId\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GeCostIdleResources].Currency\",\"mergedName\":\"Currency\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GetUnattachedPublicIPAddresses].IdleIP\",\"mergedName\":\"IdleIP\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GetUnattachedPublicIPAddresses].IPName\",\"mergedName\":\"IPName\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GetUnattachedPublicIPAddresses].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GetUnattachedPublicIPAddresses].PIPRG\",\"mergedName\":\"PIPRG\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GetUnattachedPublicIPAddresses].Location\",\"mergedName\":\"Location\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GetUnattachedPublicIPAddresses].AllocationMethod\",\"mergedName\":\"AllocationMethod\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GetUnattachedPublicIPAddresses].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GetAllPublicIPAddresses].ResourceId\"}]}",
                          "size": 0,
                          "title": "Unattached Public IP addresses Cost",
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 7
                        },
                        "showPin": false,
                        "name": "query - Unattached Public IP addresses Cost"
                      }
                    ]
                  },
                  "name": "Public IP Address"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{Subscription:id}/providers/Microsoft.Compute/skus?$filter=location eq 'westus'\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2019-04-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*[?(@.resourceType=='virtualMachines')]\",\"columns\":[{\"path\":\"name\",\"columnid\":\"Name\"},{\"path\":\"capabilities[?(@.name=='vCPUs')].value\",\"columnid\":\"vCPUs\"}]}}]}",
                          "size": 0,
                          "title": "Get VM vCPU",
                          "queryType": 12
                        },
                        "conditionalVisibility": {
                          "parameterName": "isVisible",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - Get VM vCPU"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows' or tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType) == 'Windows'\r\n| where tostring(properties.['licenseType']) !has 'Windows' and tostring(properties.virtualMachineProfile.['licenseType']) !has 'Windows'\r\n| extend WindowsId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.offer), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType'])\r\n| order by type asc \r\n| project WindowsId,VMName,VMRG,VMSize, VMLocation,OSType, OsVersion,LicenseType",
                          "size": 0,
                          "title": "Windows VMs and VMSS without Azure Hybrid Benefit",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "isVisible",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - GetWindowsVMs-AHUB"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources \r\n| where type =~ 'microsoft.compute/virtualmachines' and (properties.storageProfile.imageReference.publisher == 'suse' or properties.storageProfile.imageReference.publisher=='RedHat')\r\n| where tostring(properties.['licenseType']) != 'SLES_BYOS' and tostring(properties.['licenseType']) != 'RHEL_BYOS' \r\n| extend linuxId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.offer), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']) \r\n    | order by VMSize asc \r\n    | where VMRG in ({ResourceGroup})\r\n    | project linuxId,VMName,VMRG, VMLocation,OSType, OsVersion,LicenseType, VMSize",
                          "size": 0,
                          "title": "Linux VMs without Azure Hybrid Benefit",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "isVisible",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - GetLinuxVMs-AHUB"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"a4f6422d-06bc-42c4-809c-708dd7912117\",\"mergeType\":\"innerunique\",\"leftTable\":\"query - GeCostIdleResources\",\"rightTable\":\"query - GetLinuxVMs-AHUB\",\"leftColumn\":\"ResourceId\",\"rightColumn\":\"linuxId\"},{\"id\":\"a4f6422d-06bc-42c4-809c-708dd7912118\",\"mergeType\":\"leftouter\",\"leftTable\":\"query - GetLinuxVMs-AHUB\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912118\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912118\"},{\"originalName\":\"[query - GeCostIdleResources].PreTaxCost\",\"mergedName\":\"Last Month Cost\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Last Month Cost with AHUB\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"Last Month Cost\",\"operator\":\"isNotNull\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"Last Month Cost\\\"] - [\\\"Approximate AHUB savings\\\"]\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"column\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Added column\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"Last Month Cost\",\"operator\":\"isNotNull\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"Last Month Cost\\\"] - [\\\"Approximate AHUB savings\\\"]\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"column\"}}]},{\"originalName\":\"[query - GeCostIdleResources].ResourceId\",\"mergedName\":\"ResourceId\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GeCostIdleResources].Currency\",\"mergedName\":\"Currency\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GetLinuxVMs-AHUB].linuxId\",\"mergedName\":\"linuxId\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GetLinuxVMs-AHUB].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GetLinuxVMs-AHUB].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GetLinuxVMs-AHUB].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GetLinuxVMs-AHUB].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GetLinuxVMs-AHUB].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GetLinuxVMs-AHUB].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GetLinuxVMs-AHUB].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GetAllVMs].ResourceId\"}]}",
                          "size": 0,
                          "title": "Approximate cost of Linux VMs without Hybrid Benefit enabled",
                          "showExportToExcel": true,
                          "queryType": 7
                        },
                        "showPin": false,
                        "name": "query - GetLinuxVM-AHUBCost"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\",\"mergeType\":\"innerunique\",\"leftTable\":\"query - GeCostIdleResources\",\"rightTable\":\"query - GetWindowsVMs-AHUB\",\"leftColumn\":\"ResourceId\",\"rightColumn\":\"WindowsId\"},{\"id\":\"a4f6422d-06bc-42c4-809c-708dd79120ff\",\"mergeType\":\"leftouter\",\"leftTable\":\"query - GetWindowsVMs-AHUB\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[query - GetWindowsVMs-AHUB].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120ff\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120ff\"},{\"originalName\":\"[query - GeCostIdleResources].PreTaxCost\",\"mergedName\":\"Last Month Cost\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Approximate AHUB savings\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"Last Month Cost\",\"operator\":\"isNotNull\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"Last Month Cost\\\"] * 0.4402\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"column\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Last Month Cost with AHUB\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"Last Month Cost\",\"operator\":\"isNotNull\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"Last Month Cost\\\"] - [\\\"Approximate AHUB savings\\\"]\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"column\"}}]},{\"originalName\":\"[query - GeCostIdleResources].Currency\",\"mergedName\":\"Currency\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GetWindowsVMs-AHUB].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GetWindowsVMs-AHUB].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GetWindowsVMs-AHUB].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GetWindowsVMs-AHUB].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GetWindowsVMs-AHUB].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GetWindowsVMs-AHUB].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GetWindowsVMs-AHUB].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GetAllVMs].ResourceId\"},{\"originalName\":\"[query - GeCostIdleResources].ResourceId\"}]}",
                          "size": 0,
                          "title": "Approximate cost of Windows VMs and VMSS without Hybrid Benefit enabled ",
                          "showExportToExcel": true,
                          "queryType": 7
                        },
                        "name": "query - GetWindowsVM-AHUBCost"
                      }
                    ]
                  },
                  "name": "Virtual Machines"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "RG_Filter",
              "comparison": "isEqualTo",
              "value": "Resource Group"
            },
            "name": "group - CostRG"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":\"{\\r\\n\\t\\\"type\\\": \\\"Usage\\\",\\r\\n\\t\\\"timeframe\\\": \\\"TheLastBillingMonth\\\",\\r\\n\\t\\\"dataset\\\": {\\r\\n\\t\\t\\\"granularity\\\": \\\"None\\\",\\r\\n\\t\\t\\\"filter\\\": {\\r\\n\\t\\t\\t\\t\\t\\\"dimensions\\\": {\\r\\n\\t\\t\\t\\t\\t\\t\\\"name\\\": \\\"resourceType\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\\"operator\\\": \\\"In\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\\"values\\\": [\\r\\n\\t\\t\\t\\t\\t\\t\\t\\\"microsoft.compute/disks\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\t\\\"microsoft.network/applicationgateways\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\t\\\"microsoft.network/loadbalancers\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\t\\\"microsoft.network/publicIPAddresses\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\t\\\"microsoft.Compute/VirtualMachines\\\"\\r\\n\\t\\t\\t\\t\\t\\t]\\r\\n\\t\\t\\t\\t\\t}\\r\\n\\t\\t},\\r\\n\\t\\t\\\"aggregation\\\": {\\r\\n\\t\\t\\t\\\"totalCost\\\": {\\r\\n\\t\\t\\t\\t\\\"name\\\": \\\"PreTaxCost\\\",\\r\\n\\t\\t\\t\\t\\\"function\\\": \\\"Sum\\\"\\r\\n\\t\\t\\t}\\r\\n\\t\\t},\\r\\n\\t\\t\\\"grouping\\\": [\\r\\n\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\\"type\\\": \\\"Dimension\\\",\\r\\n\\t\\t\\t\\t\\\"name\\\": \\\"ResourceId\\\"\\r\\n\\t\\t\\t}\\r\\n\\t\\t]\\r\\n\\t}\\r\\n}\",\"headers\":[],\"method\":\"POST\",\"path\":\"/subscriptions/{Subscription:id}/providers/Microsoft.CostManagement/query?\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2019-11-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.properties\",\"columns\":[]}}]}",
                    "size": 0,
                    "title": "GeCostIdleResources",
                    "queryType": 12,
                    "gridSettings": {
                      "sortBy": [
                        {
                          "itemKey": "ResourceId",
                          "sortOrder": 2
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "ResourceId",
                        "sortOrder": 2
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isVisible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "query - GeCostIdleResources"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where type =~ 'microsoft.compute/disks'\r\n| extend diskState = tostring(properties.diskState)\r\n| where managedBy == \"\" and diskState != 'ActiveSAS'\r\nor diskState == 'Unattached' and diskState != 'ActiveSAS'\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| extend DiskID=id, DiskName=name, SKUName=sku.name, SKUTier=sku.tier, DiskSizeGB=tostring(properties.diskSizeGB),DiskRG=resourceGroup, Location=location, TimeCreated=tostring(properties.timeCreated), SubscriptionName=subscriptionId \r\n| project DiskID,DiskName, DiskSizeGB, SKUName, SKUTier, DiskRG,tagName,tagValue, Location, TimeCreated, SubscriptionName\r\n| order by DiskID asc ",
                    "size": 0,
                    "title": "Unattached Disks",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isVisible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "query - GetUnattachedDisks"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\",\"mergeType\":\"innerunique\",\"leftTable\":\"query - GeCostIdleResources\",\"rightTable\":\"query - GetUnattachedDisks\",\"leftColumn\":\"ResourceId\",\"rightColumn\":\"DiskID\"}],\"projectRename\":[{\"originalName\":\"[query - GetUnattachedDisks].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - GetUnattachedDisks].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - GetUnattachedDisks].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - GeCostIdleResources].PreTaxCost\",\"mergedName\":\"PreTaxCost\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GeCostIdleResources].ResourceId\",\"mergedName\":\"ResourceId\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GeCostIdleResources].Currency\",\"mergedName\":\"Currency\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].DiskID\",\"mergedName\":\"DiskID\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].DiskName\",\"mergedName\":\"DiskName\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].DiskSizeGB\",\"mergedName\":\"DiskSizeGB\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].DiskRG\",\"mergedName\":\"DiskRG\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].Location\",\"mergedName\":\"Location\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].TimeCreated\",\"mergedName\":\"TimeCreated\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetAllDisksCost].ResourceId\"},{\"originalName\":\"[query - GetUnattachedDisks].DiskName\"}]}",
                    "size": 0,
                    "title": "Unattached Managed Disks cost",
                    "showExportToExcel": true,
                    "exportToExcelOptions": "all",
                    "queryType": 7
                  },
                  "showPin": false,
                  "name": "query - Unattaached Disks Cost"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources \r\n| where type =~ 'microsoft.network/loadbalancers' and tostring(properties.backendAddressPools) == '[]' \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| extend Details=id,LBRG=resourceGroup, LoadBalancerName=name, SKU=sku, LBLocation=location\r\n| order by id asc\r\n| project Details,LoadBalancerName, SKU.name,SKU.tier, LBLocation,LBRG, subscriptionId, tagName,tagValue\r\n",
                          "size": 0,
                          "title": "query - GetUnattachedLoadBalancers",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "isVisible",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - GetUnattachedLoadBalancers"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"a4f6422d-06bc-42c4-809c-708dd791208a\",\"mergeType\":\"innerunique\",\"leftTable\":\"query - GeCostIdleResources\",\"rightTable\":\"query - GetUnattachedLoadBalancers\",\"leftColumn\":\"ResourceId\",\"rightColumn\":\"Details\"}],\"projectRename\":[{\"originalName\":\"[query - GetUnattachedLoadBalancers].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - GetUnattachedLoadBalancers].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - GeCostIdleResources].PreTaxCost\",\"mergedName\":\"PreTaxCost\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GeCostIdleResources].ResourceId\",\"mergedName\":\"ResourceId\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GeCostIdleResources].Currency\",\"mergedName\":\"Currency\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GetUnattachedLoadBalancers].Details\",\"mergedName\":\"Details\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GetUnattachedLoadBalancers].LoadBalancerName\",\"mergedName\":\"LoadBalancerName\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GetUnattachedLoadBalancers].SKU_name\",\"mergedName\":\"SKU_name\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GetUnattachedLoadBalancers].SKU_tier\",\"mergedName\":\"SKU_tier\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GetUnattachedLoadBalancers].LBLocation\",\"mergedName\":\"LBLocation\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GetUnattachedLoadBalancers].LBRG\",\"mergedName\":\"LBRG\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GetUnattachedLoadBalancers].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd791208a\"},{\"originalName\":\"[query - GetAllLoadBalancers].ResourceId\"},{\"originalName\":\"[query - GetUnattachedLoadBalancers].LoadBalancerName\"}]}",
                          "size": 0,
                          "title": "Unattached Load balancers Cost",
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 7
                        },
                        "showPin": false,
                        "name": "Merge - Unattaached Load balancers Cost"
                      }
                    ]
                  },
                  "name": "Load Balancer"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type =~ 'Microsoft.Network/applicationGateways'\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| extend backendPoolsCount = array_length(properties.backendAddressPools),SKUName= tostring(properties.sku.name), SKUTier= tostring(properties.sku.tier),SKUCapacity=properties.sku.capacity,backendPools=properties.backendAddressPools\r\n| project id, name, SKUName, SKUTier, SKUCapacity, tagValue, tagName\r\n| join (\r\n    resources\r\n    | where type =~ 'Microsoft.Network/applicationGateways' \r\n    | mvexpand backendPools = properties.backendAddressPools\r\n    | extend backendIPCount = array_length(backendPools.properties.backendIPConfigurations)\r\n    | extend backendAddressesCount = array_length(backendPools.properties.backendAddresses)\r\n    | extend backendPoolName  = backendPools.properties.backendAddressPools.name\r\n    | summarize backendIPCount = sum(backendIPCount) ,backendAddressesCount=sum(backendAddressesCount) by id\r\n) on id\r\n| project-away id1\r\n| where  (backendIPCount == 0 or isempty(backendIPCount)) and (backendAddressesCount==0 or isempty(backendAddressesCount))\r\n| order by id asc",
                          "size": 0,
                          "title": "Unattached Application Gateways",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "isVisible",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - GetUnattachedApplicationGWs"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\",\"mergeType\":\"innerunique\",\"leftTable\":\"query - GeCostIdleResources\",\"rightTable\":\"query - GetUnattachedApplicationGWs\",\"leftColumn\":\"ResourceId\",\"rightColumn\":\"id\"}],\"projectRename\":[{\"originalName\":\"[query - GetUnattachedApplicationGWs].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - GetUnattachedApplicationGWs].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - GeCostIdleResources].PreTaxCost\",\"mergedName\":\"PreTaxCost\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GeCostIdleResources].ResourceId\",\"mergedName\":\"ResourceId\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GeCostIdleResources].Currency\",\"mergedName\":\"Currency\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GetUnattachedApplicationGWs].id\",\"mergedName\":\"id\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GetUnattachedApplicationGWs].name\",\"mergedName\":\"name\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GetUnattachedApplicationGWs].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GetUnattachedApplicationGWs].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GetUnattachedApplicationGWs].SKUCapacity\",\"mergedName\":\"SKUCapacity\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GetUnattachedApplicationGWs].backendIPCount\",\"mergedName\":\"backendIPCount\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GetUnattachedApplicationGWs].backendAddressesCount\",\"mergedName\":\"backendAddressesCount\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120a7\"},{\"originalName\":\"[query - GetAllApplicationGWs].ResourceId\"},{\"originalName\":\"[query - GetUnattachedApplicationGWs].name\"}]}",
                          "size": 0,
                          "title": "Idle Application Gateways Cost",
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 7
                        },
                        "name": "query - Unattached ApplicationGWs Cost"
                      }
                    ]
                  },
                  "name": "Application Gateway"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources \r\n| where type =~ 'Microsoft.Network/publicIPAddresses' and isempty(properties.ipConfiguration) and isempty(properties.natGateway) \r\n| extend IdleIP=id, IPName=name, AllocationMethod=tostring(properties.publicIPAllocationMethod), SKUName=sku.name, PIPRG=resourceGroup, Location=location \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| project IdleIP,IPName, SKUName, PIPRG, Location, AllocationMethod, subscriptionId, tagName, tagValue\r\n| union (\r\n Resources \r\n | where type =~ 'microsoft.network/networkinterfaces' and isempty(properties.virtualMachine) and isnull(properties.privateEndpoint) and isnotempty(properties.ipConfigurations) \r\n | extend IPconfig = properties.ipConfigurations \r\n | mv-expand IPconfig \r\n | extend IdleIP= tostring(IPconfig.properties.publicIPAddress.id)\r\n | project IdleIP\r\n | join ( \r\n    resources \r\n    | where type =~ 'Microsoft.Network/publicIPAddresses'\r\n    | extend IdleIP=id, IPName=name, AllocationMethod=tostring(properties.publicIPAllocationMethod), SKUName=sku.name, PIPRG=resourceGroup, Location=location \r\n ) on IdleIP\r\n | project IdleIP,IPName, SKUName, PIPRG, Location, AllocationMethod, subscriptionId\r\n)\r\n",
                          "size": 0,
                          "title": "Unattached Public IP Addresses",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "isVisible",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - GetUnattachedPublicIPAddresses"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\",\"mergeType\":\"innerunique\",\"leftTable\":\"query - GeCostIdleResources\",\"rightTable\":\"query - GetUnattachedPublicIPAddresses\",\"leftColumn\":\"ResourceId\",\"rightColumn\":\"IdleIP\"}],\"projectRename\":[{\"originalName\":\"[query - GetUnattachedPublicIPAddresses].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - GetUnattachedPublicIPAddresses].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - GeCostIdleResources].PreTaxCost\",\"mergedName\":\"PreTaxCost\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GeCostIdleResources].ResourceId\",\"mergedName\":\"ResourceId\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GeCostIdleResources].Currency\",\"mergedName\":\"Currency\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GetUnattachedPublicIPAddresses].IdleIP\",\"mergedName\":\"IdleIP\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GetUnattachedPublicIPAddresses].IPName\",\"mergedName\":\"IPName\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GetUnattachedPublicIPAddresses].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GetUnattachedPublicIPAddresses].PIPRG\",\"mergedName\":\"PIPRG\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GetUnattachedPublicIPAddresses].Location\",\"mergedName\":\"Location\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GetUnattachedPublicIPAddresses].AllocationMethod\",\"mergedName\":\"AllocationMethod\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GetUnattachedPublicIPAddresses].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120c0\"},{\"originalName\":\"[query - GetAllPublicIPAddresses].ResourceId\"}]}",
                          "size": 0,
                          "title": "Unattached Public IP addresses Cost",
                          "showExportToExcel": true,
                          "exportToExcelOptions": "all",
                          "queryType": 7
                        },
                        "showPin": false,
                        "name": "query - Unattached Public IP addresses Cost"
                      }
                    ]
                  },
                  "name": "Public IP Address"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{Subscription:id}/providers/Microsoft.Compute/skus?$filter=location eq 'westus'\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2019-04-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*[?(@.resourceType=='virtualMachines')]\",\"columns\":[{\"path\":\"name\",\"columnid\":\"Name\"},{\"path\":\"capabilities[?(@.name=='vCPUs')].value\",\"columnid\":\"vCPUs\"}]}}]}",
                          "size": 0,
                          "title": "Get VM vCPU",
                          "queryType": 12
                        },
                        "conditionalVisibility": {
                          "parameterName": "isVisible",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - Get VM vCPU"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets'\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows' or tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType) == 'Windows'\r\n| where tostring(properties.['licenseType']) !has 'Windows' and tostring(properties.virtualMachineProfile.['licenseType']) !has 'Windows'\r\n| extend WindowsId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.offer), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType'])\r\n| order by type asc \r\n| project WindowsId,VMName,VMRG,VMSize, VMLocation,OSType, OsVersion,LicenseType, tagValue, tagName",
                          "size": 0,
                          "title": "Windows VMs and VMSS without Azure Hybrid Benefit",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "isVisible",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - GetWindowsVMs-AHUB"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources \r\n| where type =~ 'microsoft.compute/virtualmachines' and (properties.storageProfile.imageReference.publisher == 'suse' or properties.storageProfile.imageReference.publisher=='RedHat')\r\n| where tostring(properties.['licenseType']) != 'SLES_BYOS' and tostring(properties.['licenseType']) != 'REHL_BYOS' \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| extend linuxId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.offer), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']) \r\n    | order by VMSize asc \r\n    | where VMRG in ({ResourceGroup})\r\n    | project linuxId,VMName,VMRG, VMLocation,OSType, OsVersion,LicenseType, VMSize, tagName, tagValue",
                          "size": 0,
                          "title": "Linux VMs without Azure Hybrid Benefit",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "isVisible",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - GetLinuxVMs-AHUB"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\",\"mergeType\":\"innerunique\",\"leftTable\":\"query - GeCostIdleResources\",\"rightTable\":\"query - GetWindowsVMs-AHUB\",\"leftColumn\":\"ResourceId\",\"rightColumn\":\"WindowsId\"},{\"id\":\"a4f6422d-06bc-42c4-809c-708dd79120ff\",\"mergeType\":\"leftouter\",\"leftTable\":\"query - GetWindowsVMs-AHUB\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Approximate AHUB savings\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"Last Month Cost\",\"operator\":\"isNotNull\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"Last Month Cost\\\"] * 0.4402\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"column\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Last Month Cost with AHUB\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"Last Month Cost\",\"operator\":\"isNotNull\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"Last Month Cost\\\"] - [\\\"Approximate AHUB savings\\\"]\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"column\"}}]},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120ff\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120ff\"},{\"originalName\":\"[query - GetWindowsVMs-AHUB].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - GetWindowsVMs-AHUB].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - GeCostIdleResources].PreTaxCost\",\"mergedName\":\"Last Month Cost\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GeCostIdleResources].ResourceId\",\"mergedName\":\"ResourceId\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GeCostIdleResources].Currency\",\"mergedName\":\"Currency\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GetWindowsVMs-AHUB].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GetWindowsVMs-AHUB].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GetWindowsVMs-AHUB].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GetWindowsVMs-AHUB].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GetWindowsVMs-AHUB].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GetWindowsVMs-AHUB].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GetWindowsVMs-AHUB].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GetWindowsVMs-AHUB].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd79120fb\"},{\"originalName\":\"[query - GetAllVMs].ResourceId\"}]}",
                          "size": 0,
                          "title": "Approximate cost of Windows VMs and VMSS without Hybrid Benefit enabled ",
                          "queryType": 7
                        },
                        "showPin": false,
                        "name": "query - GetWindowsVM-AHUBCost"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"a4f6422d-06bc-42c4-809c-708dd7912117\",\"mergeType\":\"innerunique\",\"leftTable\":\"query - GeCostIdleResources\",\"rightTable\":\"query - GetLinuxVMs-AHUB\",\"leftColumn\":\"ResourceId\",\"rightColumn\":\"linuxId\"},{\"id\":\"a4f6422d-06bc-42c4-809c-708dd7912118\",\"mergeType\":\"leftouter\",\"leftTable\":\"query - GetLinuxVMs-AHUB\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[query - GetLinuxVMs-AHUB].linuxId\",\"mergedName\":\"linuxId\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Last Month Cost with AHUB\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"Last Month Cost\",\"operator\":\"isNotNull\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"Last Month Cost\\\"] - [\\\"Approximate AHUB savings\\\"]\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"column\"}}]},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912118\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912118\"},{\"originalName\":\"[query - GetLinuxVMs-AHUB].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - GetLinuxVMs-AHUB].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - GeCostIdleResources].PreTaxCost\",\"mergedName\":\"Last Month Cost\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GeCostIdleResources].ResourceId\",\"mergedName\":\"ResourceId\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GeCostIdleResources].Currency\",\"mergedName\":\"Currency\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GetLinuxVMs-AHUB].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GetLinuxVMs-AHUB].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GetLinuxVMs-AHUB].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GetLinuxVMs-AHUB].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GetLinuxVMs-AHUB].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GetLinuxVMs-AHUB].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GetLinuxVMs-AHUB].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"a4f6422d-06bc-42c4-809c-708dd7912117\"},{\"originalName\":\"[query - GetAllVMs].ResourceId\"}]}",
                          "size": 0,
                          "title": "Approximate cost of Linux VMs without Hybrid Benefit enabled",
                          "queryType": 7
                        },
                        "showPin": false,
                        "name": "query - GetLinuxVM-AHUBCost"
                      }
                    ]
                  },
                  "name": "Virtual Machines"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "RG_Filter",
              "comparison": "isEqualTo",
              "value": "Tags"
            },
            "name": "group - CostTag"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isEqualTo",
        "value": "CostInformation"
      },
      "name": "group - CostInformation"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Monitoring Group",
        "items": [
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| where resourceGroup in ({ResourceGroup})\r\n| extend \r\n  state = trim(' ', tostring(properties.provisioningState)),\r\n  sku = trim(' ', tostring(properties.sku.name)),\r\n  skuUpdate = trim(' ', tostring(properties.sku.lastSkuUpdate)),\r\n  retentionDays = trim(' ', tostring(properties.retentionInDays)),\r\n  dailyquotaGB  = trim(' ', tostring(properties.workspaceCapping.dailyQuotaGb))\r\n| extend dailyquotaGB = iif(dailyquotaGB !=-1.0, dailyquotaGB,\"--\")\r\n| project ['Workspace']=id, Name=name, ['Resource Group']=strcat(\"/subscriptions/\", subscriptionId, \"/resourceGroups/\", resourceGroup), ['Location']=location, ['Retention (days)']=retentionDays, ['Daily Cap (GB)']=dailyquotaGB, ['Licence']=sku, Subscription=strcat(\"/subscriptions/\", subscriptionId)",
                    "size": 0,
                    "title": "Log analytics workspaces",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Workspace",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": "Resource",
                            "subTarget": "insights",
                            "linkIsContextBlade": true,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Name",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Resource Group",
                          "formatter": 14,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Retention (days)",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 1,
                            "max": 730,
                            "palette": "blue",
                            "customColumnWidthSetting": "10%"
                          }
                        },
                        {
                          "columnMatch": "Daily Cap (GB)",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10%"
                          }
                        },
                        {
                          "columnMatch": "Licence",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "pergb2018",
                                "representation": "turquoise",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "premium",
                                "representation": "lightBlue",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "lacluster",
                                "representation": "red",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "standard",
                                "representation": "green",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "free",
                                "representation": "blue",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "capacityreservation",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "pernode",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "standalone",
                                "representation": "purple",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "blue",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ]
                    }
                  },
                  "name": "query - 0"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "RG_Filter",
              "comparison": "isNotEqualTo",
              "value": "Tags"
            },
            "name": "group - Monitoring-Subscriptions"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where type =~ 'microsoft.operationalinsights/workspaces'\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'| extend state = trim(' ', tostring(properties.provisioningState)),\r\n  sku = trim(' ', tostring(properties.sku.name)),\r\n  skuUpdate = trim(' ', tostring(properties.sku.lastSkuUpdate)),\r\n  retentionDays = trim(' ', tostring(properties.retentionInDays)),\r\n  dailyquotaGB  = trim(' ', tostring(properties.workspaceCapping.dailyQuotaGb))\r\n| extend dailyquotaGB = iif(dailyquotaGB !=-1.0, dailyquotaGB,\"--\")\r\n| project  ['Workspace']=id, Name=name, ['Resource Group']=resourceGroup, ['Location']=location, ['Retention (days)']=retentionDays, ['Daily Cap (GB)']=dailyquotaGB,['Licence']=sku, Subscription=subscriptionId\r\n",
                    "size": 0,
                    "title": "Log analytics workspaces",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "id",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": "Resource",
                            "subTarget": "insights",
                            "linkIsContextBlade": true,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "Name",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Retention (days)",
                          "formatter": 4,
                          "formatOptions": {
                            "min": 1,
                            "max": 730,
                            "palette": "blue",
                            "customColumnWidthSetting": "10%"
                          }
                        },
                        {
                          "columnMatch": "Daily Cap (GB)",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10%"
                          }
                        },
                        {
                          "columnMatch": "Licence",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "colors",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "pergb2018",
                                "representation": "turquoise",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "premium",
                                "representation": "lightBlue",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "lacluster",
                                "representation": "red",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "standard",
                                "representation": "green",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "free",
                                "representation": "blue",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "capacityreservation",
                                "representation": "yellow",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "pernode",
                                "representation": "orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "standalone",
                                "representation": "purple",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "gray",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "subscriptionId",
                          "formatter": 15,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "resourceGroup",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        }
                      ]
                    }
                  },
                  "name": "query - 0"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "RG_Filter",
              "comparison": "isEqualTo",
              "value": "Tags"
            },
            "name": "group - Monitoring-Tags"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isEqualTo",
        "value": "Monitoring"
      },
      "name": "MonitoringGroup",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Storage Group",
        "items": [
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "StorageGroup",
              "items": [
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "advisorresources\r\n| where type == \"microsoft.advisor/recommendations\"\r\n| where tostring (properties.category) has \"Cost\"\r\n| where properties.impactedField has \"Storage\"\r\n| project AffectedResource=tostring(properties.resourceMetadata.resourceId),Impact=properties.impact,resourceGroup,AdditionaInfo=properties.extendedProperties,subscriptionId,Recommendation=tostring(properties.shortDescription.problem),name\r\n| where resourceGroup in ({ResourceGroup})\r\n",
                          "size": 0,
                          "title": "Azure Advisor Cost recommendations - Storage",
                          "noDataMessage": "You are following all of our cost recommendations for Storage",
                          "noDataMessageStyle": 3,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "Recommendation"
                              ],
                              "expandTopLevel": true
                            }
                          }
                        },
                        "name": "query - 0"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "# Storage accounts\r\nGeneral-purpose v2 storage accounts support the latest Azure Storage features and incorporate all of the functionality of general-purpose v1 and Blob storage accounts. General-purpose v2 accounts are recommended for most storage scenarios.\r\n\r\n1. General-purpose v2 accounts deliver the lowest per-gigabyte capacity prices for Azure Storage, as well as industry-competitive transaction prices.\r\n2. General-purpose v2 accounts support default account access tiers of hot or cool and blob level tiering between hot, cool, or archive.\r\n3. General-purpose v2 accounts allows you to also use lifecycle management to optimize your storage cost",
                          "style": "upsell"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources \r\n| where type =~ 'Microsoft.Storage/StorageAccounts' and kind !='StorageV2' and kind !='FileStorage'\r\n| where resourceGroup in ({ResourceGroup})\r\n| extend storageaccount=id, StorageAccountName=name, SAKind=kind,AccessTier=tostring(properties.accessTier),SKUName=sku.name, SKUTier=sku.tier, Location=location\r\n| order by id asc\r\n| project storageaccount,StorageAccountName, SKUName, SKUTier, SAKind,AccessTier, resourceGroup, Location, subscriptionId\r\n",
                          "size": 0,
                          "title": "Storage accounts which are not v2",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "storageaccount",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "subTarget": "insights",
                                  "linkIsContextBlade": true,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              }
                            ]
                          }
                        },
                        "name": "query - 1"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name | join ( Resources | where type == 'microsoft.recoveryservices/vaults' | extend recoveryvault=id, skuTier=tostring(sku['tier']),skuName=tostring(sku['name']) , RecoveryVaultName=name, RecoveryVaultLocation=location, RVRG=resourceGroup) on subscriptionId \r\n    | order by id asc\r\n    | project recoveryvault,RecoveryVaultName, RecoveryVaultLocation, RVRG, SubscriptionName ,skuTier ,skuName,subscriptionId\r\n    | where RVRG in ({ResourceGroup})",
                          "size": 0,
                          "title": "Recovery Vaults Replication ",
                          "exportedParameters": [
                            {
                              "fieldName": "RVRG",
                              "parameterName": "resourceGroupVault",
                              "parameterType": 1
                            },
                            {
                              "fieldName": "SubscriptionName",
                              "parameterName": "subscriptionName",
                              "parameterType": 1
                            },
                            {
                              "fieldName": "subscriptionId",
                              "parameterName": "subscriptionId",
                              "parameterType": 1
                            },
                            {
                              "fieldName": "RecoveryVaultName",
                              "parameterName": "vaultName",
                              "parameterType": 1
                            }
                          ],
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "sortBy": [
                              {
                                "itemKey": "RecoveryVaultLocation",
                                "sortOrder": 1
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "RecoveryVaultLocation",
                              "sortOrder": 1
                            }
                          ]
                        },
                        "customWidth": "70",
                        "name": "query - 1"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupVault}/providers/Microsoft.RecoveryServices/vaults/{vaultName}/backupstorageconfig/vaultstorageconfig?\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2018-12-20\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.properties\",\"columns\":[{\"path\":\"$.storageModelType\",\"columnid\":\"StorageReplication\"}]}}]}",
                          "size": 0,
                          "title": "Vault Storage replication type",
                          "queryType": 12
                        },
                        "customWidth": "30",
                        "name": "query - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources \r\n| where type =~ 'microsoft.compute/disks' and managedBy == \"\"\r\n| where resourceGroup in ({ResourceGroup})\r\n| extend diskState = tostring(properties.diskState)\r\n| where managedBy == \"\" and diskState != 'ActiveSAS'\r\nor diskState == 'Unattached' and diskState != 'ActiveSAS'\r\n| extend DiskId=id, DiskName=name, SKUName=sku.name, SKUTier=sku.tier, DiskSizeGB=tostring(properties.diskSizeGB), Location=location, TimeCreated=tostring(properties.timeCreated)\r\n| order by DiskId asc \r\n| project DiskId,DiskName, DiskSizeGB, SKUName, SKUTier, resourceGroup, Location, TimeCreated, subscriptionId\r\n",
                          "size": 0,
                          "title": "Unattached disks",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              }
                            ],
                            "rowLimit": 1000
                          }
                        },
                        "name": "query - 1"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == 'microsoft.compute/snapshots'\r\n| where resourceGroup in ({ResourceGroup})\r\n| extend TimeCreated = properties.timeCreated\r\n| where TimeCreated < ago(30d)\r\n| order by id asc \r\n| project Resource=id, resourceGroup, location, TimeCreated ,subscriptionId",
                          "size": 0,
                          "title": "Disk Snapshots with + 30 Days",
                          "noDataMessage": "No Snapshots with more than 30 days.",
                          "noDataMessageStyle": 3,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "name": "OldSnapshots-RG"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == 'microsoft.compute/snapshots'\r\n| where resourceGroup in ({ResourceGroup})\r\n| extend SnapshotId=id, name, resourceGroup, SnapshotLocation=location, TimeCreated=tostring(properties.timeCreated), SourceDisk=tostring(properties.creationData.sourceResourceId),subscriptionId\r\n| project SnapshotId=id, name, resourceGroup, SnapshotLocation, TimeCreated=tostring(properties.timeCreated), SourceDisk=tostring(properties.creationData.sourceResourceId), subscriptionId \r\n| join kind=leftouter  (\r\nresources\r\n| where type =~ 'microsoft.compute/disks'\r\n| extend SourceDisk=id ) on SourceDisk\r\n| where isempty(managedBy)",
                          "size": 0,
                          "title": "Snapshots of disks that doesn't exist anymore",
                          "noDataMessage": "There aren't any idle disk snapshot",
                          "noDataMessageStyle": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "name": "Idle Snapshots - RG"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "RG_Filter",
                    "comparison": "isNotEqualTo",
                    "value": "Tags"
                  },
                  "name": "Storage - subscription"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "advisorresources\r\n| where type == \"microsoft.advisor/recommendations\"\r\n| where tostring (properties.category) has \"Cost\"\r\n| where (properties.impactedField) has \"Storage\"\r\n| project AffectedResource=tolower(tostring(properties.resourceMetadata.resourceId)),Impact=properties.impact,resourceGroup,AdditionaInfo=properties.extendedProperties,subscriptionId,Recommendation=tostring(properties.shortDescription.problem),AffectedResourceName=tostring(properties.impactedValue)\r\n| join ( resources\r\n    | where type has \"Microsoft.Storage\"\r\n    | extend  AffectedResource=tolower(id)\r\n    ) on AffectedResource\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| project  AffectedResource, Impact,resourceGroup,AdditionaInfo, tagName, tagValue,Recommendation, SubscriptionName=subscriptionId",
                          "size": 0,
                          "title": "Azure advisor Cost recommendations - Storage",
                          "noDataMessage": "You are following all Storage advisor recommendations",
                          "noDataMessageStyle": 3,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "Recommendation"
                              ],
                              "expandTopLevel": true
                            }
                          }
                        },
                        "name": "query - 0"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "# Storage accounts\r\nGeneral-purpose v2 storage accounts support the latest Azure Storage features and incorporate all of the functionality of general-purpose v1 and Blob storage accounts. General-purpose v2 accounts are recommended for most storage scenarios.\r\n\r\n1. General-purpose v2 accounts deliver the lowest per-gigabyte capacity prices for Azure Storage, as well as industry-competitive transaction prices.\r\n\r\n2. General-purpose v2 accounts support default account access tiers of hot or cool and blob level tiering between hot, cool, or archive.\r\n\r\n3. General-purpose v2 accounts allows you to also use lifecycle management to optimize your storage cost",
                          "style": "upsell"
                        },
                        "name": "text - 1"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type =~ 'Microsoft.Storage/StorageAccounts'\r\n| where kind !='StorageV2' and kind !='FileStorage'\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| extend storageaccount=id, StorageAccountName=name, SAKind=kind, SKUName=sku.name, SKUTier=sku.tier,AccessTier=tostring(properties.accessTier), Location=location, SubscriptionName=subscriptionId\r\n| project storageaccount,StorageAccountName, SKUName, SKUTier, SAKind,AccessTier,resourceGroup, Location,tagName,tagValue, SubscriptionName\r\n| order by storageaccount asc",
                          "size": 0,
                          "title": "Storage accounts which are not v2",
                          "noDataMessage": "All Storage Accounts are V2",
                          "noDataMessageStyle": 3,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "storageaccount",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": "Resource",
                                  "subTarget": "insights",
                                  "linkIsContextBlade": true,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "tagName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Tags",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "tagValue",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Tags",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ]
                          }
                        },
                        "name": "query - 2"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == 'microsoft.recoveryservices/vaults'\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| extend recoveryvault=id, skuTier=tostring(sku['tier']),skuName=tostring(sku['name']) , RecoveryVaultName=name, RecoveryVaultLocation=location, RVRG=resourceGroup, SubscriptionName=subscriptionId \r\n| extend  RecoveryVaultName=name\r\n| project recoveryvault,RecoveryVaultName, RecoveryVaultLocation, RVRG,tagName,tagValue, SubscriptionName ,skuTier ,skuName,subscriptionId\r\n| order by recoveryvault asc",
                          "size": 0,
                          "title": "Recovery Vaults Replication ",
                          "noDataMessage": "You don't have any Recovery vaults!",
                          "exportedParameters": [
                            {
                              "fieldName": "RVRG",
                              "parameterName": "resourceGroupVaultTag",
                              "parameterType": 1
                            },
                            {
                              "fieldName": "SubscriptionName",
                              "parameterName": "SubscriptionName",
                              "parameterType": 1
                            },
                            {
                              "fieldName": "subscriptionId",
                              "parameterName": "subscriptionId",
                              "parameterType": 1
                            },
                            {
                              "fieldName": "RecoveryVaultName",
                              "parameterName": "vaultName",
                              "parameterType": 1
                            }
                          ],
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "tagName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Tags",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "tagValue",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Tags",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ]
                          }
                        },
                        "customWidth": "70",
                        "name": "query - 3"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupVaultTag}/providers/Microsoft.RecoveryServices/vaults/{vaultName}/backupstorageconfig/vaultstorageconfig?\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2018-12-20\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.properties\",\"columns\":[{\"path\":\"$.storageModelType\",\"columnid\":\"StorageReplication\"}]}}]}",
                          "size": 0,
                          "title": "Vault Storage replication type",
                          "queryType": 12
                        },
                        "customWidth": "30",
                        "name": "query - 4"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type =~ 'microsoft.compute/disks'\r\n| extend diskState = tostring(properties.diskState)\r\n| where managedBy == \"\" and diskState != 'ActiveSAS'\r\nor diskState == 'Unattached' and diskState != 'ActiveSAS'\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| extend DiskID=id, DiskName=name, SKUName=sku.name, SKUTier=sku.tier, DiskSizeGB=tostring(properties.diskSizeGB),DiskRG=resourceGroup, Location=location, TimeCreated=tostring(properties.timeCreated), SubscriptionName=subscriptionId \r\n| project DiskID,DiskName, DiskSizeGB, SKUName, SKUTier, DiskRG,tagName,tagValue, Location, TimeCreated, SubscriptionName\r\n| order by DiskID asc ",
                          "size": 0,
                          "title": "Unattached disks",
                          "noDataMessage": "You don't have any unattached disks!",
                          "noDataMessageStyle": 3,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "tagName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Tags",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "tagValue",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Tags",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "rowLimit": 1000
                          }
                        },
                        "name": "query - 5"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == 'microsoft.compute/snapshots'\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| extend TimeCreated = properties.timeCreated\r\n| where TimeCreated < ago(30d)\r\n| order by id asc \r\n| project Resource=id, resourceGroup, location, TimeCreated ,subscriptionId",
                          "size": 0,
                          "title": "Disk Snapshots with + 30 Days",
                          "noDataMessage": "No Snapshots with more than 30 days.",
                          "noDataMessageStyle": 3,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "name": "Old Snapshots-Tags"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type == 'microsoft.compute/snapshots'\r\n| extend SnapshotId=id, name, resourceGroup, SnapshotLocation=location, TimeCreated=tostring(properties.timeCreated), SourceDisk=tostring(properties.creationData.sourceResourceId),subscriptionId, tags\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| project SnapshotId=id, name, resourceGroup, SnapshotLocation, TimeCreated=tostring(properties.timeCreated), SourceDisk=tostring(properties.creationData.sourceResourceId), subscriptionId, tags\r\n| join kind=leftouter  (\r\nresources\r\n| where type =~ 'microsoft.compute/disks'\r\n| extend SourceDisk=id ) on SourceDisk\r\n| where isempty(managedBy)",
                          "size": 0,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "name": "Idle Snapshots - Tags"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "RG_Filter",
                    "comparison": "isEqualTo",
                    "value": "Tags"
                  },
                  "name": "Storage - Tags"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "SelectedTab",
              "comparison": "isEqualTo",
              "value": "Storage"
            },
            "name": "StorageGroup"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isEqualTo",
        "value": "Storage"
      },
      "name": "StorageGroup",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Data Group",
        "items": [
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "advisorresources\r\n| where type == \"microsoft.advisor/recommendations\"\r\n| where tostring (properties.category) has \"Cost\"\r\n| where properties.impactedField has \"Data\" or properties.impactedField has \"Sql\"\r\n| project AffectedResource=tostring(properties.resourceMetadata.resourceId),Impact=properties.impact,resourceGroup,AdditionaInfo=properties.extendedProperties,subscriptionId,Recommendation=tostring(properties.shortDescription.problem),name\r\n| where resourceGroup in ({ResourceGroup})\r\n",
                    "size": 0,
                    "title": "Azure Advisor Cost recommendations - Data",
                    "noDataMessage": "You are following all of our cost recommendations for Data",
                    "noDataMessageStyle": 3,
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "Recommendation"
                        ],
                        "expandTopLevel": true
                      }
                    }
                  },
                  "name": "query - 0"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "RG_Filter",
              "comparison": "isNotEqualTo",
              "value": "Tags"
            },
            "name": "DataGroup - Subscription"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "advisorresources\r\n| where type == \"microsoft.advisor/recommendations\"\r\n| where tostring(properties.category) has \"Cost\"\r\n| where properties.impactedField has \"Data\" or properties.impactedField has \"Sql\"\r\n| project AffectedResource=tolower(tostring(properties.resourceMetadata.resourceId)), Impact=properties.impact, resourceGroup, AdditionaInfo=properties.extendedProperties,subscriptionId, Recommendation=tostring(properties.shortDescription.problem), AffectedResourceName=tostring(properties.impactedValue)\r\n| join (resources\r\n    | where type has \"Sql\" or type has 'DocumentDB' or type has 'DB'\r\n    | extend  AffectedResource=tolower(id)\r\n    ) on AffectedResource\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| project  AffectedResource, Impact,resourceGroup,AdditionaInfo, tagName, tagValue, Recommendation, SubscriptionName=subscriptionId",
                    "size": 0,
                    "title": "Azure Advisor Cost recommendations - Data",
                    "noDataMessage": "You are following all Data Advisor recommendations",
                    "noDataMessageStyle": 3,
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "tagName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Tags",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "tagValue",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Tags",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "Recommendation"
                        ],
                        "expandTopLevel": true
                      }
                    }
                  },
                  "name": "query - 0"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "RG_Filter",
              "comparison": "isEqualTo",
              "value": "Tags"
            },
            "name": "DataGroup - Tags"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isEqualTo",
        "value": "Data"
      },
      "name": "DataGroup",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Compute Group",
        "items": [
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "advisorresources\r\n| where type == \"microsoft.advisor/recommendations\"\r\n| where tostring (properties.category) has \"Cost\"\r\n| where properties.impactedField has \"Compute\" or properties.impactedField has \"Container\" or properties.impactedField has \"Web\"\r\n| project AffectedResource=tostring(properties.resourceMetadata.resourceId),Impact=properties.impact,resourceGroup,AdditionaInfo=properties.extendedProperties,subscriptionId,Recommendation=tostring(properties.shortDescription.problem)\r\n| where resourceGroup in ({ResourceGroup})\r\n",
                    "size": 0,
                    "title": "Azure Advisor Cost recommendations",
                    "noDataMessage": "You are following all of our cost recommendations for Compute",
                    "noDataMessageStyle": 3,
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "subscriptionId",
                          "formatter": 15,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        }
                      ],
                      "rowLimit": 1000,
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "Recommendation"
                        ],
                        "expandTopLevel": true
                      }
                    }
                  },
                  "name": "query - 0"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources \r\n| where type =~ 'microsoft.compute/virtualmachines' and tostring(properties.extended.instanceView.powerState.displayStatus) != 'VM deallocated' and tostring(properties.extended.instanceView.powerState.displayStatus) != 'VM running'\r\n| where resourceGroup in ({ResourceGroup})\r\n| extend  VMname=name, PowerState=tostring(properties.extended.instanceView.powerState.displayStatus), VMLocation=location, VirtualMachineId=id\r\n| order by VirtualMachineId asc\r\n| project VirtualMachineId,VMname, PowerState, VMLocation, resourceGroup, subscriptionId",
                    "size": 0,
                    "title": "Virtual Machines in a Stopped State",
                    "noDataMessage": "You have no VMs in a stopped state",
                    "noDataMessageStyle": 3,
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "name": "query - 3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "Resources \r\n| where type =~ 'Microsoft.Compute/virtualMachines' and resourceGroup in ({ResourceGroup})\r\n| extend  VMID=id, VMName=name, TotalDataDisks=array_length(properties.storageProfile.dataDisks), TotalNICs=array_length(properties.networkProfile.networkInterfaces), VMLocation=location, VMSKU=tostring(properties.hardwareProfile.vmSize)\r\n| project VMID,VMSKU, TotalDataDisks, TotalNICs, VMLocation, resourceGroup, subscriptionId,VMName\r\n| order by VMSKU asc\r\n\r\n",
                    "size": 0,
                    "title": "All virtual machines",
                    "noDataMessage": "You have no VMs!",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "subscriptionId",
                          "formatter": 15,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        }
                      ],
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "VMSKU"
                        ]
                      }
                    },
                    "graphSettings": {
                      "type": 0,
                      "topContent": {
                        "columnMatch": "VMID",
                        "formatter": 1
                      },
                      "centerContent": {
                        "columnMatch": "TotalDataDisks",
                        "formatter": 1,
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "name": "query - 4"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# Azure App Service\r\n## Save with Premium v3 reserved instances\r\nWhen you commit to an Azure App Service Premium v3 reserved instance you can save money. The reservation discount is applied automatically to the number of running instances that match the reservation scope and attributes - you don't need to assign a reservation to a specific instance to get the discounts.\r\n\r\n## Determine the right reserved instance size before you buy\r\nBefore you buy a reservation, you should determine the size of the Premium v3 reserved instance that you need. The following sections will help you determine the right Premium v3 reserved instance size.\r\n\r\n## Use Autoscale appropriately\r\nAutoscale can be used to provision resources for when they're needed or on demand, which allows you to minimize costs when your environment is idle.\r\n",
                    "style": "upsell"
                  },
                  "name": "text - 6"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'Microsoft.Web/sites'\r\n| extend WebAppId=id, WebAppRG=resourceGroup, WebAppName=name, AppServicePlan=tostring(properties.serverFarmId), SKU=tostring(properties.sku), Type=kind, Status=tostring(properties.state), WebAppLocation=location, SubscriptionName=subscriptionId\r\n| project WebAppId,WebAppName, Type, Status, WebAppLocation, AppServicePlan, WebAppRG,SubscriptionName\r\n| order by WebAppId asc",
                    "size": 0,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isVisible",
                    "comparison": "isEqualTo",
                    "value": "Never"
                  },
                  "name": "query - WebFunctionStatus"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where resourceGroup in ({ResourceGroup})\r\n| where type == \"microsoft.web/serverfarms\"\r\n| extend  planId=tolower(tostring(id)),skuname = tostring(sku.name) , skutier = tostring(sku.tier), workers=tostring(properties.numberOfWorkers),webRG=resourceGroup,maxworkers=tostring(properties.maximumNumberOfWorkers), SubscriptionName=subscriptionId\r\n| project planId, name, skuname, skutier, workers, maxworkers, webRG, SubscriptionName\r\n| join kind=leftouter (resources | where type ==\"microsoft.insights/autoscalesettings\" | project planId=tolower(tostring(properties.targetResourceUri)), PredictiveAutoscale=properties.predictiveAutoscalePolicy.scaleMode, AutoScaleProfiles=properties.profiles,resourceGroup) on planId",
                    "size": 0,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isVisible",
                    "comparison": "isEqualTo",
                    "value": "Never"
                  },
                  "name": "query - AppServiceplandetails"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b1a8\",\"mergeType\":\"inner\",\"leftTable\":\"query - AppServiceplandetails\",\"rightTable\":\"query - WebFunctionStatus\",\"leftColumn\":\"planId\",\"rightColumn\":\"AppServicePlan\"}],\"projectRename\":[{\"originalName\":\"[query - WebFunctionStatus].WebAppId\",\"mergedName\":\"WebAppId\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b1a8\"},{\"originalName\":\"[query - WebFunctionStatus].Type\",\"mergedName\":\"Type\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b1a8\"},{\"originalName\":\"[query - WebFunctionStatus].WebAppLocation\",\"mergedName\":\"WebAppLocation\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b1a8\"},{\"originalName\":\"[query - WebFunctionStatus].Status\",\"mergedName\":\"Status\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b1a8\"},{\"originalName\":\"[query - AppServiceplandetails].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - WebFunctionStatus].WebAppRG\",\"mergedName\":\"ResourceGroup\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b1a8\"},{\"originalName\":\"[query - AppServiceplandetails].type\",\"mergedName\":\"type\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].tenantId\",\"mergedName\":\"tenantId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].kind\",\"mergedName\":\"kind\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].location\",\"mergedName\":\"location\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].managedBy\",\"mergedName\":\"managedBy\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].sku\",\"mergedName\":\"sku\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].plan\",\"mergedName\":\"plan\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].skuname\",\"mergedName\":\"skuname\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b1a8\"},{\"originalName\":\"[query - AppServiceplandetails].skutier\",\"mergedName\":\"skutier\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b1a8\"},{\"originalName\":\"[query - AppServiceplandetails].workers\",\"mergedName\":\"workers\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b1a8\"},{\"originalName\":\"[query - AppServiceplandetails].maxworkers\",\"mergedName\":\"maxworkers\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b1a8\"},{\"originalName\":\"[query - AppServiceplandetails].properties\",\"mergedName\":\"properties\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].tags\",\"mergedName\":\"tags\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].identity\",\"mergedName\":\"identity\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].zones\",\"mergedName\":\"zones\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].extendedLocation\",\"mergedName\":\"extendedLocation\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].planId\",\"mergedName\":\"planId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].PredictiveAutoscale\",\"mergedName\":\"PredictiveAutoscale\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].AutoScaleProfiles\",\"mergedName\":\"AutoScaleProfiles\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].resourceGroup1\",\"mergedName\":\"resourceGroup1\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - AppServiceplandetails].name\",\"mergedName\":\"name\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b1a8\"},{\"originalName\":\"[query - AppServiceplandetails].webRG\",\"mergedName\":\"webRG\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b1a8\"},{\"originalName\":\"[query - AppServiceplandetails].planId1\",\"mergedName\":\"planId1\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b1a8\"},{\"originalName\":\"[query - AppServiceplandetails].resourceGroup\",\"mergedName\":\"resourceGroup\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b1a8\"},{\"originalName\":\"[query - WebFunctionStatus].WebAppName\",\"mergedName\":\"WebAppName\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b1a8\"},{\"originalName\":\"[query - WebFunctionStatus].AppServicePlan\",\"mergedName\":\"AppServicePlan\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b1a8\"},{\"originalName\":\"[query - WebFunctionStatus].SubscriptionName\"}]}",
                    "size": 0,
                    "title": "Web Apps",
                    "noDataMessage": "You have no WebApps!",
                    "showExportToExcel": true,
                    "queryType": 7,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Running",
                                "representation": "success",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Stopped",
                                "representation": "disabled",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "success",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "SubscriptionName",
                          "formatter": 15,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "name",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "webRG",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "planId1",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "resourceGroup",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "WebAppName",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "AppServicePlan",
                          "formatter": 5
                        }
                      ],
                      "rowLimit": 1000,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "name"
                        ],
                        "expandTopLevel": true
                      }
                    }
                  },
                  "showPin": false,
                  "name": "query - 10"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# Azure Kubernetes Service\r\n-Enable cluster autoscaler to automatically adjust the number of agent nodes in response to resource constraints\r\n\r\n-Consider using Azure Spot VMs for workloads that can handle interruptions, early terminations, or evictions. For example, workloads such as batch processing jobs, development and testing environments, and large compute workloads may be good candidates to be scheduled on a spot node pool.\r\n\r\n-Utilize the Horizontal pod autoscaler to adjust the number of pods in a deployment depending on CPU utilization or other select metrics.\r\n\r\n-Use the Start/Stop feature in Azure Kubernetes Services (AKS).\r\n\r\n",
                    "style": "upsell"
                  },
                  "name": "text - 11"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "\tresources\r\n    | where resourceGroup in ({ResourceGroup})\r\n\t| where type == \"microsoft.containerservice/managedclusters\"\r\n\t| extend  AKSname=name,location=location,AKSRG=tolower(resourceGroup),Sku=tostring(sku.name),Tier=tostring(sku.tier),AgentPoolProfiles=properties.agentPoolProfiles\r\n\t| mvexpand AgentPoolProfiles\r\n\t| extend ProfileName = tostring(AgentPoolProfiles.name) ,mode=AgentPoolProfiles.mode,AutoScaleEnabled = AgentPoolProfiles.enableAutoScaling ,SpotVM=AgentPoolProfiles.scaleSetPriority,  VMSize=tostring(AgentPoolProfiles.vmSize),minCount=tostring(AgentPoolProfiles.minCount),maxCount=tostring(AgentPoolProfiles.maxCount) , nodeCount=tostring(AgentPoolProfiles.['count'])\r\n    | project id,ProfileName,Sku,Tier,mode,AutoScaleEnabled,SpotVM, VMSize,nodeCount,minCount,maxCount,location,AKSRG,AKSname\r\n",
                    "size": 0,
                    "noDataMessage": "You have no AKS clusters!",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "id",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": "Resource",
                            "subTarget": "Insights",
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "mode",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "System",
                                "representation": "Gear",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "User",
                                "representation": "Person",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "success",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "AutoScaleEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": ""
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "disabled",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "SpotVM",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "is Empty",
                                "representation": "3",
                                "text": "{0}{1}Not Spot VM"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "success",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "AKSname"
                        ],
                        "expandTopLevel": true
                      }
                    }
                  },
                  "name": "query - 12"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "RG_Filter",
              "comparison": "isNotEqualTo",
              "value": "Tags"
            },
            "name": "Compute - Subscription"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "loadType": "explicit",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "advisorresources\r\n| where type == \"microsoft.advisor/recommendations\"\r\n| where tostring (properties.category) has \"Cost\"\r\n| where properties.impactedField has \"Compute\" or properties.impactedField has \"Container\" or properties.impactedField has \"Web\"\r\n| project AffectedResource=tolower(tostring(properties.resourceMetadata.resourceId)),Impact=properties.impact,resourceGroup,AdditionaInfo=properties.extendedProperties,subscriptionId,Recommendation=tostring(properties.shortDescription.problem),AffectedResourceName=tostring(properties.impactedValue)\r\n| join ( resources\r\n    | where type has \"Compute\" or type has \"Web\" or type has \"Container\"\r\n    | extend  AffectedResource=tolower(id)\r\n    ) on AffectedResource\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| project  AffectedResource, Impact,resourceGroup,AdditionaInfo, tagName, tagValue, Recommendation, SubscriptionName=subscriptionId\r\n",
                    "size": 0,
                    "title": "Azure advisor Cost recommendations",
                    "noDataMessage": "You are following all Compute Advisor recommendations",
                    "noDataMessageStyle": 3,
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "tagName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Tags",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "tagValue",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Tags",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "rowLimit": 1000,
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "Recommendation"
                        ],
                        "expandTopLevel": true
                      }
                    }
                  },
                  "name": "query - 0"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where tostring(properties.extended.instanceView.powerState.displayStatus) != 'VM deallocated'\r\n| where tostring(properties.extended.instanceView.powerState.displayStatus) != 'VM running'\r\n| extend  VMname=name, PowerState=tostring(properties.extended.instanceView.powerState.displayStatus), VMLocation=location, VMRG=resourceGroup, VirtualMachineId=id, SubscriptionName=subscriptionId\r\n| project VirtualMachineId,VMname, PowerState, VMLocation, tagName,tagValue,VMRG, SubscriptionName\r\n| order by VirtualMachineId asc",
                    "size": 0,
                    "title": "Virtual Machines in a Stopped State",
                    "noDataMessage": "No Virtual Machines found in stopped state",
                    "noDataMessageStyle": 3,
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "name": "query - 3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "Resources\r\n| where type =~ 'Microsoft.Compute/virtualMachines'\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| extend  VMID=id, TotalDataDisks=array_length(properties.storageProfile.dataDisks), VMName=name, TotalNICs=array_length(properties.networkProfile.networkInterfaces), VMLocation=location, VMRG=resourceGroup, VMSKU=tostring(properties.hardwareProfile.vmSize), SubscriptionName=subscriptionId\r\n| project VMID,VMSKU, TotalDataDisks, TotalNICs, VMLocation, VMRG, SubscriptionName,tagName,tagValue,VMName\r\n| order by VMSKU asc\r\n    ",
                    "size": 0,
                    "title": "All virtual machines",
                    "noDataMessage": "No Virtual machines found!",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "tagName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Tags",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "tagValue",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Tags",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "rowLimit": 1000,
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "VMSKU"
                        ]
                      }
                    }
                  },
                  "name": "query - 4"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# Azure App Service\r\n## Save with Premium v3 reserved instances\r\nWhen you commit to an Azure App Service Premium v3 reserved instance you can save money. The reservation discount is applied automatically to the number of running instances that match the reservation scope and attributes - you don't need to assign a reservation to a specific instance to get the discounts.\r\n\r\n## Determine the right reserved instance size before you buy\r\nBefore you buy a reservation, you should determine the size of the Premium v3 reserved instance that you need. The following sections will help you determine the right Premium v3 reserved instance size.\r\n\r\n## Use Autoscale appropriately\r\nAutoscale can be used to provision resources for when they're needed or on demand, which allows you to minimize costs when your environment is idle.\r\n",
                    "style": "upsell"
                  },
                  "name": "text - 6"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where type =~ 'Microsoft.Web/sites'\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| extend WebAppId=id, WebAppRG=resourceGroup, WebAppName=name, AppServicePlan=tostring(properties.serverFarmId), SKU=tostring(properties.sku), Type=kind, Status=tostring(properties.state), WebAppLocation=location, SubscriptionName=subscriptionId\r\n| project WebAppId,WebAppName, Type, Status, WebAppLocation, AppServicePlan, WebAppRG,tagName,tagValue,SubscriptionName\r\n| order by WebAppId asc",
                    "size": 0,
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isVisible",
                    "comparison": "isEqualTo",
                    "value": "Never"
                  },
                  "name": "query - WebFunctionStatus-Tags"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where type == \"microsoft.web/serverfarms\"\r\n| extend  planId=tolower(tostring(id)),skuname = tostring(sku.name) , skutier = tostring(sku.tier), workers=tostring(properties.numberOfWorkers),webRG=resourceGroup,maxworkers=tostring(properties.maximumNumberOfWorkers)\r\n| join ( resources | mvexpand tags | extend  Tags=tags, resourceGroup \r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName]) ) on name\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| project planId,name,skuname,skutier,workers, maxworkers,webRG,tagName,tagValue\r\n| join kind=leftouter (resources | where type ==\"microsoft.insights/autoscalesettings\" | project planId=tolower(tostring(properties.targetResourceUri)), PredictiveAutoscale=properties.predictiveAutoscalePolicy.scaleMode, AutoScaleProfiles=properties.profiles,resourceGroup) on planId",
                    "size": 0,
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "rowLimit": 1000
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "isVisible",
                    "comparison": "isEqualTo",
                    "value": "Never"
                  },
                  "name": "query - AppServiceplandetails-Tags"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\",\"mergeType\":\"inner\",\"leftTable\":\"query - AppServiceplandetails-Tags\",\"rightTable\":\"query - WebFunctionStatus-Tags\",\"leftColumn\":\"planId\",\"rightColumn\":\"AppServicePlan\"}],\"projectRename\":[{\"originalName\":\"[query - WebFunctionStatus-Tags].WebAppId\",\"mergedName\":\"WebAppId\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - WebFunctionStatus-Tags].Type\",\"mergedName\":\"Type\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - WebFunctionStatus-Tags].Status\",\"mergedName\":\"Status\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - WebFunctionStatus-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - WebFunctionStatus-Tags].WebAppRG\",\"mergedName\":\"WebAppRG\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - WebFunctionStatus-Tags].WebAppLocation\",\"mergedName\":\"WebAppLocation\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - AppServiceplandetails-Tags].planId\",\"mergedName\":\"planId\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - AppServiceplandetails-Tags].WebAppName\",\"mergedName\":\"WebAppName\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - AppServiceplandetails-Tags].skuname\",\"mergedName\":\"skuname\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - AppServiceplandetails-Tags].skutier\",\"mergedName\":\"skutier\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - AppServiceplandetails-Tags].workers\",\"mergedName\":\"workers\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - AppServiceplandetails-Tags].maxworkers\",\"mergedName\":\"maxworkers\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - AppServiceplandetails-Tags].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - AppServiceplandetails-Tags].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - AppServiceplandetails-Tags].PredictiveAutoscale\",\"mergedName\":\"PredictiveAutoscale\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - AppServiceplandetails-Tags].AutoScaleProfiles\",\"mergedName\":\"AutoScaleProfiles\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - AppServiceplandetails-Tags].name\",\"mergedName\":\"name\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - AppServiceplandetails-Tags].webRG\",\"mergedName\":\"webRG\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - AppServiceplandetails-Tags].planId1\",\"mergedName\":\"planId1\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - AppServiceplandetails-Tags].resourceGroup\",\"mergedName\":\"resourceGroup\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - WebFunctionStatus-Tags].WebAppName\",\"mergedName\":\"WebAppName\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - WebFunctionStatus-Tags].AppServicePlan\",\"mergedName\":\"AppServicePlan\",\"fromId\":\"3fddbdd9-c4eb-46ae-b6b0-654c0da7b268\"},{\"originalName\":\"[query - WebFunctionStatus-Tags].tagValue\"},{\"originalName\":\"[query - WebFunctionStatus-Tags].tagName\"}]}",
                    "size": 0,
                    "title": "Web Apps",
                    "noDataMessage": "No Web Apps found!",
                    "showExportToExcel": true,
                    "queryType": 7,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Running",
                                "representation": "success",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Stopped",
                                "representation": "disabled",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "success",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "SubscriptionName",
                          "formatter": 15,
                          "formatOptions": {
                            "linkTarget": null,
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "tagName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Tags",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "tagValue",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Tags",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "name",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "webRG",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "planId1",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "resourceGroup",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "WebAppName",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "AppServicePlan",
                          "formatter": 5
                        }
                      ],
                      "rowLimit": 1000,
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "name"
                        ],
                        "expandTopLevel": true
                      }
                    }
                  },
                  "showPin": false,
                  "name": "query - 10"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "# Azure Kubernetes Service\r\n-Enable cluster autoscaler to automatically adjust the number of agent nodes in response to resource constraints\r\n\r\n-Consider using Azure Spot VMs for workloads that can handle interruptions, early terminations, or evictions. For example, workloads such as batch processing jobs, development and testing environments, and large compute workloads may be good candidates to be scheduled on a spot node pool.\r\n\r\n-Utilize the Horizontal pod autoscaler to adjust the number of pods in a deployment depending on CPU utilization or other select metrics.\r\n\r\n-Use the Start/Stop feature in Azure Kubernetes Services (AKS).\r\n\r\n",
                    "style": "upsell"
                  },
                  "name": "text - 11"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where type == \"microsoft.containerservice/managedclusters\"\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| extend  AKSname=name,AKSID=id,location=location,AKSRG=resourceGroup,Sku=tostring(sku.name),Tier=tostring(sku.tier),AgentPoolProfiles=properties.agentPoolProfiles, SubscriptionName = subscriptionId\r\n| mvexpand AgentPoolProfiles\r\n| extend ProfileName = AgentPoolProfiles.name ,mode=tostring(AgentPoolProfiles.mode),AutoScaleEnabled = AgentPoolProfiles.enableAutoScaling , VMSize=tostring(AgentPoolProfiles.vmSize),minCount=tostring(AgentPoolProfiles.minCount),maxCount=tostring(AgentPoolProfiles.maxCount) , nodeCount=tostring(AgentPoolProfiles.['count'])\r\n| project AKSID,ProfileName,Sku,Tier,mode,AutoScaleEnabled,VMSize,nodeCount,minCount,maxCount,tagName,tagValue,location,AKSRG,AKSname, SubscriptionName",
                    "size": 0,
                    "noDataMessage": "No AKS clusters found!",
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "AKSID",
                          "formatter": 13,
                          "formatOptions": {
                            "linkTarget": "Resource",
                            "subTarget": "Insights",
                            "showIcon": true
                          }
                        },
                        {
                          "columnMatch": "ProfileName",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "mode",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "System",
                                "representation": "Gear",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "User",
                                "representation": "Person",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "success",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "AutoScaleEnabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": ""
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "disabled",
                                "text": ""
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "tagName",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Tags",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "tagValue",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Tags",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true,
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "AKSname"
                        ],
                        "expandTopLevel": true
                      }
                    }
                  },
                  "name": "query - 12"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "RG_Filter",
              "comparison": "isEqualTo",
              "value": "Tags"
            },
            "name": "Compute - Tags"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isEqualTo",
        "value": "Compute"
      },
      "name": "ComputeGroup",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Performance Group",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "9dd76034-51f6-4d33-9e5b-e53da1b403aa",
                  "version": "KqlParameterItem/1.0",
                  "name": "VM",
                  "label": "Virtual Machine",
                  "type": 10,
                  "isRequired": true,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "value": "Yes"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "AKS",
                  "type": 10,
                  "isRequired": true,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "672f62c4-db68-49f2-833a-2d4e8d74cb7f"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "AppService",
                  "type": 10,
                  "isRequired": true,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "8b4a9fed-a6e3-4709-bbb5-89147472e14f"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "Storage",
                  "label": "Storage Account",
                  "type": 10,
                  "isRequired": true,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "e17e1587-7fdd-4fe4-9752-db323bd7610e"
                },
                {
                  "id": "2d6f33ef-d1ec-480e-a6d8-3d198f572eaf",
                  "version": "KqlParameterItem/1.0",
                  "name": "TimeRange",
                  "label": "Time Range",
                  "type": 4,
                  "isRequired": true,
                  "value": {
                    "durationMs": 3600000
                  },
                  "typeSettings": {
                    "selectableValues": [
                      {
                        "durationMs": 300000
                      },
                      {
                        "durationMs": 900000
                      },
                      {
                        "durationMs": 1800000
                      },
                      {
                        "durationMs": 3600000
                      },
                      {
                        "durationMs": 14400000
                      },
                      {
                        "durationMs": 43200000
                      },
                      {
                        "durationMs": 86400000
                      },
                      {
                        "durationMs": 172800000
                      },
                      {
                        "durationMs": 259200000
                      },
                      {
                        "durationMs": 604800000
                      },
                      {
                        "durationMs": 1209600000
                      },
                      {
                        "durationMs": 2419200000
                      },
                      {
                        "durationMs": 2592000000
                      },
                      {
                        "durationMs": 5184000000
                      },
                      {
                        "durationMs": 7776000000
                      }
                    ]
                  }
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 3"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources\r\n| where resourceGroup in ({ResourceGroup})\r\n| summarize count() by location",
                    "size": 0,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "visualization": "map",
                    "mapSettings": {
                      "locInfo": "AzureLoc",
                      "locInfoColumn": "location",
                      "sizeSettings": "count_",
                      "sizeAggregation": "Sum",
                      "labelSettings": "location",
                      "legendMetric": "count_",
                      "legendAggregation": "Sum",
                      "itemColorSettings": {
                        "nodeColorField": "count_",
                        "colorAggregation": "Sum",
                        "type": "heatmap",
                        "heatmapPalette": "greenRed"
                      }
                    }
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "RG_Filter",
                    "comparison": "isEqualTo",
                    "value": "Resource Group"
                  },
                  "name": "query - 6"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Resource Details",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "4cc75019-c498-4849-8129-1bdeb42c473b",
                              "version": "KqlParameterItem/1.0",
                              "name": "Resources",
                              "label": "List of Resources",
                              "type": 2,
                              "description": "Shows all the resources with this particular tag. Please note this tile can take some time to load depending on the number of resources.",
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "value": "Yes"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "parameters - 0"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where resourceGroup in ({ResourceGroup})\r\n| project Resource=id, type, resourceGroup,location\r\n| order by type asc",
                          "size": 0,
                          "title": "Resources tagged",
                          "noDataMessage": "There are no resources with this combination of Tags",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "type",
                                "formatter": 16,
                                "formatOptions": {
                                  "showIcon": true
                                }
                              }
                            ],
                            "rowLimit": 1000,
                            "filter": true
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "Resources",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "query - 1"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "ResourceDetails"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Virtual Machine Performance",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "parameters": [
                            {
                              "id": "608c66cd-f3a8-45fe-98c0-69fb8a0b6d05",
                              "version": "KqlParameterItem/1.0",
                              "name": "VirtualMachine",
                              "label": "Virtual Machine",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where resourceGroup in ({ResourceGroup})\r\n| project AffectedResource=id, resourceGroup\r\n",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "value": []
                            },
                            {
                              "id": "dd328710-81ba-43b2-9c41-9af03ae002a1",
                              "version": "KqlParameterItem/1.0",
                              "name": "NIC",
                              "label": "Network Interface Card",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where id in ({VirtualMachine})\r\n| extend nics=array_length(properties.networkProfile.networkInterfaces)\r\n| mv-expand nic=properties.networkProfile.networkInterfaces\r\n| where nics == 1 or nic.properties.primary =~ 'true' or isempty(nic)\r\n| project NicId = tostring(nic.id)\r\n",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::all",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "value": [
                                "value::all"
                              ]
                            }
                          ],
                          "style": "pills",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "conditionalVisibility": {
                          "parameterName": "VM",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "parameters - 0"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "Resources\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where id in ({VirtualMachine})\r\n| extend nics=array_length(properties.networkProfile.networkInterfaces), disks=array_length(properties.storageProfile.osDisk)\r\n| mv-expand nic=properties.networkProfile.networkInterfaces\r\n| where nics == 1 or nic.properties.primary =~ 'true' or isempty(nic)\r\n| mv-expand disk=properties.storageProfile.osDisk\r\n| extend vmId = tolower(id), vmName = name,vmRG=resourceGroup, vmSize=tostring(properties.hardwareProfile.vmSize), nicId = tostring(nic.id), diskId=tostring(disk.managedDisk.id)\r\n| join (resources\r\n    | where type =~ \"microsoft.compute/disks\"\r\n    | where resourceGroup in ({ResourceGroup})\r\n    | where isnotempty(properties.osType) \r\n    | extend vmId=tolower(managedBy), OSdiskName=id, DiskSKU=sku.name, SKUTier=sku.tier, DiskTier=tostring(properties.tier),diskSizeGB=tostring(properties.diskSizeGB),DiskIOPSReadWrite=tostring(properties.diskIOPSReadWrite), DiskMBpsReadWrite=tostring(properties.diskMBpsReadWrite)\r\n    ) on vmId\r\n| project vmId, vmSize, nicId, OSdiskName, DiskSKU, SKUTier,DiskTier,diskSizeGB,DiskIOPSReadWrite,DiskMBpsReadWrite, subscriptionId\r\n",
                          "size": 0,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "isvisible",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - 9"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "parameters": [
                            {
                              "id": "134b4273-6e78-4be4-975d-b3aec3831323",
                              "version": "KqlParameterItem/1.0",
                              "name": "singleSub",
                              "type": 2,
                              "query": "resourcecontainers\r\n| where ['type'] == \"microsoft.resources/subscriptions\"\r\n| take 1\r\n| project subscriptionId",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "isHiddenWhenLocked": true,
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 0
                              },
                              "timeContextFromParameter": "TimeRange",
                              "defaultValue": "value::1",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "above",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "parameters - 9"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{singleSub}/providers/Microsoft.Compute/skus?$filter=location eq 'westus'\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2021-07-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*[?(@.resourceType=='virtualMachines')]\",\"columns\":[{\"path\":\"name\",\"columnid\":\"Name\"},{\"path\":\"capabilities[?(@.name=='vCPUs')].value\",\"columnid\":\"vCPUs\"},{\"path\":\"capabilities[?(@.name=='MemoryGB')].value\",\"columnid\":\"MemoryGB\"},{\"path\":\"capabilities[?(@.name=='MaxNetworkInterfaces')].value\",\"columnid\":\"MaxNetworkInterfaces\"},{\"path\":\"capabilities[?(@.name=='HyperVGenerations')].value\",\"columnid\":\"HyperVGenerations\"},{\"path\":\"capabilities[?(@.name=='vCPUsPerCore')].value\",\"columnid\":\"vCPUsPerCore\"}]}}]}",
                          "size": 0,
                          "title": "Get VM vCPU",
                          "showExportToExcel": true,
                          "queryType": 12
                        },
                        "conditionalVisibility": {
                          "parameterName": "isVisible",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - Get VM vCPU"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\",\"mergeType\":\"innerunique\",\"leftTable\":\"query - Get VM vCPU\",\"rightTable\":\"query - 9\",\"leftColumn\":\"Name\",\"rightColumn\":\"vmSize\"}],\"projectRename\":[{\"originalName\":\"[query - 9].vmId\",\"mergedName\":\"vmId\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].vmSize\",\"mergedName\":\"vmSize\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Properties\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"{\\\"Memory\\\":[\\\"MemoryGB\\\"] ,\\\"vCPUs\\\":[\\\"vCPUs\\\"],\\\"vCPUsPerCore\\\":[\\\"vCPUsPerCore\\\"],\\\"MaxNICs\\\":[\\\"MaxNetworkInterfaces\\\"]}\"}}]},{\"originalName\":\"[query - 9].nicId\",\"mergedName\":\"nicId\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].OSdiskName\",\"mergedName\":\"OSdiskName\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].DiskSKU\",\"mergedName\":\"DiskSKU\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].DiskTier\",\"mergedName\":\"DiskTier\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].diskSizeGB\",\"mergedName\":\"diskSizeGB\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].DiskIOPSReadWrite\",\"mergedName\":\"DiskIOPSReadWrite\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].DiskMBpsReadWrite\",\"mergedName\":\"DiskMBpsReadWrite\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].id\",\"mergedName\":\"id\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].type\",\"mergedName\":\"type\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].tenantId\",\"mergedName\":\"tenantId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].kind\",\"mergedName\":\"kind\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].location\",\"mergedName\":\"location\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].resourceGroup\",\"mergedName\":\"resourceGroup\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].managedBy\",\"mergedName\":\"managedBy\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].sku\",\"mergedName\":\"sku\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].plan\",\"mergedName\":\"plan\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].properties\",\"mergedName\":\"properties\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].tags\",\"mergedName\":\"tags\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].identity\",\"mergedName\":\"identity\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].zones\",\"mergedName\":\"zones\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].extendedLocation\",\"mergedName\":\"extendedLocation\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].nics\",\"mergedName\":\"nics\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].disks\",\"mergedName\":\"disks\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].nic\",\"mergedName\":\"nic\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].disk\",\"mergedName\":\"disk\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].vmName\",\"mergedName\":\"vmName\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].vmRG\",\"mergedName\":\"vmRG\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 9].diskId\",\"mergedName\":\"diskId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - 9].name\"}]}",
                          "size": 0,
                          "title": "Overview",
                          "showExportToExcel": true,
                          "queryType": 7,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Name",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "vCPUs",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "MemoryGB",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "MaxNetworkInterfaces",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "HyperVGenerations",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "vCPUsPerCore",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "SKUProperties",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "CellDetails",
                                  "linkLabel": "Info",
                                  "linkIsContextBlade": true
                                }
                              }
                            ]
                          },
                          "sortBy": []
                        },
                        "name": "overviewMerge-RG"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook4d373e23-a23c-4f5a-99ea-e02c3d361741",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.compute/virtualmachines",
                          "metricScope": 0,
                          "resourceParameter": "VirtualMachine",
                          "resourceIds": [
                            "{VirtualMachine}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 3600000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.compute/virtualmachines",
                              "metric": "microsoft.compute/virtualmachines--Percentage CPU",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "title": "CPU",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "conditionalVisibility": {
                          "parameterName": "VM",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "VmCpuByRg"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbooka1029043-2c0d-491c-81ab-5404ce82b269",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.compute/virtualmachines",
                          "metricScope": 0,
                          "resourceParameter": "VirtualMachine",
                          "resourceIds": [
                            "{VirtualMachine}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 3600000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.compute/virtualmachines",
                              "metric": "microsoft.compute/virtualmachines--Available Memory Bytes",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "title": "Memory",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "name": "VmMemoryByRg"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook4d373e23-a23c-4f5a-99ea-e02c3d361741",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.compute/virtualmachines",
                          "metricScope": 0,
                          "resourceParameter": "VirtualMachine",
                          "resourceIds": [
                            "{VirtualMachine}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 3600000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.compute/virtualmachines",
                              "metric": "microsoft.compute/virtualmachines--OS Disk IOPS Consumed Percentage",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "title": "OS Disk IOPS",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "conditionalVisibility": {
                          "parameterName": "VM",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "VM Peformance Filtered by RG - Copy"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook4d373e23-a23c-4f5a-99ea-e02c3d361741",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.compute/virtualmachines",
                          "metricScope": 0,
                          "resourceParameter": "VirtualMachine",
                          "resourceIds": [
                            "{VirtualMachine}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 3600000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.compute/virtualmachines",
                              "metric": "microsoft.compute/virtualmachines--Data Disk IOPS Consumed Percentage",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "title": "Data Disk IOPS",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "conditionalVisibility": {
                          "parameterName": "VM",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "VM Peformance Filtered by RG - Copy - Copy"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook4d373e23-a23c-4f5a-99ea-e02c3d361741",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.network/networkinterfaces",
                          "metricScope": 0,
                          "resourceParameter": "NIC",
                          "resourceIds": [
                            "{NIC}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 3600000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.network/networkinterfaces",
                              "metric": "microsoft.network/networkinterfaces--BytesSentRate",
                              "aggregation": 4,
                              "splitBy": null
                            },
                            {
                              "namespace": "microsoft.network/networkinterfaces",
                              "metric": "microsoft.network/networkinterfaces--BytesReceivedRate",
                              "aggregation": 4
                            }
                          ],
                          "title": "Network Inbound and Outbound",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "conditionalVisibility": {
                          "parameterName": "VM",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "VM Peformance Filtered by RG - Copy - Copy - Copy"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "VM",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "VM Performance - RG"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "App Service Performance",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "parameters": [
                            {
                              "id": "55e5df93-34e9-4da1-903f-d59beff2cb3f",
                              "version": "KqlParameterItem/1.0",
                              "name": "AppService",
                              "label": "Application Service",
                              "type": 5,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "resources\r\n| where type =~ 'Microsoft.Web/sites'\r\n| project AffectedResource=id,AffectedResourceName=name, resourceGroup\r\n| where resourceGroup in ({ResourceGroup})\r\n| project  AffectedResource,resourceGroup\r\n",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "value": [
                                ""
                              ]
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "parameters - AppService"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook2bf3d022-cec5-40d8-a02c-07e39e5cf56f",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.web/sites",
                          "metricScope": 0,
                          "resourceParameter": "AppService",
                          "resourceIds": [
                            "{AppService}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 604800000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.web/sites",
                              "metric": "microsoft.web/sites--AppConnections",
                              "aggregation": 4,
                              "splitBy": null
                            },
                            {
                              "namespace": "microsoft.web/sites",
                              "metric": "microsoft.web/sites--Requests",
                              "aggregation": 4
                            }
                          ],
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "name": "metric - 1"
                      }
                    ]
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "AppService",
                      "comparison": "isEqualTo",
                      "value": "Yes"
                    },
                    {
                      "parameterName": "RG_Filter",
                      "comparison": "isEqualTo",
                      "value": "Resource Group"
                    }
                  ],
                  "name": "AppService - RG"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Storage  Performance",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "parameters": [
                            {
                              "id": "55e5df93-34e9-4da1-903f-d59beff2cb3f",
                              "version": "KqlParameterItem/1.0",
                              "name": "StorageAccount",
                              "label": "Storage Account",
                              "type": 5,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "resources\r\n| where type == \"microsoft.storage/storageaccounts\"\r\n| project AffectedResource=id,AffectedResourceName=name, resourceGroup\r\n| where resourceGroup in ({ResourceGroup})\r\n| project  AffectedResource,resourceGroup",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "value": [
                                ""
                              ]
                            }
                          ],
                          "style": "pills",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "parameters - 0"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook2bf3d022-cec5-40d8-a02c-07e39e5cf56f",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.storage/storageaccounts",
                          "metricScope": 0,
                          "resourceParameter": "StorageAccount",
                          "resourceIds": [
                            "{StorageAccount}"
                          ],
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.storage/storageaccounts",
                              "metric": "microsoft.storage/storageaccounts-Capacity-UsedCapacity",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "name": "metric - 1"
                      }
                    ]
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "Storage",
                      "comparison": "isEqualTo",
                      "value": "Yes"
                    },
                    {
                      "parameterName": "RG_Filter",
                      "comparison": "isEqualTo",
                      "value": "Resource Group"
                    }
                  ],
                  "name": "Storage Performance - RG"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AKS Performance",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "55e5df93-34e9-4da1-903f-d59beff2cb3f",
                              "version": "KqlParameterItem/1.0",
                              "name": "AKS",
                              "type": 5,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "resources\r\n| where type == \"microsoft.containerservice/managedclusters\"\r\n| project AffectedResource=id,AffectedResourceName=name, resourceGroup\r\n| where resourceGroup in ({ResourceGroup})\r\n| project  AffectedResource,resourceGroup",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "parameters - AKS"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook2bf3d022-cec5-40d8-a02c-07e39e5cf56f",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.containerservice/managedclusters",
                          "metricScope": 0,
                          "resourceParameter": "AKS",
                          "resourceIds": [
                            "{AKS}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 604800000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.containerservice/managedclusters",
                              "metric": "microsoft.containerservice/managedclusters-Nodes (PREVIEW)-node_cpu_usage_percentage",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "title": "Node CPU Utilization",
                          "gridFormatType": 1,
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "Name",
                              "formatter": 13
                            },
                            "leftContent": {
                              "columnMatch": "Value",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "mapSettings": {
                            "locInfo": "AzureResource",
                            "sizeSettings": "Value",
                            "sizeAggregation": "Sum",
                            "legendMetric": "Value",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "type": "heatmap",
                              "colorAggregation": "Sum",
                              "nodeColorField": "Value",
                              "heatmapPalette": "greenRed"
                            },
                            "locInfoColumn": "Name"
                          },
                          "graphSettings": {
                            "type": 0,
                            "topContent": {
                              "columnMatch": "Subscription",
                              "formatter": 1
                            },
                            "centerContent": {
                              "columnMatch": "insights.container/nodes--cpuUsagePercentage",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "name": "AKS-NodeCPUUtilization"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook2bf3d022-cec5-40d8-a02c-07e39e5cf56f",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.containerservice/managedclusters",
                          "metricScope": 0,
                          "resourceParameter": "AKS",
                          "resourceIds": [
                            "{AKS}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 604800000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.containerservice/managedclusters",
                              "metric": "microsoft.containerservice/managedclusters-Nodes-kube_node_status_allocatable_memory_bytes",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "title": "Node Memory Utilization",
                          "gridFormatType": 1,
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "Name",
                              "formatter": 13
                            },
                            "leftContent": {
                              "columnMatch": "Value",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "mapSettings": {
                            "locInfo": "AzureResource",
                            "sizeSettings": "Value",
                            "sizeAggregation": "Sum",
                            "legendMetric": "Value",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "type": "heatmap",
                              "colorAggregation": "Sum",
                              "nodeColorField": "Value",
                              "heatmapPalette": "greenRed"
                            },
                            "locInfoColumn": "Name"
                          },
                          "graphSettings": {
                            "type": 0,
                            "topContent": {
                              "columnMatch": "Subscription",
                              "formatter": 1
                            },
                            "centerContent": {
                              "columnMatch": "insights.container/nodes--cpuUsagePercentage",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "name": "AKS-NodeMemoryUtilization"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook2bf3d022-cec5-40d8-a02c-07e39e5cf56f",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.containerservice/managedclusters",
                          "metricScope": 0,
                          "resourceParameter": "AKS",
                          "resourceIds": [
                            "{AKS}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 604800000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.containerservice/managedclusters",
                              "metric": "microsoft.containerservice/managedclusters-Pods-kube_pod_status_ready",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "title": "Active pod Count",
                          "gridFormatType": 1,
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "Name",
                              "formatter": 13
                            },
                            "leftContent": {
                              "columnMatch": "Value",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "mapSettings": {
                            "locInfo": "AzureResource",
                            "sizeSettings": "Value",
                            "sizeAggregation": "Sum",
                            "legendMetric": "Value",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "type": "heatmap",
                              "colorAggregation": "Sum",
                              "nodeColorField": "Value",
                              "heatmapPalette": "greenRed"
                            },
                            "locInfoColumn": "Name"
                          },
                          "graphSettings": {
                            "type": 0,
                            "topContent": {
                              "columnMatch": "Subscription",
                              "formatter": 1
                            },
                            "centerContent": {
                              "columnMatch": "insights.container/nodes--cpuUsagePercentage",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "name": "AKS-ActivePodCount"
                      }
                    ]
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "AKS",
                      "comparison": "isEqualTo",
                      "value": "Yes"
                    },
                    {
                      "parameterName": "RG_Filter",
                      "comparison": "isEqualTo",
                      "value": "Resource Group"
                    }
                  ],
                  "name": "AKS - RG"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "RG_Filter",
              "comparison": "isEqualTo",
              "value": "Resource Group"
            },
            "name": "Performance-RG"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| summarize count() by location",
                          "size": 0,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "map",
                          "mapSettings": {
                            "locInfo": "AzureLoc",
                            "locInfoColumn": "location",
                            "sizeSettings": "count_",
                            "sizeAggregation": "Sum",
                            "labelSettings": "location",
                            "legendMetric": "count_",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "nodeColorField": "count_",
                              "colorAggregation": "Sum",
                              "type": "heatmap",
                              "heatmapPalette": "greenRed"
                            }
                          }
                        },
                        "customWidth": "50",
                        "conditionalVisibility": {
                          "parameterName": "RG_Filter",
                          "comparison": "isEqualTo",
                          "value": "Tags"
                        },
                        "name": "resourceMap-Tags"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "title": "ResourceDetails",
                          "items": [
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "4cc75019-c498-4849-8129-1bdeb42c473b",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Resources",
                                    "label": "List of Resources",
                                    "type": 2,
                                    "description": "Shows all the resources with this particular tag. Please note this tile can take some time to load depending on the number of resources.",
                                    "isRequired": true,
                                    "typeSettings": {
                                      "additionalResourceOptions": [],
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "value": "Yes"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "parameters - 0"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "resources\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| project Resource=id, type, resourceGroup, location\r\n| order by type asc\r\n",
                                "size": 0,
                                "title": "Resources tagged",
                                "noDataMessage": "There are no resources with this combination of Tags",
                                "showExportToExcel": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ]
                              },
                              "conditionalVisibility": {
                                "parameterName": "Resources",
                                "comparison": "isEqualTo",
                                "value": "Yes"
                              },
                              "name": "resourcesTagged-Tags"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "ResourceDetails-Tags"
                      }
                    ]
                  },
                  "name": "ResourceOverview-Tags"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Virtual Machines Performance",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "parameters": [
                            {
                              "id": "608c66cd-f3a8-45fe-98c0-69fb8a0b6d05",
                              "version": "KqlParameterItem/1.0",
                              "name": "VirtualMachine",
                              "label": "Virtual Machine",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "resources\r\n| where type == \"microsoft.compute/virtualmachines\"\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| project AffectedResource=id",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::all",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            },
                            {
                              "id": "dd328710-81ba-43b2-9c41-9af03ae002a1",
                              "version": "KqlParameterItem/1.0",
                              "name": "NIC",
                              "label": "Network Interface Card",
                              "type": 5,
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "Resources\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where id in ({VirtualMachine})\r\n| extend nics=array_length(properties.networkProfile.networkInterfaces)\r\n| mv-expand nic=properties.networkProfile.networkInterfaces\r\n| where nics == 1 or nic.properties.primary =~ 'true' or isempty(nic)\r\n| project NicId = tostring(nic.id)",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "isHiddenWhenLocked": true,
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::all",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "pills",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "conditionalVisibility": {
                          "parameterName": "VM",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "parameters - 0"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where id in ({VirtualMachine})\r\n| extend nics=array_length(properties.networkProfile.networkInterfaces), disks=array_length(properties.storageProfile.osDisk)\r\n| mv-expand nic=properties.networkProfile.networkInterfaces\r\n| where nics == 1 or nic.properties.primary =~ 'true' or isempty(nic)\r\n| mv-expand disk=properties.storageProfile.osDisk\r\n| extend vmId = tolower(id), vmName = name,vmRG=resourceGroup, vmSize=tostring(properties.hardwareProfile.vmSize), nicId = tostring(nic.id), diskId=tostring(disk.managedDisk.id)\r\n| join ( \r\nresources | where type =~ \"microsoft.compute/disks\" | where isnotempty(properties.osType) \r\n| extend vmId=tolower(managedBy), OSdiskName=id, DiskSKU=sku.name, SKUTier=sku.tier, DiskTier=tostring(properties.tier),diskSizeGB=tostring(properties.diskSizeGB),DiskIOPSReadWrite=tostring(properties.diskIOPSReadWrite), DiskMBpsReadWrite=tostring(properties.diskMBpsReadWrite)) on vmId\r\n| project vmId, vmSize, nicId, OSdiskName, DiskSKU, SKUTier,DiskTier,diskSizeGB,DiskIOPSReadWrite,DiskMBpsReadWrite, subscriptionId",
                          "size": 0,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "isvisible",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - 9"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "parameters": [
                            {
                              "id": "663611ca-5c92-4495-813e-f5ea714e6ff3",
                              "version": "KqlParameterItem/1.0",
                              "name": "singleSub",
                              "type": 2,
                              "query": "resourcecontainers\r\n| where type==\"microsoft.resources/subscriptions\"\r\n| take 1\r\n| project subscriptionId",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "isHiddenWhenLocked": true,
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::1"
                                ]
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "defaultValue": "value::1",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "pills",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "parameters - 9"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{singleSub}/providers/Microsoft.Compute/skus?$filter=location eq 'westus'\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2021-07-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*[?(@.resourceType=='virtualMachines')]\",\"columns\":[{\"path\":\"name\",\"columnid\":\"Name\"},{\"path\":\"capabilities[?(@.name=='vCPUs')].value\",\"columnid\":\"vCPUs\"},{\"path\":\"capabilities[?(@.name=='MemoryGB')].value\",\"columnid\":\"MemoryGB\"},{\"path\":\"capabilities[?(@.name=='MaxNetworkInterfaces')].value\",\"columnid\":\"MaxNetworkInterfaces\"},{\"path\":\"capabilities[?(@.name=='HyperVGenerations')].value\",\"columnid\":\"HyperVGenerations\"},{\"path\":\"capabilities[?(@.name=='vCPUsPerCore')].value\",\"columnid\":\"vCPUsPerCore\"}]}}]}",
                          "size": 0,
                          "title": "Get VM vCPU",
                          "showExportToExcel": true,
                          "queryType": 12
                        },
                        "conditionalVisibility": {
                          "parameterName": "isVisible",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - Get VM vCPU"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\",\"mergeType\":\"leftouter\",\"leftTable\":\"query - 9\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"vmSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[query - 9].vmId\",\"mergedName\":\"vmId\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].vmSize\",\"mergedName\":\"vmSize\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Properties\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"{\\\"Memory\\\":[\\\"MemoryGB\\\"] ,\\\"vCPUs\\\":[\\\"vCPUs\\\"],\\\"vCPUsPerCore\\\":[\\\"vCPUsPerCore\\\"],\\\"MaxNICs\\\":[\\\"MaxNetworkInterfaces\\\"]}\"}}]},{\"originalName\":\"[query - 9].nicId\",\"mergedName\":\"nicId\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].OSdiskName\",\"mergedName\":\"OSdiskName\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].DiskSKU\",\"mergedName\":\"DiskSKU\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].DiskTier\",\"mergedName\":\"DiskTier\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].diskSizeGB\",\"mergedName\":\"diskSizeGB\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].DiskIOPSReadWrite\",\"mergedName\":\"DiskIOPSReadWrite\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].DiskMBpsReadWrite\",\"mergedName\":\"DiskMBpsReadWrite\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - 9].subscriptionId\",\"mergedName\":\"Subscription\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"5927adfc-4b2d-4b36-891c-9cbf8da8c20f\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"}]}",
                          "size": 0,
                          "title": "VM Overview",
                          "showExportToExcel": true,
                          "queryType": 7,
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Subscription",
                                "formatter": 13,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "vCPUs",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "MemoryGB",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "MaxNetworkInterfaces",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "vCPUsPerCore",
                                "formatter": 5
                              }
                            ]
                          },
                          "sortBy": []
                        },
                        "name": "vmOverviewMerge-Tags"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook4d373e23-a23c-4f5a-99ea-e02c3d361741",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.compute/virtualmachines",
                          "metricScope": 0,
                          "resourceParameter": "VirtualMachine",
                          "resourceIds": [
                            "{VirtualMachine}"
                          ],
                          "timeContext": {
                            "durationMs": 604800000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.compute/virtualmachines",
                              "metric": "microsoft.compute/virtualmachines--Percentage CPU",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "title": "VM CPU",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "conditionalVisibility": {
                          "parameterName": "VM",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "VM Peformance Filtered by RG"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbooka1029043-2c0d-491c-81ab-5404ce82b269",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.compute/virtualmachines",
                          "metricScope": 0,
                          "resourceParameter": "VirtualMachine",
                          "resourceIds": [
                            "{VirtualMachine}"
                          ],
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.compute/virtualmachines",
                              "metric": "microsoft.compute/virtualmachines--Available Memory Bytes",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "title": "VM Memory",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "name": "metric - 5"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook4d373e23-a23c-4f5a-99ea-e02c3d361741",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.compute/virtualmachines",
                          "metricScope": 0,
                          "resourceParameter": "VirtualMachine",
                          "resourceIds": [
                            "{VirtualMachine}"
                          ],
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.compute/virtualmachines",
                              "metric": "microsoft.compute/virtualmachines--OS Disk IOPS Consumed Percentage",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "title": "OS Disk IOPS",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "conditionalVisibility": {
                          "parameterName": "VM",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "VM Peformance Filtered by RG - Copy"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook4d373e23-a23c-4f5a-99ea-e02c3d361741",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.compute/virtualmachines",
                          "metricScope": 0,
                          "resourceParameter": "VirtualMachine",
                          "resourceIds": [
                            "{VirtualMachine}"
                          ],
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.compute/virtualmachines",
                              "metric": "microsoft.compute/virtualmachines--Data Disk IOPS Consumed Percentage",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "title": "Data Disk IOPS",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "conditionalVisibility": {
                          "parameterName": "VM",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "VM Peformance Filtered by RG - Copy - Copy"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook4d373e23-a23c-4f5a-99ea-e02c3d361741",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.network/networkinterfaces",
                          "metricScope": 0,
                          "resourceParameter": "NIC",
                          "resourceIds": [
                            "{NIC}"
                          ],
                          "timeContext": {
                            "durationMs": 2592000000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.network/networkinterfaces",
                              "metric": "microsoft.network/networkinterfaces--BytesSentRate",
                              "aggregation": 4,
                              "splitBy": null
                            },
                            {
                              "namespace": "microsoft.network/networkinterfaces",
                              "metric": "microsoft.network/networkinterfaces--BytesReceivedRate",
                              "aggregation": 4
                            }
                          ],
                          "title": "Network Inbound and Outbound",
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "conditionalVisibility": {
                          "parameterName": "VM",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "VM Peformance Filtered by RG - Copy - Copy - Copy"
                      }
                    ]
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "VM",
                      "comparison": "isEqualTo",
                      "value": "Yes"
                    },
                    {
                      "parameterName": "RG_Filter",
                      "comparison": "isEqualTo",
                      "value": "Tags"
                    }
                  ],
                  "name": "VM Performance-Tags"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "App Service Performance",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "parameters": [
                            {
                              "id": "55e5df93-34e9-4da1-903f-d59beff2cb3f",
                              "version": "KqlParameterItem/1.0",
                              "name": "AppService",
                              "label": "Application Service",
                              "type": 5,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "resources\r\n| where type =~ 'Microsoft.Web/sites'\r\n| project AffectedResource=id,AffectedResourceName=name\r\n| join ( resources | mvexpand tags | extend  AffectedResourceName=name, Tags=tags, resourceGroup \r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName]) ) on AffectedResourceName\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| project  AffectedResource,resourceGroup,tagName,tagValue",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "pills",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "parameters - 0"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook2bf3d022-cec5-40d8-a02c-07e39e5cf56f",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.web/sites",
                          "metricScope": 0,
                          "resourceParameter": "AppService",
                          "resourceIds": [
                            "{AppService}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 604800000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.web/sites",
                              "metric": "microsoft.web/sites--AppConnections",
                              "aggregation": 4,
                              "splitBy": null
                            },
                            {
                              "namespace": "microsoft.web/sites",
                              "metric": "microsoft.web/sites--Requests",
                              "aggregation": 4
                            }
                          ],
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "name": "metric - 1"
                      }
                    ]
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "AppService",
                      "comparison": "isEqualTo",
                      "value": "Yes"
                    },
                    {
                      "parameterName": "RG_Filter",
                      "comparison": "isEqualTo",
                      "value": "Tags"
                    }
                  ],
                  "name": "AppService-Tags"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "Storage  Performance",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "parameters": [
                            {
                              "id": "55e5df93-34e9-4da1-903f-d59beff2cb3f",
                              "version": "KqlParameterItem/1.0",
                              "name": "StorageAccount",
                              "label": "Storage Account",
                              "type": 5,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "resources\r\n| where type == \"microsoft.storage/storageaccounts\"\r\n| project AffectedResource=id,AffectedResourceName=name\r\n| join ( resources | mvexpand tags | extend  AffectedResourceName=name, Tags=tags, resourceGroup \r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName]) ) on AffectedResourceName\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| project  AffectedResource,resourceGroup,tagName,tagValue",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "pills",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "parameters - 0"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook2bf3d022-cec5-40d8-a02c-07e39e5cf56f",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.storage/storageaccounts",
                          "metricScope": 0,
                          "resourceParameter": "StorageAccount",
                          "resourceIds": [
                            "{StorageAccount}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 604800000
                          },
                          "metrics": [
                            {
                              "namespace": "microsoft.storage/storageaccounts",
                              "metric": "microsoft.storage/storageaccounts-Capacity-UsedCapacity",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "name": "metric - 1"
                      }
                    ]
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "Storage",
                      "comparison": "isEqualTo",
                      "value": "Yes"
                    },
                    {
                      "parameterName": "RG_Filter",
                      "comparison": "isEqualTo",
                      "value": "Tags"
                    }
                  ],
                  "name": "Storage Performance-Tags"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "AKS Performance",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "parameters": [
                            {
                              "id": "55e5df93-34e9-4da1-903f-d59beff2cb3f",
                              "version": "KqlParameterItem/1.0",
                              "name": "AKS",
                              "type": 5,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "resources\r\n| where type == \"microsoft.containerservice/managedclusters\"\r\n| project AffectedResource=id,AffectedResourceName=name\r\n| join ( resources | mvexpand tags | extend  AffectedResourceName=name, Tags=tags, resourceGroup \r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName]) ) on AffectedResourceName\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| project  AffectedResource,resourceGroup,tagName,tagValue",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources"
                            }
                          ],
                          "style": "pills",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "name": "parameters - 0"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook2bf3d022-cec5-40d8-a02c-07e39e5cf56f",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.containerservice/managedclusters",
                          "metricScope": 0,
                          "resourceParameter": "AKS",
                          "resourceIds": [
                            "{AKS}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 604800000
                          },
                          "metrics": [
                            {
                              "namespace": "insights.container/nodes",
                              "metric": "insights.container/nodes--cpuUsagePercentage",
                              "aggregation": 4,
                              "splitBy": null
                            },
                            {
                              "namespace": "insights.container/nodes",
                              "metric": "insights.container/nodes--cpuUsagePercentage",
                              "aggregation": 3
                            }
                          ],
                          "title": "Node CPU Utilization",
                          "gridFormatType": 1,
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "Name",
                              "formatter": 13
                            },
                            "leftContent": {
                              "columnMatch": "Value",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "mapSettings": {
                            "locInfo": "AzureResource",
                            "sizeSettings": "Value",
                            "sizeAggregation": "Sum",
                            "legendMetric": "Value",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "type": "heatmap",
                              "colorAggregation": "Sum",
                              "nodeColorField": "Value",
                              "heatmapPalette": "greenRed"
                            },
                            "locInfoColumn": "Name"
                          },
                          "graphSettings": {
                            "type": 0,
                            "topContent": {
                              "columnMatch": "Subscription",
                              "formatter": 1
                            },
                            "centerContent": {
                              "columnMatch": "insights.container/nodes--cpuUsagePercentage",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "name": "metric - 1 - Copy - Copy"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook2bf3d022-cec5-40d8-a02c-07e39e5cf56f",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.containerservice/managedclusters",
                          "metricScope": 0,
                          "resourceParameter": "AKS",
                          "resourceIds": [
                            "{AKS}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 604800000
                          },
                          "metrics": [
                            {
                              "namespace": "insights.container/nodes",
                              "metric": "insights.container/nodes--memoryRssPercentage",
                              "aggregation": 4,
                              "splitBy": null
                            },
                            {
                              "namespace": "insights.container/nodes",
                              "metric": "insights.container/nodes--memoryRssPercentage",
                              "aggregation": 3
                            }
                          ],
                          "title": "Node Memory Utilization",
                          "gridFormatType": 1,
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "Name",
                              "formatter": 13
                            },
                            "leftContent": {
                              "columnMatch": "Value",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "mapSettings": {
                            "locInfo": "AzureResource",
                            "sizeSettings": "Value",
                            "sizeAggregation": "Sum",
                            "legendMetric": "Value",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "type": "heatmap",
                              "colorAggregation": "Sum",
                              "nodeColorField": "Value",
                              "heatmapPalette": "greenRed"
                            },
                            "locInfoColumn": "Name"
                          },
                          "graphSettings": {
                            "type": 0,
                            "topContent": {
                              "columnMatch": "Subscription",
                              "formatter": 1
                            },
                            "centerContent": {
                              "columnMatch": "insights.container/nodes--cpuUsagePercentage",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "name": "metric - 1 - Copy - Copy - Copy"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook2bf3d022-cec5-40d8-a02c-07e39e5cf56f",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.containerservice/managedclusters",
                          "metricScope": 0,
                          "resourceParameter": "AKS",
                          "resourceIds": [
                            "{AKS}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 604800000
                          },
                          "metrics": [
                            {
                              "namespace": "insights.container/pods",
                              "metric": "insights.container/pods--podCount",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "title": "Active pod Count",
                          "gridFormatType": 1,
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "Name",
                              "formatter": 13
                            },
                            "leftContent": {
                              "columnMatch": "Value",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "mapSettings": {
                            "locInfo": "AzureResource",
                            "sizeSettings": "Value",
                            "sizeAggregation": "Sum",
                            "legendMetric": "Value",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "type": "heatmap",
                              "colorAggregation": "Sum",
                              "nodeColorField": "Value",
                              "heatmapPalette": "greenRed"
                            },
                            "locInfoColumn": "Name"
                          },
                          "graphSettings": {
                            "type": 0,
                            "topContent": {
                              "columnMatch": "Subscription",
                              "formatter": 1
                            },
                            "centerContent": {
                              "columnMatch": "insights.container/nodes--cpuUsagePercentage",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "name": "metric - 1 - Copy"
                      },
                      {
                        "type": 10,
                        "content": {
                          "chartId": "workbook2bf3d022-cec5-40d8-a02c-07e39e5cf56f",
                          "version": "MetricsItem/2.0",
                          "size": 0,
                          "chartType": 2,
                          "resourceType": "microsoft.containerservice/managedclusters",
                          "metricScope": 0,
                          "resourceParameter": "AKS",
                          "resourceIds": [
                            "{AKS}"
                          ],
                          "timeContextFromParameter": "TimeRange",
                          "timeContext": {
                            "durationMs": 604800000
                          },
                          "metrics": [
                            {
                              "namespace": "insights.container/nodes",
                              "metric": "insights.container/nodes--nodesCount",
                              "aggregation": 4,
                              "splitBy": null
                            }
                          ],
                          "title": "Node Count",
                          "gridFormatType": 1,
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "Name",
                              "formatter": 13
                            },
                            "leftContent": {
                              "columnMatch": "Value",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "mapSettings": {
                            "locInfo": "AzureResource",
                            "sizeSettings": "Value",
                            "sizeAggregation": "Sum",
                            "legendMetric": "Value",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "type": "heatmap",
                              "colorAggregation": "Sum",
                              "nodeColorField": "Value",
                              "heatmapPalette": "greenRed"
                            },
                            "locInfoColumn": "Name"
                          },
                          "graphSettings": {
                            "type": 0,
                            "topContent": {
                              "columnMatch": "Subscription",
                              "formatter": 1
                            },
                            "centerContent": {
                              "columnMatch": "insights.container/nodes--cpuUsagePercentage",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "gridSettings": {
                            "rowLimit": 10000
                          }
                        },
                        "customWidth": "50",
                        "name": "metric - 1 - Copy - Copy"
                      }
                    ]
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "AKS",
                      "comparison": "isEqualTo",
                      "value": "Yes"
                    },
                    {
                      "parameterName": "RG_Filter",
                      "comparison": "isEqualTo",
                      "value": "Tags"
                    }
                  ],
                  "name": "AKS-Tags"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "RG_Filter",
              "comparison": "isEqualTo",
              "value": "Tags"
            },
            "name": "Performance-Tags"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isEqualTo",
        "value": "Performance"
      },
      "name": "Performance Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "## Resources distribution per region"
            },
            "name": "text - 3"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "summarize count() by location",
              "size": 2,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Subscription}"
              ],
              "visualization": "map",
              "mapSettings": {
                "locInfo": "AzureLoc",
                "locInfoColumn": "location",
                "sizeSettings": "count_",
                "sizeAggregation": "Sum",
                "labelSettings": "location",
                "legendMetric": "count_",
                "legendAggregation": "Sum",
                "itemColorSettings": {
                  "nodeColorField": "count_",
                  "colorAggregation": "Sum",
                  "type": "heatmap",
                  "heatmapPalette": "greenRed"
                }
              }
            },
            "name": "query - 0"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ResourceContainers  | where type =~ 'Microsoft.Resources/subscriptions' | project SubscriptionName = name, subscriptionId | join (Resources| summarize resourceCount=count() by subscriptionId) on subscriptionId\r\n",
              "size": 0,
              "title": "Resources per Subscription",
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Subscription}"
              ],
              "visualization": "tiles",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "SubscriptionName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "resourceCount",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "name": "query - 1"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Resources | where type =~ 'Microsoft.Compute/virtualMachines' | project SKU = tostring(properties.hardwareProfile.vmSize)| summarize count() by SKU",
              "size": 0,
              "title": "Virtual machines per SKU",
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Subscription}"
              ],
              "visualization": "piechart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "SKU",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "66",
            "name": "query - 2"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "advisorresources\r\n| where type == \"microsoft.advisor/recommendations\"\r\n| where tostring (properties.category) has \"Cost\"\r\n| where properties.impactedField has \"Microsoft.Subscriptions/subscriptions\" or properties.impactedField has \"Microsoft.ReservedInstances/reservedInstances\"\r\n| project AffectedResource=tostring(properties.resourceMetadata.resourceId),Recommendation=tostring(properties.shortDescription.problem),Impact=tostring(properties.impact),resourceGroup,AdditionaInfo=properties.extendedProperties,subscriptionId\r\n",
              "size": 0,
              "title": "Azure Advisor subscriptions recommendations",
              "noDataMessage": "You are following all of our cost recommendations for Subscriptions",
              "noDataMessageStyle": 3,
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Subscription}"
              ],
              "gridSettings": {
                "hierarchySettings": {
                  "treeType": 1,
                  "groupBy": [
                    "Recommendation"
                  ],
                  "expandTopLevel": true
                }
              }
            },
            "name": "query - 12"
          },
          {
            "type": 1,
            "content": {
              "json": "## Tagged vs Untagged Resource Groups\r\n\r\nTags are a crucial part of organizing your Azure resources into a taxonomy. When following best practices for tag management, tags can be the basis for applying your business policies with Azure Policy or tracking costs with Cost Management. No matter how or why you use tags, it's important that you can quickly add, change, and remove those tags on your Azure resources. To see if your Azure resource supports tagging, see [Tag support](https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/tag-support).\r\n\r\nConsider using Azure Policy to place mandatory Tag rules such as Enforce Tags on Resource Groups and inheritance on the Resources.\r\n\r\nhttps://docs.microsoft.com/en-us/azure/azure-resource-manager/management/tag-policies\r\n"
            },
            "name": "text - 5"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ResourceContainers\r\n| where type =~ 'microsoft.resources/subscriptions/resourcegroups'\r\n| extend TagBool = iff(tags != '' and tags != '[]', \"Tagged\",\"Untagged\")\r\n| summarize count() by TagBool\r\n//| project resourceGroup, tags\r\n",
              "size": 0,
              "title": "Tagged Resource Groups",
              "exportFieldName": "resourceGroupTag",
              "exportParameterName": "resourceGroupTag",
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Subscription}"
              ],
              "visualization": "piechart"
            },
            "customWidth": "50",
            "name": "query - 3"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Resources | extend TagBool = iff(tags != '' and tags != '[]', \"Tagged\",\"Untagged\") | summarize count() by TagBool\r\n\r\n",
              "size": 0,
              "title": "Untagged Resource Count",
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Subscription}"
              ],
              "visualization": "piechart"
            },
            "customWidth": "50",
            "name": "query - 7"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "30ab4c42-0169-445b-b482-dc4d50e82dca",
                  "version": "KqlParameterItem/1.0",
                  "name": "ShowTaggedRG",
                  "type": 2,
                  "description": "Show RG with Tags",
                  "isRequired": true,
                  "value": "No",
                  "typeSettings": {
                    "additionalResourceOptions": []
                  },
                  "jsonData": "[\"Yes\", \"No\"]",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "label": "Show tagged resource groups"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "ShowUntaggedRG",
                  "type": 2,
                  "description": "Show RG with Tags",
                  "isRequired": true,
                  "value": "No",
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[\"Yes\", \"No\"]",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "id": "579f68ee-5a65-4b2a-9fda-0c567e194fe0",
                  "label": "Show un-tagged resource groups"
                },
                {
                  "id": "d58029c8-a1ca-4b40-ad00-ad9d749879ac",
                  "version": "KqlParameterItem/1.0",
                  "name": "ShowUntaggedResources",
                  "label": "Show un-tagged resources",
                  "type": 2,
                  "isRequired": true,
                  "value": "No",
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[\"Yes\",\"No\"]",
                  "timeContext": {
                    "durationMs": 86400000
                  }
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 9"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ResourceContainers\r\n| where type =~ 'Microsoft.Resources/subscriptions' \r\n| extend SubscriptionName=name \r\n| join  ( ResourceContainers | where type =~ 'microsoft.resources/subscriptions/resourcegroups'  | where tags !~ '' and tags != '{}'\r\n| extend resourceGroupName=id, RGLocation=location, RGTags=tags) on subscriptionId\r\n| project resourceGroupName, RGTags, RGLocation, SubscriptionName\r\n",
              "size": 0,
              "title": "Tagged Resource Groups",
              "noDataMessageStyle": 3,
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Subscription}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "ShowTaggedRG",
              "comparison": "isEqualTo",
              "value": "Yes"
            },
            "name": "query - 10"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ResourceContainers\r\n| where type =~ 'Microsoft.Resources/subscriptions' \r\n| extend SubscriptionName=name \r\n| join  ( ResourceContainers | where type =~ 'microsoft.resources/subscriptions/resourcegroups' | where tags =~ '' or tags =~ '{}'\r\n| extend resourceGroupName=id, RGLocation=location) on subscriptionId\r\n| project resourceGroupName, RGLocation, SubscriptionName\r\n",
              "size": 0,
              "title": "Untagged Resource Groups",
              "noDataMessageStyle": 3,
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Subscription}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "ShowUntaggedRG",
              "comparison": "isEqualTo",
              "value": "Yes"
            },
            "name": "query - 10 - Copy"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Subscription}"
              ],
              "parameters": [
                {
                  "id": "6e771b18-7292-42da-8d55-581097f4eb70",
                  "version": "KqlParameterItem/1.0",
                  "name": "ResourceType",
                  "label": "Resource Type",
                  "type": 7,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "resources | where tags == ''\r\n| distinct type",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::1",
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                }
              ],
              "style": "pills",
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources"
            },
            "conditionalVisibility": {
              "parameterName": "ShowUntaggedResources",
              "comparison": "isEqualTo",
              "value": "Yes"
            },
            "name": "parameters - 11"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "resources \r\n| where tags =~ '' or tags =~ '{}'\r\n| where type in~ ({ResourceType}) or '*' in~ ({ResourceType})\r\n| project Name=id, subscriptionId\r\n\r\n",
              "size": 0,
              "title": "Untagged Resources",
              "noDataMessage": "No Untagged Resources found",
              "noDataMessageStyle": 3,
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Subscription}"
              ],
              "gridSettings": {
                "rowLimit": 1000,
                "filter": true
              }
            },
            "conditionalVisibility": {
              "parameterName": "ShowUntaggedResources",
              "comparison": "isEqualTo",
              "value": "Yes"
            },
            "name": "query - 10"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isEqualTo",
        "value": "General"
      },
      "name": "Group General",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Azure Hybrid Benefit Overview",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Azure Hybrid Benefit\r\nFor customers with Software Assurance, Azure Hybrid Benefit for Windows Server allows you to use your on-premises Windows Server licenses to run Windows virtual machines on Azure at a reduced cost. This article discusses how to deploy new VMs with Azure Hybrid Benefit for Windows Server enabled, and how you can update any existing running VMs. For more information about Azure Hybrid Benefit for Windows Server licensing and cost savings, see the [Azure Hybrid Benefit for Windows Server licensing page](https://azure.microsoft.com/pricing/hybrid-use-benefit/)\r\n\r\n",
              "style": "upsell"
            },
            "name": "text - 5"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Subscription}"
              ],
              "parameters": [
                {
                  "id": "0c58188b-5c09-45aa-b738-f7122d0e0a19",
                  "version": "KqlParameterItem/1.0",
                  "name": "Location",
                  "type": 2,
                  "description": "Select the region where the VMs are located. Different Regions might have different SKUs",
                  "isRequired": true,
                  "query": "Resources\r\n| where type =~ 'Microsoft.Compute/virtualMachines'\r\n| project name, location\r\n| take 1\r\n| project location\r\n\r\n",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources",
                  "value": "uksouth"
                },
                {
                  "id": "3ee18b0f-2f7b-4a6a-9d1c-526505c7eea2",
                  "version": "KqlParameterItem/1.0",
                  "name": "SingleSubHidden",
                  "type": 1,
                  "isRequired": true,
                  "query": "resourcecontainers\r\n| where type==\"microsoft.resources/subscriptions\"\r\n| take 1\r\n| project subscriptionId",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "isHiddenWhenLocked": true,
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                }
              ],
              "style": "pills",
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources"
            },
            "name": "parameters - 12"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{SingleSubHidden}/providers/Microsoft.Compute/skus?$filter=location eq '{Location}'\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2021-07-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*[?(@.resourceType=='virtualMachines')]\",\"columns\":[{\"path\":\"name\",\"columnid\":\"Name\"},{\"path\":\"capabilities[?(@.name=='vCPUs')].value\",\"columnid\":\"vCPUs\"},{\"path\":\"capabilities[?(@.name=='MemoryGB')].value\",\"columnid\":\"MemoryGB\"},{\"path\":\"capabilities[?(@.name=='MaxNetworkInterfaces')].value\",\"columnid\":\"MaxNetworkInterfaces\"},{\"path\":\"capabilities[?(@.name=='HyperVGenerations')].value\",\"columnid\":\"HyperVGenerations\"},{\"path\":\"capabilities[?(@.name=='vCPUsPerCore')].value\",\"columnid\":\"vCPUsPerCore\"}]}}]}",
              "size": 0,
              "title": "Get VM vCPU",
              "exportParameterName": "ResourceSKU",
              "showExportToExcel": true,
              "queryType": 12,
              "gridSettings": {
                "rowLimit": 5000
              }
            },
            "conditionalVisibility": {
              "parameterName": "AlwaysHidden",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "API-Get_VM_SKU"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "tabs",
              "links": [
                {
                  "id": "3f12a4b6-b18d-4191-8c1c-6045a7edcb6b",
                  "cellValue": "SelectedTab",
                  "linkTarget": "parameter",
                  "linkLabel": "VM/VMSS",
                  "subTarget": "VM",
                  "style": "link"
                },
                {
                  "id": "78ac1878-4b69-4f32-af1f-a8f095afbed5",
                  "cellValue": "SelectedTab",
                  "linkTarget": "parameter",
                  "linkLabel": "SQL",
                  "subTarget": "SQL",
                  "style": "link"
                }
              ]
            },
            "name": "links - 1"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "tabs",
              "links": [
                {
                  "id": "0211f413-9f36-4750-9ef2-d382ba30ba6c",
                  "cellValue": "SelectedSubTab",
                  "linkTarget": "parameter",
                  "linkLabel": "Windows Virtual Machines",
                  "subTarget": "VM",
                  "preText": "VM",
                  "style": "link"
                },
                {
                  "id": "dbe9a7fb-6ab1-4de1-a98b-4ec8a9af906c",
                  "cellValue": "SelectedSubTab",
                  "linkTarget": "parameter",
                  "linkLabel": "Linux Virtual Machines",
                  "subTarget": "LinuxVM",
                  "style": "link"
                },
                {
                  "id": "79e7a97a-1413-41e8-b4c6-ebd1d0a45e2e",
                  "cellValue": "SelectedSubTab",
                  "linkTarget": "parameter",
                  "linkLabel": "VM Scale Set",
                  "subTarget": "VMSS",
                  "style": "link"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "SelectedTab",
              "comparison": "isEqualTo",
              "value": "VM"
            },
            "name": "links - 4"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Virtual Machines",
              "items": [
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\"  | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows' or tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType) == 'Windows'\r\n| where tostring(properties.['licenseType']) !has 'Windows' and tostring(properties.virtualMachineProfile.['licenseType']) !has 'Windows'\r\n| extend WindowsId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.offer), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']), VMSSize=tostring(sku.name)\r\n    ) on subscriptionId \r\n| order by type asc \r\n| project WindowsId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType, subscriptionId",
                          "size": 0,
                          "title": "AHUB Disabled",
                          "noDataMessage": "All of your VMs have AHUB enabled.",
                          "noDataMessageStyle": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              }
                            ]
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - 0"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\"  | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows'\r\n| where tostring(properties.['licenseType']) has \"Windows\"\r\n| extend WindowsId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.offer), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']), VMSSize=tostring(sku.name)\r\n) on subscriptionId \r\n| order by type asc \r\n| project WindowsId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType, subscriptionId",
                          "size": 0,
                          "title": "AHUB Enabled",
                          "noDataMessage": "None of your VMs have AHUB enabled.",
                          "noDataMessageStyle": 4,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              }
                            ]
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "WindowsAHUBEnabled"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resourcechanges\r\n| where properties.changeType == \"Update\" and properties.targetResourceType == \"microsoft.compute/virtualmachines\"\r\n| mv-expand changes = properties.changes\r\n| mv-expand LicenseChanges=changes.['properties.licenseType']\r\n| where isnotnull(LicenseChanges)\r\n| where  tostring(LicenseChanges.newValue) has \"Windows\"\r\n| project VMID=properties.targetResourceId, NewLicense=tostring(LicenseChanges.newValue), DateofChange=todatetime(properties.changeAttributes.timestamp)\r\n",
                          "size": 0,
                          "title": "VM Latest Change Last 7 days",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "VM Latest Change Last 7 days"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{SingleSubHidden}/providers/Microsoft.Compute/skus?$filter=location eq '{Location}'\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2021-07-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*[?(@.resourceType=='virtualMachines')]\",\"columns\":[{\"path\":\"name\",\"columnid\":\"Name\"},{\"path\":\"capabilities[?(@.name=='vCPUs')].value\",\"columnid\":\"vCPUs\"},{\"path\":\"capabilities[?(@.name=='MemoryGB')].value\",\"columnid\":\"MemoryGB\"},{\"path\":\"capabilities[?(@.name=='MaxNetworkInterfaces')].value\",\"columnid\":\"MaxNetworkInterfaces\"},{\"path\":\"capabilities[?(@.name=='HyperVGenerations')].value\",\"columnid\":\"HyperVGenerations\"},{\"path\":\"capabilities[?(@.name=='vCPUsPerCore')].value\",\"columnid\":\"vCPUsPerCore\"}]}}]}",
                          "size": 0,
                          "title": "Get VM vCPU",
                          "exportParameterName": "ResourceSKU",
                          "showExportToExcel": true,
                          "queryType": 12,
                          "gridSettings": {
                            "rowLimit": 5000
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - Get VM vCPU"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Windows Azure Hybrid Benefit (AHUB) Overview"
                        },
                        "name": "text - 15 - Copy"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "Each two-processor license or each set of 16-core licenses, either Datacenter or Standard editions, are entitled to two instances of up to 8 cores, or one instance of up to 16 cores.\r\n\r\nThe virtual machines (VMs) with less than 8 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                          "style": "info"
                        },
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "10px",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\" | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows'\r\n| extend LicenseType = tostring(properties.['licenseType'])\r\n| extend CheckAHUBWindows = case(\r\n     type == 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets', iif((properties.['licenseType'])\r\n     !has 'Windows' and (properties.virtualMachineProfile.['licenseType']) !has 'Windows' , \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not Windows\"\r\n     )\r\n) on subscriptionId \r\n| summarize count() by SubscriptionName, CheckAHUBWindows",
                          "size": 0,
                          "title": "Summary of Windows VMs with or without AHUB per Subscription",
                          "showRefreshButton": true,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "table",
                          "gridSettings": {
                            "sortBy": [
                              {
                                "itemKey": "SubscriptionName",
                                "sortOrder": 1
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "SubscriptionName",
                              "sortOrder": 1
                            }
                          ],
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "CheckAHUBWindows",
                              "formatter": 1
                            },
                            "subtitleContent": {
                              "columnMatch": "SubscriptionName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "chartSettings": {
                            "xAxis": "SubscriptionName"
                          }
                        },
                        "customWidth": "50",
                        "name": "Summary of Windows VMs with or without AHUB"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows'\r\n| extend LicenseType = tostring(properties.['licenseType'])\r\n| extend CheckAHUBWindows = case(\r\n     type == 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets', iif((properties.['licenseType'])\r\n     !has 'Windows' and (properties.virtualMachineProfile.['licenseType']) !has 'Windows' , \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not Windows\"\r\n     )\r\n| summarize count() by CheckAHUBWindows",
                          "size": 0,
                          "title": "Summary of Windows VMs with or without AHUB",
                          "showRefreshButton": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart"
                        },
                        "customWidth": "50",
                        "name": "Summary of Windows VMs with or without AHUB"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Consumed Licenses\r\nTotal number of Windows licenses cores consumed by all Windows virtual machines.\r\n",
                          "style": "info"
                        },
                        "customWidth": "50",
                        "name": "text - 15"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Number of required Cores to enable Windows Azure Hybrid Benefit\r\nNumber of cores required to enable AHUB across the entire environment.",
                          "style": "info"
                        },
                        "customWidth": "50",
                        "name": "text - 15 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"WindowsAHUBEnabled\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[WindowsAHUBEnabled].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"vCPUs\\\"]\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"}]}",
                          "size": 0,
                          "title": "Consumed Cores per AHUB Priority",
                          "noDataMessage": "None of your VMs have AHUB enabled",
                          "noDataMessageStyle": 4,
                          "showRefreshButton": true,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Sev4",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ]
                          },
                          "chartSettings": {
                            "yAxis": [
                              "Consumed Cores per VM"
                            ],
                            "group": "Prioritize AHUB?",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "name": "Consumed Cores per AHUB Priority"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26130\",\"mergeType\":\"inner\",\"leftTable\":\"WindowsAHUBEnabled\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"ConsumedCores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"vCPUs\\\"]\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"}]}",
                          "size": 0,
                          "title": "Consumed Cores per VM",
                          "showRefreshButton": true,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ConsumedCores",
                                "formatter": 0,
                                "formatOptions": {
                                  "aggregation": "Sum"
                                }
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {},
                            "leftContent": {
                              "columnMatch": "ConsumedCores",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              }
                            },
                            "showBorder": false
                          },
                          "graphSettings": {
                            "type": 0
                          },
                          "chartSettings": {
                            "yAxis": [
                              "ConsumedCores"
                            ],
                            "group": "VMName",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "name": "Consumed Cores per VM"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"query - 0\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"vCPUs\\\"]\"}}]},{\"originalName\":\"[query - 0].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"}]}",
                          "size": 0,
                          "title": "Cores not enabled per AHUB Priority",
                          "noDataMessage": "All of your VMs have AHUB enabled",
                          "noDataMessageStyle": 4,
                          "showRefreshButton": true,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Sev4",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ]
                          },
                          "chartSettings": {
                            "yAxis": [
                              "Consumed Cores per VM"
                            ],
                            "group": "Prioritize AHUB?",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "name": "Cores NOT enabled per AHUB Priority"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                              "version": "KqlParameterItem/1.0",
                              "name": "AHUBEnabled",
                              "label": "See VMs with AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                              "version": "KqlParameterItem/1.0",
                              "name": "AHUBDisabled",
                              "label": "See VMs without AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n"
                            },
                            {
                              "id": "20a00706-a89b-42aa-8dea-9c44c93e8014",
                              "version": "KqlParameterItem/1.0",
                              "name": "LastAHUB",
                              "label": "See VMs AHUB enabled in the last 7 days",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "parameters - 13"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "List of Windows VMs without Hybrid Benefit groupped by Subscription.",
                          "style": "info"
                        },
                        "conditionalVisibility": {
                          "parameterName": "AHUBDisabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "text - 18"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"query - 0\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[query - 0].WindowsId\",\"mergedName\":\"VM Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMRG\",\"mergedName\":\"Resource Group\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMSize\",\"mergedName\":\"SKU\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"static\",\"resultVal\":\"High Priority\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"Low Priority\"}}]},{\"originalName\":\"[query - 0].LicenseType\",\"mergedName\":\"License Type\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMLocation\",\"mergedName\":\"Location\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].OSType\",\"mergedName\":\"OS Type\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].OsVersion\",\"mergedName\":\"OS Version\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 0].VMName\"},{\"originalName\":\"[query - 0].VMSSize\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"}]}",
                          "size": 0,
                          "title": "VMs without AHUB",
                          "noDataMessage": "All of your VMs have AHUB enabled",
                          "noDataMessageStyle": 3,
                          "showExportToExcel": true,
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Sev4",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ],
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "subscriptionId"
                              ],
                              "expandTopLevel": true
                            }
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "AHUBDisabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "VM+SKU+vCores"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "List of Windows VMs with Hybrid Benefit groupped by Subscription.",
                          "style": "info"
                        },
                        "conditionalVisibility": {
                          "parameterName": "AHUBEnabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "text - 19"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"WindowsAHUBEnabled\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\",\"mergedName\":\"VM Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\",\"mergedName\":\"Resource Group\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSize\",\"mergedName\":\"VM SKU\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"static\",\"resultVal\":\"High Priority\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"Low Priority\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\",\"mergedName\":\"License Type\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\",\"mergedName\":\"Location\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\",\"mergedName\":\"OS Type\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\",\"mergedName\":\"OS Version\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 0].VMName\"},{\"originalName\":\"[query - 0].VMSSize\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"},{\"originalName\":\"[WindowsAHUBEnabled].VMName\"}]}",
                          "size": 0,
                          "title": "VMs with AHUB",
                          "noDataMessage": "None of your VMs have AHUB enabled",
                          "noDataMessageStyle": 4,
                          "showExportToExcel": true,
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Subscription Name",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              }
                            ],
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "subscriptionId"
                              ],
                              "expandTopLevel": true
                            }
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "AHUBEnabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "VM+SKU+vCores-AHUB"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26168\",\"mergeType\":\"inner\",\"leftTable\":\"VM Latest Change Last 7 days\",\"rightTable\":\"VM+SKU+vCores-AHUB\",\"leftColumn\":\"VMID\",\"rightColumn\":\"VM Name\"}],\"projectRename\":[{\"originalName\":\"[VM Latest Change Last 7 days].VMID\",\"mergedName\":\"VMID\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days].NewLicense\",\"mergedName\":\"NewLicense\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days].DateofChange\",\"mergedName\":\"DateofChange\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].VM Name\",\"mergedName\":\"VM Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].Resource Group\",\"mergedName\":\"Resource Group\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].VM SKU\",\"mergedName\":\"VM SKU\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].Prioritize AHUB?\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].License Type\",\"mergedName\":\"License Type\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].Consumed Cores per VM\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].Location\",\"mergedName\":\"Location\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].OS Type\",\"mergedName\":\"OS Type\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].OS Version\",\"mergedName\":\"OS Version\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"}]}",
                          "size": 0,
                          "title": "Total Cores Enabled last 7 Days",
                          "noDataMessage": "Windows AHUB hasn't been enabled in the last 7 days",
                          "showRefreshButton": true,
                          "queryType": 7,
                          "visualization": "barchart",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "NewLicense",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "vCPUs",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "chartSettings": {
                            "xAxis": "VM Name",
                            "yAxis": [
                              "Consumed Cores per VM"
                            ],
                            "group": null,
                            "createOtherGroup": 0,
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Consumed Cores per VM",
                                "color": "grayBlue"
                              }
                            ]
                          }
                        },
                        "name": "Total Cores Enabled last 7 Days"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26168\",\"mergeType\":\"inner\",\"leftTable\":\"VM Latest Change Last 7 days\",\"rightTable\":\"VM+SKU+vCores-AHUB\",\"leftColumn\":\"VMID\",\"rightColumn\":\"VM Name\"}],\"projectRename\":[{\"originalName\":\"[VM+SKU+vCores-AHUB].VM Name\",\"mergedName\":\"VM Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].Resource Group\",\"mergedName\":\"Resource Group\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days].NewLicense\",\"mergedName\":\"NewLicense\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days].DateofChange\",\"mergedName\":\"DateofChange\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].VM SKU\",\"mergedName\":\"VM SKU\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].Consumed Cores per VM\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].Prioritize AHUB?\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].Location\",\"mergedName\":\"Location\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VM Latest Change Last 7 days].VMID\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].OS Type\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].OS Version\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].License Type\"}]}",
                          "size": 0,
                          "title": "Total Cores Enabled last 7 Days - Detailed view",
                          "noDataMessage": "No AHUB has been enabled in the last 7 days",
                          "showExportToExcel": true,
                          "queryType": 7,
                          "visualization": "table",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "NewLicense",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "vCPUs",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "chartSettings": {
                            "xAxis": "VM Name",
                            "yAxis": [
                              "Consumed Cores per VM"
                            ],
                            "group": null,
                            "createOtherGroup": 0,
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Consumed Cores per VM",
                                "color": "grayBlue"
                              }
                            ]
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "LastAHUB",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "showPin": false,
                        "name": "Total Cores Enabled last 7 Days - Details"
                      }
                    ]
                  },
                  "name": "VM"
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "SelectedTab",
                "comparison": "isEqualTo",
                "value": "VM"
              },
              {
                "parameterName": "SelectedSubTab",
                "comparison": "isEqualTo",
                "value": "VM"
              },
              {
                "parameterName": "RG_Filter",
                "comparison": "isEqualTo",
                "value": "Resource Group"
              }
            ],
            "name": "VM/VMSS-RGFilter"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Virtual Machines",
              "items": [
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows' or tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType) == 'Windows'\r\n| where tostring(properties.['licenseType']) !has 'Windows' and tostring(properties.virtualMachineProfile.['licenseType']) !has 'Windows'\r\n| extend WindowsId=id, VMName=name,tagName,tagValue, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.offer), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']), VMSSize=tostring(sku.name)\r\n    ) on subscriptionId \r\n| order by type asc \r\n| project WindowsId,VMName,VMRG,tagName,tagValue,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType, subscriptionId",
                          "size": 0,
                          "title": "AHUB Disabled",
                          "noDataMessage": "All of your VMs have AHUB enabled.",
                          "noDataMessageStyle": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              }
                            ]
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "AHUBDisabled-TagFilter"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows'\r\n| where tostring(properties.['licenseType']) has \"Windows\"\r\n| extend WindowsId=id, VMName=name,tagName,tagValue, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.offer), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']), VMSSize=tostring(sku.name)\r\n) on subscriptionId \r\n| order by type asc \r\n| project WindowsId,VMName,VMRG, tagName,tagValue,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType, subscriptionId",
                          "size": 0,
                          "title": "AHUB Enabled",
                          "noDataMessage": "None of your VMs have AHUB enabled.",
                          "noDataMessageStyle": 4,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              }
                            ]
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "WindowsAHUBEnabledTagFilter"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resourcechanges\r\n| where properties.changeType == \"Update\" and properties.targetResourceType == \"microsoft.compute/virtualmachines\"\r\n| mv-expand changes = properties.changes\r\n| mv-expand LicenseChanges=changes.['properties.licenseType']\r\n| where isnotnull(LicenseChanges)\r\n| where  tostring(LicenseChanges.newValue) has \"Windows\"\r\n| project VMID=properties.targetResourceId, NewLicense=tostring(LicenseChanges.newValue), DateofChange=todatetime(properties.changeAttributes.timestamp)\r\n",
                          "size": 0,
                          "title": "VM Latest Change Last 7 days",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "VM Latest Change Last 7 days-TagFilter"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{SingleSubHidden}/providers/Microsoft.Compute/skus?$filter=location eq '{Location}'\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2021-07-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*[?(@.resourceType=='virtualMachines')]\",\"columns\":[{\"path\":\"name\",\"columnid\":\"Name\"},{\"path\":\"capabilities[?(@.name=='vCPUs')].value\",\"columnid\":\"vCPUs\"},{\"path\":\"capabilities[?(@.name=='MemoryGB')].value\",\"columnid\":\"MemoryGB\"},{\"path\":\"capabilities[?(@.name=='MaxNetworkInterfaces')].value\",\"columnid\":\"MaxNetworkInterfaces\"},{\"path\":\"capabilities[?(@.name=='HyperVGenerations')].value\",\"columnid\":\"HyperVGenerations\"},{\"path\":\"capabilities[?(@.name=='vCPUsPerCore')].value\",\"columnid\":\"vCPUsPerCore\"}]}}]}",
                          "size": 0,
                          "title": "Get VM vCPU",
                          "exportParameterName": "ResourceSKU",
                          "showExportToExcel": true,
                          "queryType": 12,
                          "gridSettings": {
                            "rowLimit": 5000
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "query - Get VM vCPU"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Windows Azure Hybrid Benefit (AHUB) Overview"
                        },
                        "name": "text - 15 - Copy"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "Each two-processor license or each set of 16-core licenses, either Datacenter or Standard editions, are entitled to two instances of up to 8 cores, or one instance of up to 16 cores.\r\n\r\nThe virtual machines (VMs) with less than 8 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                          "style": "info"
                        },
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "10px",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows'\r\n| extend LicenseType = tostring(properties.['licenseType'])\r\n| extend CheckAHUBWindows = case(\r\n     type == 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets', iif((properties.['licenseType'])\r\n     !has 'Windows' and (properties.virtualMachineProfile.['licenseType']) !has 'Windows' , \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not Windows\"\r\n     )\r\n) on subscriptionId \r\n| summarize count() by SubscriptionName, CheckAHUBWindows",
                          "size": 0,
                          "title": "Summary of Windows VMs with or without AHUB per Subscription",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "CheckAHUBWindows",
                              "formatter": 1
                            },
                            "subtitleContent": {
                              "columnMatch": "SubscriptionName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "chartSettings": {
                            "xAxis": "SubscriptionName"
                          }
                        },
                        "customWidth": "50",
                        "name": "Summary of Windows VMs with or without AHUB"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows'\r\n| extend LicenseType = tostring(properties.['licenseType'])\r\n| extend CheckAHUBWindows = case(\r\n     type == 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets', iif((properties.['licenseType'])\r\n     !has 'Windows' and (properties.virtualMachineProfile.['licenseType']) !has 'Windows' , \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not Windows\"\r\n     )\r\n| summarize count() by CheckAHUBWindows",
                          "size": 0,
                          "title": "Summary of Windows VMs with or without AHUB",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart"
                        },
                        "customWidth": "50",
                        "name": "Summary of Windows VMs with or without AHUB"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Consumed Licenses\r\nTotal number of Windows licenses cores consumed by all Windows virtual machines.\r\n",
                          "style": "info"
                        },
                        "customWidth": "50",
                        "name": "Consumed Licenses-TagFilter"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Number of required Cores to enable Windows Azure Hybrid Benefit\r\nNumber of cores required to enable AHUB across the entire environment.",
                          "style": "info"
                        },
                        "customWidth": "50",
                        "name": "Number of required Cores to enable Windows Azure Hybrid Benefit-TagFilter"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"WindowsAHUBEnabledTagFilter\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\" ([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"}]}",
                          "size": 0,
                          "title": "Consumed Cores per AHUB Priority",
                          "noDataMessage": "None of your VMs have AHUB enabled",
                          "noDataMessageStyle": 4,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Sev4",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ]
                          },
                          "chartSettings": {
                            "yAxis": [
                              "Consumed Cores per VM"
                            ],
                            "group": "Prioritize AHUB?",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "name": "Consumed Cores per AHUB Priority-TagFilter"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26130\",\"mergeType\":\"inner\",\"leftTable\":\"WindowsAHUBEnabledTagFilter\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"ConsumedCores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"}]}",
                          "size": 0,
                          "title": "Consumed Cores per VM",
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ConsumedCores",
                                "formatter": 0,
                                "formatOptions": {
                                  "aggregation": "Sum"
                                }
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {},
                            "leftContent": {
                              "columnMatch": "ConsumedCores",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              }
                            },
                            "showBorder": false
                          },
                          "graphSettings": {
                            "type": 0
                          },
                          "chartSettings": {
                            "yAxis": [
                              "ConsumedCores"
                            ],
                            "group": "VMName",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "name": "Consumed Cores per VM-TagFilter"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"AHUBDisabled-TagFilter\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\" ([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 0].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 0].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"unknown\"},{\"originalName\":\"[AHUBDisabled-TagFilter].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"}]}",
                          "size": 0,
                          "title": "Cores not enabled per AHUB Priority",
                          "noDataMessage": "All of your VMs have AHUB enabled",
                          "noDataMessageStyle": 4,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Sev4",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ]
                          },
                          "chartSettings": {
                            "yAxis": [
                              "Consumed Cores per VM"
                            ],
                            "group": "Prioritize AHUB?",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "name": "Cores NOT enabled per AHUB Priority-TagFilter"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                              "version": "KqlParameterItem/1.0",
                              "name": "AHUBEnabled",
                              "label": "See VMs with AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "value": "Yes"
                            },
                            {
                              "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                              "version": "KqlParameterItem/1.0",
                              "name": "AHUBDisabled",
                              "label": "See VMs without AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                              "value": "Yes"
                            },
                            {
                              "id": "20a00706-a89b-42aa-8dea-9c44c93e8014",
                              "version": "KqlParameterItem/1.0",
                              "name": "LastAHUB",
                              "label": "See VMs AHUB enabled in the last 7 days",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                              "value": "Yes"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "parameters - 13"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "List of Windows VMs without Hybrid Benefit groupped by Subscription.",
                          "style": "info"
                        },
                        "conditionalVisibility": {
                          "parameterName": "AHUBDisabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "List of Windows VMs without Hybrid Benefit-TagFilter"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"AHUBDisabled-TagFilter\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"static\",\"resultVal\":\"High Priority\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"Low Priority\"}}]},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[AHUBDisabled-TagFilter].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMName\"},{\"originalName\":\"[query - 0].VMSSize\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"}]}",
                          "size": 0,
                          "title": "VMs without AHUB",
                          "noDataMessage": "All of your VMs have AHUB enabled",
                          "noDataMessageStyle": 3,
                          "showExportToExcel": true,
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Sev4",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ],
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "subscriptionId"
                              ],
                              "expandTopLevel": true
                            }
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "AHUBDisabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "VM+SKU+vCores-AHUBDisabled-TagFilter"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "List of Windows VMs with Hybrid Benefit groupped by Subscription.",
                          "style": "info"
                        },
                        "conditionalVisibility": {
                          "parameterName": "AHUBEnabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "text - 19"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"WindowsAHUBEnabledTagFilter\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[WindowsAHUBEnabledTagFilter].WindowsId\",\"mergedName\":\"VM Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"static\",\"resultVal\":\"High Priority\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"Low Priority\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMName\"},{\"originalName\":\"[query - 0].VMSSize\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"},{\"originalName\":\"[WindowsAHUBEnabled].VMName\"}]}",
                          "size": 0,
                          "title": "VMs with AHUB",
                          "noDataMessage": "None of your VMs have AHUB enabled",
                          "noDataMessageStyle": 4,
                          "showExportToExcel": true,
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Subscription Name",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              }
                            ],
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "subscriptionId"
                              ],
                              "expandTopLevel": true
                            }
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "AHUBEnabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "VM+SKU+vCores-AHUB-TagFilter"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26168\",\"mergeType\":\"inner\",\"leftTable\":\"VM Latest Change Last 7 days-TagFilter\",\"rightTable\":\"WindowsAHUBEnabledTagFilter\",\"leftColumn\":\"VMID\",\"rightColumn\":\"VMName\"}],\"projectRename\":[{\"originalName\":\"[VM+SKU+vCores-AHUB].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VM Latest Change Last 7 days-TagFilter].VMID\",\"mergedName\":\"VMID\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days-TagFilter].NewLicense\",\"mergedName\":\"NewLicense\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days-TagFilter].DateofChange\",\"mergedName\":\"DateofChange\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"}]}",
                          "size": 0,
                          "title": "Total Cores Enabled last 7 Days",
                          "noDataMessage": "Windows AHUB hasn't been enabled in the last 7 days",
                          "queryType": 7,
                          "visualization": "barchart",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "NewLicense",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "vCPUs",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "chartSettings": {
                            "xAxis": "VM Name",
                            "yAxis": [
                              "Consumed Cores per VM"
                            ],
                            "group": null,
                            "createOtherGroup": 0,
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Consumed Cores per VM",
                                "color": "grayBlue"
                              }
                            ]
                          }
                        },
                        "name": "Total Cores Enabled last 7 Days"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26168\",\"mergeType\":\"inner\",\"leftTable\":\"VM Latest Change Last 7 days-TagFilter\",\"rightTable\":\"VM+SKU+vCores-AHUB-TagFilter\",\"leftColumn\":\"VMID\",\"rightColumn\":\"VM Name\"}],\"projectRename\":[{\"originalName\":\"[VM+SKU+vCores-AHUB].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VM Latest Change Last 7 days-TagFilter].VMID\",\"mergedName\":\"VMID\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days-TagFilter].NewLicense\",\"mergedName\":\"NewLicense\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days-TagFilter].DateofChange\",\"mergedName\":\"DateofChange\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].VM Name\",\"mergedName\":\"VM Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].Prioritize AHUB?\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].Consumed Cores per VM\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].Name\",\"mergedName\":\"Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days].VMID\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].OS Type\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].OS Version\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].License Type\"}]}",
                          "size": 0,
                          "title": "Total Cores Enabled last 7 Days - Detailed view",
                          "noDataMessage": "No AHUB has been enabled in the last 7 days",
                          "showExportToExcel": true,
                          "queryType": 7,
                          "visualization": "table",
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "NewLicense",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "vCPUs",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "chartSettings": {
                            "xAxis": "VM Name",
                            "yAxis": [
                              "Consumed Cores per VM"
                            ],
                            "group": null,
                            "createOtherGroup": 0,
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Consumed Cores per VM",
                                "color": "grayBlue"
                              }
                            ]
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "LastAHUB",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "showPin": false,
                        "name": "Total Cores Enabled last 7 Days - Details"
                      }
                    ]
                  },
                  "name": "VM"
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "SelectedTab",
                "comparison": "isEqualTo",
                "value": "VM"
              },
              {
                "parameterName": "SelectedSubTab",
                "comparison": "isEqualTo",
                "value": "VM"
              },
              {
                "parameterName": "RG_Filter",
                "comparison": "isEqualTo",
                "value": "Tags"
              }
            ],
            "name": "VM/VMSS-TagsFilter"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "SQL Overview",
              "items": [
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "0211f413-9f36-4750-9ef2-d382ba30ba6c",
                        "cellValue": "SelectedSubTab",
                        "linkTarget": "parameter",
                        "linkLabel": "SQL Server VMs",
                        "subTarget": "SQLVM",
                        "preText": "VM",
                        "style": "link"
                      },
                      {
                        "id": "79e7a97a-1413-41e8-b4c6-ebd1d0a45e2e",
                        "cellValue": "SelectedSubTab",
                        "linkTarget": "parameter",
                        "linkLabel": "SQL DB",
                        "subTarget": "SQLDB",
                        "style": "link"
                      },
                      {
                        "id": "1f381e5b-7071-41ce-a354-c2df93445cae",
                        "cellValue": "SelectedSubTab",
                        "linkTarget": "parameter",
                        "linkLabel": "SQL Managed Instances",
                        "subTarget": "SQLMI",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 4"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\" | extend SubscriptionName=name \r\n| join (\r\n     resources | where type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines' and tostring(properties.['sqlServerLicenseType']) != 'AHUB' and resourceGroup in ({ResourceGroup})\r\n    | extend SQLID=id, VMName = name, VMRG = resourceGroup, VMLocation = location, LicenseType = tostring(properties.['sqlServerLicenseType']), OSType=tostring(properties.storageProfile.imageReference.offer), SQLAgentType = tostring(properties.['sqlManagement']), SQLVersion = tostring(properties.['sqlImageOffer']), SQLSKU=tostring(properties.['sqlImageSku'])\r\n    ) on subscriptionId \r\n| join (\r\n    resources\r\n    | where type =~ 'Microsoft.Compute/virtualmachines'\r\n    | project VMName = tolower(name), VMSize = tostring(properties.hardwareProfile.vmSize)\r\n    ) on VMName\r\n| order by id asc    \r\n| project SQLID,VMName,VMRG, VMLocation, VMSize, SQLVersion, SQLSKU, SQLAgentType, LicenseType, SubscriptionName\r\n| where SQLSKU != \"Developer\" and SQLSKU != \"Express\"",
                          "size": 0,
                          "title": "SQL VM AHUB Disabled",
                          "noDataMessage": "All of your VMs have AHUB enabled.",
                          "noDataMessageStyle": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "Get-SQL-AHUB-Disabled"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\" | extend SubscriptionName=name \r\n| join (\r\n     resources | where type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines' and tostring(properties.['sqlServerLicenseType']) == 'AHUB' and resourceGroup in ({ResourceGroup})\r\n    | extend SQLID=id, VMName = name, VMRG = resourceGroup, VMLocation = location, LicenseType = tostring(properties.['sqlServerLicenseType']), OSType=tostring(properties.storageProfile.imageReference.offer), SQLAgentType = tostring(properties.['sqlManagement']), SQLVersion = tostring(properties.['sqlImageOffer']), SQLSKU=tostring(properties.['sqlImageSku'])\r\n    ) on subscriptionId \r\n| join (\r\n    resources\r\n    | where type =~ 'Microsoft.Compute/virtualmachines'\r\n    | project VMName = tolower(name), VMSize = tostring(properties.hardwareProfile.vmSize)\r\n    ) on VMName\r\n| order by id asc    \r\n| project SQLID,VMName,VMRG, VMLocation, VMSize, SQLVersion, SQLSKU, SQLAgentType, LicenseType, SubscriptionName\r\n| where SQLSKU != \"Developer\" and SQLSKU != \"Express\"",
                          "size": 0,
                          "title": "SQL VM AHUB Enabled",
                          "noDataMessage": "None of your VMs have AHUB enabled.",
                          "noDataMessageStyle": 5,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "Get-SQL-AHUB-Enabled"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## SQL Virtual Machines Azure Hybrid Benefit (AHUB) Overview"
                        },
                        "name": "SQL Text"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "Apply to SQL Server 1 to 4 vCPUs exchange: For every 1 core of SQL Server Enterprise Edition, you get 4 vCPUs of SQL Managed Instance or Azure SQL Database general purpose and Hyperscale tiers, or 4 vCPUs of SQL Server Standard edition on Azure VMs.\r\n\r\nThe SQL virtual machines (VMs) with less than 4 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                          "style": "info"
                        },
                        "name": "SQL License Info",
                        "styleSettings": {
                          "margin": "10px",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### AHUB Overview\r\nSummary of all SQL on VMs with and without SQL AHUB.",
                          "style": "info"
                        },
                        "name": "text - 15"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "loadType": "explicit",
                          "loadButtonText": "Load SQL Info",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\" | extend SubscriptionName=name \r\n| join (\r\n    resources | where type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines' and resourceGroup in ({ResourceGroup})\r\n    | extend SQLID=id, VMName = name, VMRG = resourceGroup, VMLocation = location, LicenseType = tostring(properties.['sqlServerLicenseType']), OSType=tostring(properties.storageProfile.imageReference.offer), SQLAgentType = tostring(properties.['sqlManagement']), SQLVersion = tostring(properties.['sqlImageOffer']), SQLSKU=tostring(properties.['sqlImageSku'])\r\n    | where SQLSKU != \"Developer\" and SQLSKU != \"Express\"\r\n    | extend CheckSQLVMAHUB = case(\r\n     type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines', iif((properties.['sqlServerLicenseType'])\r\n     !has 'AHUB', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not SQL\"\r\n     )\r\n    ) on subscriptionId \r\n| summarize count() by SubscriptionName, CheckSQLVMAHUB",
                                "size": 0,
                                "title": "Summary of SQL on VMs with or without AHUB per Subscription",
                                "showRefreshButton": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Prioritize AHUB?",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "High Priority",
                                            "representation": "Sev0",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Low Priority",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "unknown",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                },
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "CheckSQLVMAHUB",
                                    "formatter": 1
                                  },
                                  "subtitleContent": {
                                    "columnMatch": "SubscriptionName",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                },
                                "chartSettings": {
                                  "xAxis": "SubscriptionName"
                                }
                              },
                              "customWidth": "50",
                              "name": "Summary of SQL on VMs with or without AHUB"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\"  | extend SubscriptionName=name \r\n| join (\r\n    resources | where type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines' and resourceGroup in ({ResourceGroup})\r\n    | extend SQLID=id, VMName = name, VMRG = resourceGroup, VMLocation = location, LicenseType = tostring(properties.['sqlServerLicenseType']), OSType=tostring(properties.storageProfile.imageReference.offer), SQLAgentType = tostring(properties.['sqlManagement']), SQLVersion = tostring(properties.['sqlImageOffer']), SQLSKU=tostring(properties.['sqlImageSku'])\r\n    | extend CheckSQLVMAHUB = case(\r\n     type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines', iif((properties.['sqlServerLicenseType'])\r\n     !has 'AHUB', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not SQL\"\r\n     )\r\n    ) on subscriptionId \r\n| summarize count() by CheckSQLVMAHUB",
                                "size": 0,
                                "title": "Summary SQL Enabled and Disabled",
                                "noDataMessage": "You don't have any SQL VM",
                                "showRefreshButton": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "piechart"
                              },
                              "customWidth": "50",
                              "name": "Summary SQL Enabled and Disabled"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Consumed Licenses\r\nTotal number of SQL licenses cores consumed by all SQL running on Virtual Machines.\r\n",
                                "style": "info"
                              },
                              "customWidth": "50",
                              "name": "text - 15"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Number of required Cores to enable SQL Azure Hybrid Benefit\r\nNumber of cores required to enable SQL AHUB across the entire environment.\r\n\r\n\r\n",
                                "style": "info"
                              },
                              "customWidth": "50",
                              "name": "text - 15 - Copy"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640e8\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Enabled\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLID\",\"mergedName\":\"SQLID\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"}]}",
                                "size": 0,
                                "title": "SQL VM AHUB Consumed Cores per VM",
                                "noDataMessage": "None of your VMs have AHUB enabled.",
                                "noDataMessageStyle": 4,
                                "showRefreshButton": true,
                                "queryType": 7,
                                "visualization": "piechart",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Prioritize AHUB?",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "High Priority",
                                            "representation": "Sev0",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Low Priority",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "unknown",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                },
                                "chartSettings": {
                                  "yAxis": [
                                    "Consumed Cores"
                                  ],
                                  "group": "VMName",
                                  "createOtherGroup": null
                                }
                              },
                              "customWidth": "33",
                              "name": "Summary SQL+SKU AHUB Enabled - per VM"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640e8\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Enabled\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLID\",\"mergedName\":\"SQLID\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMName\"}]}",
                                "size": 0,
                                "title": "SQL VM AHUB Consumed Cores per Priority",
                                "noDataMessage": "None of your VMs have AHUB enabled.",
                                "noDataMessageStyle": 4,
                                "showRefreshButton": true,
                                "queryType": 7,
                                "visualization": "piechart",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Prioritize AHUB?",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "High Priority",
                                            "representation": "Sev0",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Low Priority",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "unknown",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                },
                                "chartSettings": {
                                  "group": "Prioritize AHUB?",
                                  "createOtherGroup": null
                                }
                              },
                              "customWidth": "33",
                              "showPin": false,
                              "name": "Summary SQL+SKU AHUB Enabled -"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640b5\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Disabled\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLID\",\"mergedName\":\"SQLID\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"}]}",
                                "size": 0,
                                "title": "Cores not enabled per AHUB Priority",
                                "noDataMessage": "All of your VMs have AHUB enabled.",
                                "noDataMessageStyle": 3,
                                "showRefreshButton": true,
                                "queryType": 7,
                                "visualization": "piechart",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Prioritize AHUB?",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "High Priority",
                                            "representation": "Sev0",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Low Priority",
                                            "representation": "warning",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                },
                                "sortBy": [],
                                "chartSettings": {
                                  "yAxis": [
                                    "Consumed Cores"
                                  ],
                                  "showMetrics": false,
                                  "showLegend": true
                                }
                              },
                              "customWidth": "33",
                              "showPin": false,
                              "name": " Summary - SQL Cores AHUB Disabled "
                            }
                          ]
                        },
                        "name": "SQL Overview RG"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                              "version": "KqlParameterItem/1.0",
                              "name": "SQLAVMHUBEnabled",
                              "label": "See SQL  VMs with AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "value": "Yes"
                            },
                            {
                              "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                              "version": "KqlParameterItem/1.0",
                              "name": "SQLVMAHUBDisabled",
                              "label": "See SQL VMs without AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                              "value": "Yes"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "parameters - 13"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640b5\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Disabled\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLID\",\"mergedName\":\"VM Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLID\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMName\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMRG\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMLocation\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLVersion\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLSKU\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLAgentType\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].LicenseType\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SubscriptionName\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMSize\"}]}",
                                "size": 0,
                                "title": "SQL VM AHUB Disabled",
                                "noDataMessage": "All of your VMs have AHUB enabled.",
                                "noDataMessageStyle": 3,
                                "showExportToExcel": true,
                                "queryType": 7,
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "$gen_group",
                                      "formatter": 15,
                                      "formatOptions": {
                                        "linkTarget": null,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Group",
                                      "formatter": 15,
                                      "formatOptions": {
                                        "linkTarget": null,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Prioritize AHUB?",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "High Priority",
                                            "representation": "Sev0",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Low Priority",
                                            "representation": "warning",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "success",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ],
                                  "hierarchySettings": {
                                    "treeType": 1,
                                    "groupBy": [
                                      "SubscriptionName"
                                    ],
                                    "expandTopLevel": true
                                  }
                                },
                                "sortBy": []
                              },
                              "conditionalVisibility": {
                                "parameterName": "SQLVMAHUBDisabled",
                                "comparison": "isEqualTo",
                                "value": "Yes"
                              },
                              "showPin": false,
                              "name": "SQL+SKU AHUB Disabled"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640e8\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Enabled\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLID\",\"mergedName\":\"SQLID\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMName\"}]}",
                                "size": 0,
                                "title": "SQL VM AHUB Enabled",
                                "noDataMessage": "None of your VMs have AHUB enabled.",
                                "noDataMessageStyle": 4,
                                "showExportToExcel": true,
                                "queryType": 7,
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "$gen_group",
                                      "formatter": 15,
                                      "formatOptions": {
                                        "linkTarget": null,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Group",
                                      "formatter": 15,
                                      "formatOptions": {
                                        "linkTarget": null,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Prioritize AHUB?",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "High Priority",
                                            "representation": "Sev0",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Low Priority",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "unknown",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    },
                                    {
                                      "columnMatch": "Subscription",
                                      "formatter": 15,
                                      "formatOptions": {
                                        "linkTarget": null,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "hierarchySettings": {
                                    "treeType": 1,
                                    "groupBy": [
                                      "SubscriptionName"
                                    ],
                                    "expandTopLevel": true
                                  }
                                }
                              },
                              "conditionalVisibility": {
                                "parameterName": "SQLAVMHUBEnabled",
                                "comparison": "isEqualTo",
                                "value": "Yes"
                              },
                              "showPin": false,
                              "name": "SQL+SKU AHUB Enabled"
                            }
                          ]
                        },
                        "name": "SQL Detailed Info"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "SelectedSubTab",
                    "comparison": "isEqualTo",
                    "value": "SQLVM"
                  },
                  "name": "SQL VM"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SQL Database",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\"\r\n| extend SubscriptionName=name | join (resources |  where type =~ 'Microsoft.Sql/servers/databases' and name != 'master' and tostring(properties.['licenseType']) == 'LicenseIncluded' \r\n| extend   SQLDBID=id,SQLName = name, SQLRG = resourceGroup, SKUName=tostring(sku.name), SKUTier=tostring(sku.tier), vCores=tostring(sku.capacity), SQLLocation = location, LicenseType = tostring(properties.['licenseType']), StorageAccountType=tostring(properties.['storageAccountType'])\r\n| extend CheckSQLDBAHUB = case(\r\n type =~ 'Microsoft.Sql/servers/databases', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    )\r\n) on subscriptionId \r\n| project SQLDBID,SQLName,SQLRG, SKUName, SKUTier, vCores, CheckSQLDBAHUB,SQLLocation, LicenseType, StorageAccountType, SubscriptionName\r\n",
                          "size": 0,
                          "title": "AHUB Disabled",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "SQLDB AHUB Disabled"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\"\r\n| extend SubscriptionName=name | join (resources |  where type =~ 'Microsoft.Sql/servers/databases' and name != 'master' and tostring(properties.['licenseType']) != 'LicenseIncluded' and kind !has 'serverless'\r\n| extend   SQLDBID=id,SQLName = name, SQLRG = resourceGroup, SKUName=sku.name, SKUTier=sku.tier, SQLLocation = location, vCores=tostring(sku.capacity), LicenseType = tostring(properties.['licenseType']), StorageAccountType=tostring(properties.['storageAccountType'])) on subscriptionId \r\n| project SQLDBID,SQLName,SQLRG, SKUName, SKUTier, vCores, SQLLocation, LicenseType, StorageAccountType, SubscriptionName\r\n",
                          "size": 0,
                          "title": "AHUB Enabled",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "SQLDB AHUB Enabled"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## SQL Databases Azure Hybrid Benefit (AHUB) Overview"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "Apply to SQL Server 1 to 4 vCPUs exchange: For every 1 core of SQL Server Enterprise Edition, you get 4 vCPUs of SQL Managed Instance or Azure SQL Database general purpose and Hyperscale tiers, or 4 vCPUs of SQL Server Standard edition on Azure VMs.\r\n\r\nThe SQL virtual machines (VMs) with less than 4 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                          "style": "info"
                        },
                        "name": "text - 3"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### AHUB Overview\r\nSummary of all SQL Databases with and without SQL AHUB.",
                          "style": "info"
                        },
                        "name": "text - 15"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "loadType": "explicit",
                          "loadButtonText": "Load SQL DB Info",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\" | extend SubscriptionName=name \r\n| join (\r\n    resources | where type =~ 'Microsoft.Sql/servers/databases' and name != 'master'\r\n     | extend   SQLDBID=id,SQLName = name, SQLRG = resourceGroup, SKUName=sku.name, SKUTier=sku.tier, SQLLocation = location, LicenseType = tostring(properties.['licenseType']), StorageAccountType=tostring(properties.['storageAccountType'])\r\n     | extend CheckSQLDBAHUB = case(\r\n     type =~ 'Microsoft.Sql/servers/databases', iif((properties.['licenseType'])\r\n     has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not SQL DB\"\r\n     )\r\n    ) on subscriptionId \r\n| summarize count() by SubscriptionName, CheckSQLDBAHUB",
                                "size": 0,
                                "title": "Summary of SQL Databases with or without AHUB per Subscription",
                                "showRefreshButton": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Prioritize AHUB?",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "High Priority",
                                            "representation": "Sev0",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Low Priority",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "unknown",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                },
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "CheckSQLDBAHUB",
                                    "formatter": 1
                                  },
                                  "subtitleContent": {
                                    "columnMatch": "SubscriptionName",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                },
                                "chartSettings": {
                                  "xAxis": "SubscriptionName"
                                }
                              },
                              "customWidth": "50",
                              "name": "Summary of SQL DBs with or without AHUB per subs"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\" | extend SubscriptionName=name \r\n| join (\r\n    resources | where type =~ 'Microsoft.Sql/servers/databases' and name != 'master'\r\n     | extend   SQLDBID=id,SQLName = name, SQLRG = resourceGroup, SKUName=sku.name, SKUTier=sku.tier, SQLLocation = location, LicenseType = tostring(properties.['licenseType']), StorageAccountType=tostring(properties.['storageAccountType'])\r\n     | extend CheckSQLDBAHUB = case(\r\n     type =~ 'Microsoft.Sql/servers/databases', iif((properties.['licenseType'])\r\n     has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not SQL DB\"\r\n     )\r\n    ) on subscriptionId \r\n| summarize count() by CheckSQLDBAHUB",
                                "size": 0,
                                "title": "Summary of SQL Databases with or without AHUB",
                                "showRefreshButton": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "piechart",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Prioritize AHUB?",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "High Priority",
                                            "representation": "Sev0",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Low Priority",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "unknown",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                },
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "CheckSQLDBAHUB",
                                    "formatter": 1
                                  },
                                  "subtitleContent": {
                                    "columnMatch": "SubscriptionName",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    }
                                  },
                                  "showBorder": false,
                                  "size": "auto"
                                },
                                "chartSettings": {
                                  "xAxis": "SubscriptionName"
                                }
                              },
                              "customWidth": "50",
                              "name": "Summary of SQL DBs with or without AHUB "
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Consumed Licenses\r\nTotal number of SQL licenses cores consumed by all SQL Databases\r\n",
                                "style": "info"
                              },
                              "customWidth": "50",
                              "name": "text - 15"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Number of required Cores to enable SQL Azure Hybrid Benefit\r\nNumber of cores required to enable SQL AHUB across the entire environment.\r\n\r\n\r\n",
                                "style": "info"
                              },
                              "customWidth": "50",
                              "name": "Text SQL DB"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Enabled\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Enabled].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"}]}",
                                "size": 0,
                                "title": "SQL DB AHUB Consumed Cores per VM",
                                "noDataMessage": "None of your SQL DB have AHUB enabled.",
                                "noDataMessageStyle": 4,
                                "showRefreshButton": true,
                                "queryType": 7,
                                "visualization": "piechart",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Prioritize AHUB?",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "High Priority",
                                            "representation": "Sev0",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Low Priority",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "unknown",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                },
                                "chartSettings": {
                                  "yAxis": [
                                    "Consumed Cores"
                                  ],
                                  "group": "SQLName",
                                  "createOtherGroup": null
                                }
                              },
                              "customWidth": "33",
                              "name": "Summary SQLDB+SKU AHUB Enabled - per VM"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Enabled\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Enabled].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"}]}",
                                "size": 0,
                                "title": "SQL DB AHUB Consumed Cores per Priority",
                                "noDataMessage": "None of your SQL DB have AHUB enabled.",
                                "noDataMessageStyle": 4,
                                "showRefreshButton": true,
                                "queryType": 7,
                                "visualization": "piechart",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Prioritize AHUB?",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "High Priority",
                                            "representation": "Sev0",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Low Priority",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "unknown",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                },
                                "chartSettings": {
                                  "yAxis": [
                                    "Consumed Cores"
                                  ],
                                  "group": "Prioritize AHUB?",
                                  "createOtherGroup": null
                                }
                              },
                              "customWidth": "33",
                              "name": "Summary SQLDB+SKU AHUB Enabled - per Priority"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Disabled\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Disabled].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].CheckSQLDBAHUB\",\"mergedName\":\"CheckSQLDBAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                                "size": 0,
                                "title": "SQL DB AHUB Cores not enabled per AHUB Priority",
                                "noDataMessage": "All of your SQL DB have AHUB enabled.",
                                "noDataMessageStyle": 3,
                                "showRefreshButton": true,
                                "queryType": 7,
                                "visualization": "piechart",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Prioritize AHUB?",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "High Priority",
                                            "representation": "Sev0",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Low Priority",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "unknown",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                },
                                "chartSettings": {
                                  "yAxis": [
                                    "Consumed Cores"
                                  ],
                                  "group": "Prioritize AHUB?",
                                  "createOtherGroup": null
                                }
                              },
                              "customWidth": "33",
                              "name": "Summary SQLDB+SKU AHUB Disabled - per Priority"
                            }
                          ]
                        },
                        "name": "SQL DB Info"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                              "version": "KqlParameterItem/1.0",
                              "name": "SQLDBHUBEnabled",
                              "label": "See SQL  DBs with AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                              "version": "KqlParameterItem/1.0",
                              "name": "SQLDBAHUBDisabled",
                              "label": "See SQL DBs without AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "parameters - 13"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071ed\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Disabled\"}],\"projectRename\":[{\"originalName\":\"[SQLDB AHUB Disabled].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].CheckSQLDBAHUB\",\"mergedName\":\"CheckSQLDBAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"}]}",
                                "size": 0,
                                "title": "SQL DB AHUB Disabled",
                                "noDataMessage": "All of your SQL DBs have AHUB enabled.",
                                "showExportToExcel": true,
                                "queryType": 7,
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "$gen_group",
                                      "formatter": 15,
                                      "formatOptions": {
                                        "linkTarget": null,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Group",
                                      "formatter": 15,
                                      "formatOptions": {
                                        "linkTarget": null,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "SubscriptionName",
                                      "formatter": 15,
                                      "formatOptions": {
                                        "linkTarget": null,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "hierarchySettings": {
                                    "treeType": 1,
                                    "groupBy": [
                                      "SubscriptionName"
                                    ],
                                    "expandTopLevel": true
                                  }
                                }
                              },
                              "conditionalVisibility": {
                                "parameterName": "SQLDBAHUBDisabled",
                                "comparison": "isEqualTo",
                                "value": "Yes"
                              },
                              "name": "SQL DB Disabled"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071f9\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Enabled\"}],\"projectRename\":[{\"originalName\":\"[SQLDB AHUB Enabled].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"}]}",
                                "size": 0,
                                "title": "SQL DB AHUB Enabled",
                                "noDataMessage": "None of you SQL DBs have AHUB enabled.",
                                "showExportToExcel": true,
                                "queryType": 7
                              },
                              "conditionalVisibility": {
                                "parameterName": "SQLDBHUBEnabled",
                                "comparison": "isEqualTo",
                                "value": "Yes"
                              },
                              "name": "SQL DB AHUB Enabled"
                            }
                          ]
                        },
                        "name": "Load SQL DB Detailed Info"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "SelectedSubTab",
                    "comparison": "isEqualTo",
                    "value": "SQLDB"
                  },
                  "name": "SQLDBGroup"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SQL Managed Instance",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\"\r\n | extend SubscriptionName=name \r\n | join (resources |  where type =~ 'Microsoft.Sql/managedInstances' and tostring(properties.['licenseType']) == 'LicenseIncluded'\r\n | extend ManagedInstance=id, SQLRG=resourceGroup, SQLLocation=location, vCores=tostring(sku.capacity),LicenseType = tostring(properties.['licenseType'])\r\n | extend CheckSQLMIAHUB = case(\r\n type =~ 'Microsoft.Sql/managedInstances', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    ) \r\n ) on subscriptionId \r\n | project ManagedInstance,SQLRG, SQLLocation, CheckSQLMIAHUB, vCores, LicenseType, SubscriptionName\r\n | where SQLRG in ({ResourceGroup})",
                          "size": 0,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "SQLMIAHUBDisabled"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\"\r\n | extend SubscriptionName=name \r\n | join (resources |  where type =~ 'Microsoft.Sql/managedInstances' and tostring(properties.['licenseType']) != 'LicenseIncluded'\r\n | extend ManagedInstance=id, SQLRG=resourceGroup, SQLLocation=location, vCores=tostring(sku.capacity),LicenseType = tostring(properties.['licenseType'])\r\n | extend CheckSQLMIAHUB = case(\r\n type =~ 'Microsoft.Sql/managedInstances', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    ) \r\n ) on subscriptionId \r\n | project ManagedInstance,SQLRG, SQLLocation, CheckSQLMIAHUB, vCores, LicenseType, SubscriptionName\r\n | where SQLRG in ({ResourceGroup})",
                          "size": 0,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "SQLMIAHUBEnabled"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "# SQL Managed Instances Azure Hybrid Benefit (AHUB) Overview\r\n"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "Apply to SQL Server 1 to 4 vCPUs exchange: For every 1 core of SQL Server Enterprise Edition, you get 4 vCPUs of SQL Managed Instance or Azure SQL Database general purpose and Hyperscale tiers, or 4 vCPUs of SQL Server Standard edition on Azure VMs.\r\n\r\nThe SQL virtual machines (VMs) with less than 4 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                          "style": "info"
                        },
                        "name": "text - 3"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### AHUB Overview\r\nSummary of all SQL Databases with and without SQL AHUB.",
                          "style": "info"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "loadType": "explicit",
                          "loadButtonText": "Load SQL MI Info",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\"\r\n | extend SubscriptionName=name \r\n | join (resources |  where type =~ 'Microsoft.Sql/managedInstances' and tostring(properties.['licenseType']) == 'LicenseIncluded'\r\n | extend ManagedInstance=id, SQLRG=resourceGroup, SQLLocation=location, vCores=tostring(sku.capacity),LicenseType = tostring(properties.['licenseType'])\r\n | extend CheckSQLMIAHUB = case(\r\n type =~ 'Microsoft.Sql/managedInstances', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    ) \r\n ) on subscriptionId \r\n| project ManagedInstance,SQLRG, SQLLocation, CheckSQLMIAHUB, vCores, LicenseType, SubscriptionName\r\n| summarize count() by SubscriptionName, CheckSQLMIAHUB",
                                "size": 0,
                                "title": "Summary of SQL MI with or without AHUB per Subscription",
                                "showRefreshButton": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "table",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "CheckSQLMIAHUB",
                                    "formatter": 1
                                  },
                                  "subtitleContent": {
                                    "columnMatch": "SubscriptionName"
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  },
                                  "showBorder": false
                                },
                                "chartSettings": {
                                  "yAxis": [
                                    "count_"
                                  ],
                                  "group": "CheckSQLMIAHUB",
                                  "createOtherGroup": null
                                }
                              },
                              "customWidth": "50",
                              "name": "Summary of SQL MI with or without AHUB per subs"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\" \r\n | extend SubscriptionName=name \r\n | join (resources |  where type =~ 'Microsoft.Sql/managedInstances' and tostring(properties.['licenseType']) == 'LicenseIncluded'\r\n | extend ManagedInstance=id, SQLRG=resourceGroup, SQLLocation=location, vCores=tostring(sku.capacity),LicenseType = tostring(properties.['licenseType'])\r\n | extend CheckSQLMIAHUB = case(\r\n type =~ 'Microsoft.Sql/managedInstances', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    ) \r\n ) on subscriptionId \r\n| project ManagedInstance,SQLRG, SQLLocation, CheckSQLMIAHUB, vCores, LicenseType, SubscriptionName\r\n| summarize count() by SubscriptionName, CheckSQLMIAHUB",
                                "size": 0,
                                "title": "Summary of SQL Managed Instance with or without AHUB",
                                "showRefreshButton": true,
                                "queryType": 1,
                                "resourceType": "microsoft.resourcegraph/resources",
                                "crossComponentResources": [
                                  "{Subscription}"
                                ],
                                "visualization": "piechart",
                                "chartSettings": {
                                  "yAxis": [
                                    "count_"
                                  ],
                                  "group": "CheckSQLMIAHUB",
                                  "createOtherGroup": null
                                }
                              },
                              "customWidth": "50",
                              "name": "Summary of SQL MI with or without AHUB "
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Consumed Licenses\r\nTotal number of SQL licenses cores consumed by all SQL Managed Instances.\r\n",
                                "style": "info"
                              },
                              "customWidth": "50",
                              "name": "text - 7"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "### Number of required Cores to enable SQL Azure Hybrid Benefit\r\nNumber of cores required to enable SQL AHUB across the entire environment.\r\n\r\n\r\n",
                                "style": "info"
                              },
                              "customWidth": "50",
                              "name": "text - 8"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBEnabled\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLMIAHUBEnabled].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                                "size": 0,
                                "title": "SQL Managed Instance AHUB Consumed Cores per VM",
                                "noDataMessage": "None of your SQL MI have AHUB enabled.",
                                "noDataMessageStyle": 4,
                                "showRefreshButton": true,
                                "queryType": 7,
                                "visualization": "piechart",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Prioritize AHUB?",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "High Priority",
                                            "representation": "Sev0",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Low Priority",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "unknown",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                },
                                "chartSettings": {
                                  "yAxis": [
                                    "Consumed Cores"
                                  ],
                                  "group": "SQLName",
                                  "createOtherGroup": null
                                }
                              },
                              "customWidth": "33",
                              "name": "Summary SQLMI+SKU AHUB Enabled - per VM"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBEnabled\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLMIAHUBEnabled].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                                "size": 0,
                                "title": "SQL Managed Instance AHUB Consumed Cores per Priority",
                                "noDataMessage": "None of your SQL MI have AHUB enabled.",
                                "noDataMessageStyle": 4,
                                "showRefreshButton": true,
                                "queryType": 7,
                                "visualization": "piechart",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Prioritize AHUB?",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "High Priority",
                                            "representation": "Sev0",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Low Priority",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "unknown",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                },
                                "chartSettings": {
                                  "yAxis": [
                                    "Consumed Cores"
                                  ],
                                  "group": "Prioritize AHUB?",
                                  "createOtherGroup": null
                                }
                              },
                              "customWidth": "33",
                              "name": "Summary SQLMI+SKU AHUB Enabled - per Priority"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBDisabled\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLMIAHUBDisabled].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                                "size": 0,
                                "title": "SQL Managed Instances AHUB Cores not enabled per AHUB Priority",
                                "noDataMessage": "All of your SQL MI have AHUB enabled.",
                                "noDataMessageStyle": 3,
                                "showRefreshButton": true,
                                "queryType": 7,
                                "visualization": "piechart",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "Prioritize AHUB?",
                                      "formatter": 18,
                                      "formatOptions": {
                                        "thresholdsOptions": "icons",
                                        "thresholdsGrid": [
                                          {
                                            "operator": "==",
                                            "thresholdValue": "High Priority",
                                            "representation": "Sev0",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "==",
                                            "thresholdValue": "Low Priority",
                                            "representation": "2",
                                            "text": "{0}{1}"
                                          },
                                          {
                                            "operator": "Default",
                                            "thresholdValue": null,
                                            "representation": "unknown",
                                            "text": "{0}{1}"
                                          }
                                        ]
                                      }
                                    }
                                  ]
                                },
                                "chartSettings": {
                                  "yAxis": [
                                    "Consumed Cores"
                                  ],
                                  "group": "Prioritize AHUB?",
                                  "createOtherGroup": null
                                }
                              },
                              "customWidth": "33",
                              "name": "Summary SQLMI+SKU AHUB Disabled - per Priority"
                            }
                          ]
                        },
                        "name": "SQL MI Info"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                              "version": "KqlParameterItem/1.0",
                              "name": "SQLMIAHUBEnabled",
                              "label": "See SQL  MIs with AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                              "version": "KqlParameterItem/1.0",
                              "name": "SQLMIAHUBDisabled",
                              "label": "See SQL MIs without AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "parameters - 136"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071ed\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBDisabled\"}],\"projectRename\":[{\"originalName\":\"[SQLMIAHUBDisabled].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"}]}",
                                "size": 0,
                                "title": "SQL Managed Instance AHUB Disabled",
                                "noDataMessage": "All of your SQL MIs have AHUB enabled.",
                                "showExportToExcel": true,
                                "queryType": 7,
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "$gen_group",
                                      "formatter": 15,
                                      "formatOptions": {
                                        "linkTarget": null,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "Group",
                                      "formatter": 15,
                                      "formatOptions": {
                                        "linkTarget": null,
                                        "showIcon": true
                                      }
                                    },
                                    {
                                      "columnMatch": "SubscriptionName",
                                      "formatter": 15,
                                      "formatOptions": {
                                        "linkTarget": null,
                                        "showIcon": true
                                      }
                                    }
                                  ],
                                  "hierarchySettings": {
                                    "treeType": 1,
                                    "groupBy": [
                                      "SubscriptionName"
                                    ],
                                    "expandTopLevel": true
                                  }
                                }
                              },
                              "conditionalVisibility": {
                                "parameterName": "SQLMIAHUBDisabled",
                                "comparison": "isEqualTo",
                                "value": "Yes"
                              },
                              "name": "SQL MI Disabled"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071f9\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBEnabled\"}],\"projectRename\":[{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLMIAHUBEnabled].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"}]}",
                                "size": 0,
                                "title": "SQL Managed Instance AHUB Enabled",
                                "noDataMessage": "None of you SQL MIs have AHUB enabled.",
                                "showExportToExcel": true,
                                "queryType": 7
                              },
                              "conditionalVisibility": {
                                "parameterName": "SQLMIAHUBEnabled",
                                "comparison": "isEqualTo",
                                "value": "Yes"
                              },
                              "name": "SQL MI AHUB Enabled"
                            }
                          ]
                        },
                        "name": "SQL MI Detailed"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "SelectedSubTab",
                    "comparison": "isEqualTo",
                    "value": "SQLMI"
                  },
                  "name": "SQL MI"
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "SelectedTab",
                "comparison": "isEqualTo",
                "value": "SQL"
              },
              {
                "parameterName": "RG_Filter",
                "comparison": "isEqualTo",
                "value": "Resource Group"
              }
            ],
            "name": "SQLAHUB"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "SQL Overview",
              "items": [
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "0211f413-9f36-4750-9ef2-d382ba30ba6c",
                        "cellValue": "SelectedSubTab",
                        "linkTarget": "parameter",
                        "linkLabel": "SQL Server VMs",
                        "subTarget": "SQLVM",
                        "preText": "VM",
                        "style": "link"
                      },
                      {
                        "id": "79e7a97a-1413-41e8-b4c6-ebd1d0a45e2e",
                        "cellValue": "SelectedSubTab",
                        "linkTarget": "parameter",
                        "linkLabel": "SQL DB",
                        "subTarget": "SQLDB",
                        "style": "link"
                      },
                      {
                        "id": "1f381e5b-7071-41ce-a354-c2df93445cae",
                        "cellValue": "SelectedSubTab",
                        "linkTarget": "parameter",
                        "linkLabel": "SQL Managed Instances",
                        "subTarget": "SQLMI",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 4"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\n     resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'| where type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines' and tostring(properties.['sqlServerLicenseType']) != 'AHUB'\r\n    | extend SQLID=id, VMName = name, VMRG = resourceGroup, VMLocation = location, LicenseType = tostring(properties.['sqlServerLicenseType']), OSType=tostring(properties.storageProfile.imageReference.offer), SQLAgentType = tostring(properties.['sqlManagement']), SQLVersion = tostring(properties.['sqlImageOffer']), SQLSKU=tostring(properties.['sqlImageSku'])\r\n    ) on subscriptionId \r\n| join (\r\n    resources\r\n    | where type =~ 'Microsoft.Compute/virtualmachines'\r\n    | project VMName = tolower(name), VMSize = tostring(properties.hardwareProfile.vmSize)\r\n    ) on VMName\r\n| order by id asc    \r\n| project SQLID,VMName,VMRG, VMLocation, VMSize, SQLVersion, SQLSKU, SQLAgentType, LicenseType, SubscriptionName\r\n| where SQLSKU != \"Developer\" and SQLSKU != \"Express\"",
                          "size": 0,
                          "title": "SQL VM AHUB Disabled",
                          "noDataMessage": "All of your VMs have AHUB enabled.",
                          "noDataMessageStyle": 3,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "Get-SQL-AHUB-Disabled-Tags"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\n     resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' | where type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines' and tostring(properties.['sqlServerLicenseType']) == 'AHUB'\r\n    | extend SQLID=id, VMName = name, VMRG = resourceGroup, VMLocation = location, LicenseType = tostring(properties.['sqlServerLicenseType']), OSType=tostring(properties.storageProfile.imageReference.offer), SQLAgentType = tostring(properties.['sqlManagement']), SQLVersion = tostring(properties.['sqlImageOffer']), SQLSKU=tostring(properties.['sqlImageSku'])\r\n    ) on subscriptionId \r\n| join (\r\n    resources\r\n    | where type =~ 'Microsoft.Compute/virtualmachines'\r\n    | project VMName = tolower(name), VMSize = tostring(properties.hardwareProfile.vmSize)\r\n    ) on VMName\r\n| order by id asc    \r\n| project SQLID,VMName,VMRG, VMLocation, VMSize, SQLVersion, SQLSKU, SQLAgentType, LicenseType, SubscriptionName\r\n| where SQLSKU != \"Developer\" and SQLSKU != \"Express\"",
                          "size": 0,
                          "title": "SQL VM AHUB Enabled",
                          "noDataMessage": "None of your VMs have AHUB enabled.",
                          "noDataMessageStyle": 5,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "Get-SQL-AHUB-Enabled-Tags"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## SQL Virtual Machines Azure Hybrid Benefit (AHUB) Overview"
                        },
                        "name": "SQL Text"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "Apply to SQL Server 1 to 4 vCPUs exchange: For every 1 core of SQL Server Enterprise Edition, you get 4 vCPUs of SQL Managed Instance or Azure SQL Database general purpose and Hyperscale tiers, or 4 vCPUs of SQL Server Standard edition on Azure VMs.\r\n\r\nThe SQL virtual machines (VMs) with less than 4 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                          "style": "info"
                        },
                        "name": "SQL License Info",
                        "styleSettings": {
                          "margin": "10px",
                          "showBorder": true
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### AHUB Overview\r\nSummary of all SQL on VMs with and without SQL AHUB.",
                          "style": "info"
                        },
                        "name": "text - 15"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\n    resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' | where type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines'\r\n    | extend SQLID=id, VMName = name, VMRG = resourceGroup, VMLocation = location, LicenseType = tostring(properties.['sqlServerLicenseType']), OSType=tostring(properties.storageProfile.imageReference.offer), SQLAgentType = tostring(properties.['sqlManagement']), SQLVersion = tostring(properties.['sqlImageOffer']), SQLSKU=tostring(properties.['sqlImageSku'])\r\n    | extend CheckSQLVMAHUB = case(\r\n     type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines', iif((properties.['sqlServerLicenseType'])\r\n     !has 'AHUB', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not SQL\"\r\n     )\r\n    ) on subscriptionId \r\n| summarize count() by SubscriptionName, CheckSQLVMAHUB",
                          "size": 0,
                          "title": "Summary of SQL on VMs with or without AHUB per Subscription",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low Priority",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "unknown",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "CheckSQLVMAHUB",
                              "formatter": 1
                            },
                            "subtitleContent": {
                              "columnMatch": "SubscriptionName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "chartSettings": {
                            "xAxis": "SubscriptionName"
                          }
                        },
                        "customWidth": "50",
                        "name": "Summary of SQL on VMs with or without AHUB"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\n  resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'| where type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines'\r\n    | extend SQLID=id, VMName = name, VMRG = resourceGroup, VMLocation = location, LicenseType = tostring(properties.['sqlServerLicenseType']), OSType=tostring(properties.storageProfile.imageReference.offer), SQLAgentType = tostring(properties.['sqlManagement']), SQLVersion = tostring(properties.['sqlImageOffer']), SQLSKU=tostring(properties.['sqlImageSku'])\r\n    | extend CheckSQLVMAHUB = case(\r\n     type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines', iif((properties.['sqlServerLicenseType'])\r\n     !has 'AHUB', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not SQL\"\r\n     )\r\n    ) on subscriptionId \r\n| summarize count() by CheckSQLVMAHUB",
                          "size": 0,
                          "title": "Summary SQL Enabled and Disabled",
                          "noDataMessage": "You don't have any SQL VM",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart"
                        },
                        "customWidth": "50",
                        "name": "Summary SQL Enabled and Disabled"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Consumed Licenses\r\nTotal number of SQL licenses cores consumed by all SQL running on Virtual Machines.\r\n",
                          "style": "info"
                        },
                        "customWidth": "50",
                        "name": "text - 15"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Number of required Cores to enable SQL Azure Hybrid Benefit\r\nNumber of cores required to enable SQL AHUB across the entire environment.\r\n\r\n\r\n",
                          "style": "info"
                        },
                        "customWidth": "50",
                        "name": "text - 15 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640e8\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Enabled-Tags\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLID\",\"mergedName\":\"SQLID\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"}]}",
                          "size": 0,
                          "title": "SQL VM AHUB Consumed Cores per VM",
                          "noDataMessage": "None of your VMs have AHUB enabled.",
                          "noDataMessageStyle": 4,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low Priority",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "unknown",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ]
                          },
                          "chartSettings": {
                            "yAxis": [
                              "Consumed Cores"
                            ],
                            "group": "VMName",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "name": "Summary SQL+SKU AHUB Enabled - per VM"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640e8\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Enabled-Tags\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLID\",\"mergedName\":\"SQLID\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMName\"}]}",
                          "size": 0,
                          "title": "SQL VM AHUB Consumed Cores per Priority",
                          "noDataMessage": "None of your VMs have AHUB enabled.",
                          "noDataMessageStyle": 4,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low Priority",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "unknown",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ]
                          },
                          "chartSettings": {
                            "group": "Prioritize AHUB?",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "showPin": false,
                        "name": "Summary SQL+SKU AHUB Enabled -"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640b5\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Disabled-Tags\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SQLID\",\"mergedName\":\"SQLID\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"}]}",
                          "size": 0,
                          "title": "Cores not enabled per AHUB Priority",
                          "noDataMessage": "All of your VMs have AHUB enabled.",
                          "noDataMessageStyle": 3,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low Priority",
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ]
                          },
                          "sortBy": [],
                          "chartSettings": {
                            "yAxis": [
                              "Consumed Cores"
                            ],
                            "showMetrics": false,
                            "showLegend": true
                          }
                        },
                        "customWidth": "33",
                        "showPin": false,
                        "name": " Summary - SQL Cores AHUB Disabled "
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                              "version": "KqlParameterItem/1.0",
                              "name": "SQLAVMHUBEnabled",
                              "label": "See SQL  VMs with AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "value": "Yes"
                            },
                            {
                              "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                              "version": "KqlParameterItem/1.0",
                              "name": "SQLVMAHUBDisabled",
                              "label": "See SQL VMs without AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                              "value": "Yes"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640b5\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Disabled-Tags\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SQLID\",\"mergedName\":\"SQL Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLID\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMName\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMRG\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMLocation\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLVersion\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLSKU\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLAgentType\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].LicenseType\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SubscriptionName\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMSize\"}]}",
                          "size": 0,
                          "title": "SQL VM AHUB Disabled",
                          "noDataMessage": "All of your VMs have AHUB enabled.",
                          "noDataMessageStyle": 3,
                          "showExportToExcel": true,
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low Priority",
                                      "representation": "warning",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ],
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "SubscriptionName"
                              ],
                              "expandTopLevel": true
                            }
                          },
                          "sortBy": []
                        },
                        "conditionalVisibility": {
                          "parameterName": "SQLVMAHUBDisabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "showPin": false,
                        "name": "SQL+SKU AHUB Disabled"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640e8\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Enabled-Tags\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLID\",\"mergedName\":\"SQL Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMName\"}]}",
                          "size": 0,
                          "title": "SQL VM AHUB Enabled",
                          "noDataMessage": "None of your VMs have AHUB enabled.",
                          "noDataMessageStyle": 4,
                          "showExportToExcel": true,
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low Priority",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "unknown",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Subscription",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              }
                            ],
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "SubscriptionName"
                              ],
                              "expandTopLevel": true
                            }
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "SQLAVMHUBEnabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "showPin": false,
                        "name": "SQL+SKU AHUB Enabled"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "SelectedSubTab",
                    "comparison": "isEqualTo",
                    "value": "SQLVM"
                  },
                  "name": "SQL VM"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SQL Database",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers\r\n| where type =~ 'Microsoft.Resources/subscriptions' \r\n| extend SubscriptionName=name | join (resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'|  where type =~ 'Microsoft.Sql/servers/databases' and name != 'master' and tostring(properties.['licenseType']) == 'LicenseIncluded' \r\n| extend   SQLDBID=id,SQLName = name, SQLRG = resourceGroup, SKUName=tostring(sku.name), SKUTier=tostring(sku.tier), vCores=tostring(sku.capacity), SQLLocation = location, LicenseType = tostring(properties.['licenseType']), StorageAccountType=tostring(properties.['storageAccountType'])\r\n| extend CheckSQLDBAHUB = case(\r\n type =~ 'Microsoft.Sql/servers/databases', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    )\r\n) on subscriptionId \r\n| project SQLDBID,SQLName,SQLRG, SKUName, SKUTier, vCores, CheckSQLDBAHUB,SQLLocation, LicenseType, StorageAccountType, SubscriptionName\r\n",
                          "size": 0,
                          "title": "AHUB Disabled",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "SQLDB AHUB Disabled-Tag"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers\r\n| where type =~ 'Microsoft.Resources/subscriptions' \r\n| extend SubscriptionName=name | join (resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' |  where type =~ 'Microsoft.Sql/servers/databases' and name != 'master' and tostring(properties.['licenseType']) != 'LicenseIncluded' \r\n| extend   SQLDBID=id,SQLName = name, SQLRG = resourceGroup, SKUName=sku.name, SKUTier=sku.tier, SQLLocation = location, vCores=tostring(sku.capacity), LicenseType = tostring(properties.['licenseType']), StorageAccountType=tostring(properties.['storageAccountType'])) on subscriptionId \r\n| project SQLDBID,SQLName,SQLRG, SKUName, SKUTier, vCores, SQLLocation, LicenseType, StorageAccountType, SubscriptionName\r\n",
                          "size": 0,
                          "title": "AHUB Enabled",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "SQLDB AHUB Enabled-Tag"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## SQL Databases Azure Hybrid Benefit (AHUB) Overview"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "Apply to SQL Server 1 to 4 vCPUs exchange: For every 1 core of SQL Server Enterprise Edition, you get 4 vCPUs of SQL Managed Instance or Azure SQL Database general purpose and Hyperscale tiers, or 4 vCPUs of SQL Server Standard edition on Azure VMs.\r\n\r\nThe SQL virtual machines (VMs) with less than 4 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                          "style": "info"
                        },
                        "name": "text - 3"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### AHUB Overview\r\nSummary of all SQL Databases with and without SQL AHUB.",
                          "style": "info"
                        },
                        "name": "text - 15"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\n    resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' | where type =~ 'Microsoft.Sql/servers/databases' and name != 'master'\r\n     | extend   SQLDBID=id,SQLName = name, SQLRG = resourceGroup, SKUName=sku.name, SKUTier=sku.tier, SQLLocation = location, LicenseType = tostring(properties.['licenseType']), StorageAccountType=tostring(properties.['storageAccountType'])\r\n     | extend CheckSQLDBAHUB = case(\r\n     type =~ 'Microsoft.Sql/servers/databases', iif((properties.['licenseType'])\r\n     has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not SQL DB\"\r\n     )\r\n    ) on subscriptionId \r\n| summarize count() by SubscriptionName, CheckSQLDBAHUB",
                          "size": 0,
                          "title": "Summary of SQL Databases with or without AHUB per Subscription",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low Priority",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "unknown",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "CheckSQLDBAHUB",
                              "formatter": 1
                            },
                            "subtitleContent": {
                              "columnMatch": "SubscriptionName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "chartSettings": {
                            "xAxis": "SubscriptionName"
                          }
                        },
                        "customWidth": "50",
                        "name": "Summary of SQL DBs with or without AHUB per subs"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\n    resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' | where type =~ 'Microsoft.Sql/servers/databases' and name != 'master'\r\n     | extend   SQLDBID=id,SQLName = name, SQLRG = resourceGroup, SKUName=sku.name, SKUTier=sku.tier, SQLLocation = location, LicenseType = tostring(properties.['licenseType']), StorageAccountType=tostring(properties.['storageAccountType'])\r\n     | extend CheckSQLDBAHUB = case(\r\n     type =~ 'Microsoft.Sql/servers/databases', iif((properties.['licenseType'])\r\n     has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not SQL DB\"\r\n     )\r\n    ) on subscriptionId \r\n| summarize count() by CheckSQLDBAHUB",
                          "size": 0,
                          "title": "Summary of SQL Databases with or without AHUB",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low Priority",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "unknown",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "CheckSQLDBAHUB",
                              "formatter": 1
                            },
                            "subtitleContent": {
                              "columnMatch": "SubscriptionName",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              }
                            },
                            "showBorder": false,
                            "size": "auto"
                          },
                          "chartSettings": {
                            "xAxis": "SubscriptionName"
                          }
                        },
                        "customWidth": "50",
                        "name": "Summary of SQL DBs with or without AHUB "
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Consumed Licenses\r\nTotal number of SQL licenses cores consumed by all SQL Databases\r\n",
                          "style": "info"
                        },
                        "customWidth": "50",
                        "name": "text - 15"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Number of required Cores to enable SQL Azure Hybrid Benefit\r\nNumber of cores required to enable SQL AHUB across the entire environment.\r\n\r\n\r\n",
                          "style": "info"
                        },
                        "customWidth": "50",
                        "name": "Text SQL DB"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Enabled-Tag\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCores\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                          "size": 0,
                          "title": "SQL DB AHUB Consumed Cores per VM",
                          "noDataMessage": "None of your SQL DB have AHUB enabled.",
                          "noDataMessageStyle": 4,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low Priority",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "unknown",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ]
                          },
                          "chartSettings": {
                            "yAxis": [
                              "Consumed Cores"
                            ],
                            "group": "SQLName",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "name": "Summary SQLDB+SKU AHUB Enabled - per VM"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Enabled-Tag\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCores\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                          "size": 0,
                          "title": "SQL DB AHUB Consumed Cores per Priority",
                          "noDataMessage": "None of your SQL DB have AHUB enabled.",
                          "noDataMessageStyle": 4,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low Priority",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "unknown",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ]
                          },
                          "chartSettings": {
                            "yAxis": [
                              "Consumed Cores"
                            ],
                            "group": "Prioritize AHUB?",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "name": "Summary SQLDB+SKU AHUB Enabled - per Priority"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Disabled-Tag\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCores\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].CheckSQLDBAHUB\",\"mergedName\":\"CheckSQLDBAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                          "size": 0,
                          "title": "SQL DB AHUB Cores not enabled per AHUB Priority",
                          "noDataMessage": "All of your SQL DB have AHUB enabled.",
                          "noDataMessageStyle": 3,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low Priority",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "unknown",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ]
                          },
                          "chartSettings": {
                            "yAxis": [
                              "Consumed Cores"
                            ],
                            "group": "Prioritize AHUB?",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "name": "Summary SQLDB+SKU AHUB Disabled - per Priority"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                              "version": "KqlParameterItem/1.0",
                              "name": "SQLDBHUBEnabled",
                              "label": "See SQL  DBs with AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                              "version": "KqlParameterItem/1.0",
                              "name": "SQLDBAHUBDisabled",
                              "label": "See SQL DBs without AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071ed\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Disabled-Tag\"}],\"projectRename\":[{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].CheckSQLDBAHUB\",\"mergedName\":\"CheckSQLDBAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"}]}",
                          "size": 0,
                          "title": "SQL DB AHUB Disabled",
                          "noDataMessage": "All of your SQL DBs have AHUB enabled.",
                          "showExportToExcel": true,
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "SubscriptionName",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              }
                            ],
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "SubscriptionName"
                              ],
                              "expandTopLevel": true
                            }
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "SQLDBAHUBDisabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "SQL DB Disabled"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071f9\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Enabled-Tag\"}],\"projectRename\":[{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"}]}",
                          "size": 0,
                          "title": "SQL DB AHUB Enabled",
                          "noDataMessage": "None of you SQL DBs have AHUB enabled.",
                          "showExportToExcel": true,
                          "queryType": 7
                        },
                        "conditionalVisibility": {
                          "parameterName": "SQLDBHUBEnabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "SQL DB AHUB Enabled"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "SelectedSubTab",
                    "comparison": "isEqualTo",
                    "value": "SQLDB"
                  },
                  "name": "SQLDBGroup"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "SQL Managed Instance",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers\r\n | where type =~ 'Microsoft.Resources/subscriptions' \r\n | extend SubscriptionName=name \r\n | join (resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' |  where type =~ 'Microsoft.Sql/managedInstances' and tostring(properties.['licenseType']) == 'LicenseIncluded'\r\n | extend ManagedInstance=id, SQLRG=resourceGroup, SQLLocation=location, vCores=tostring(sku.capacity),LicenseType = tostring(properties.['licenseType'])\r\n | extend CheckSQLMIAHUB = case(\r\n type =~ 'Microsoft.Sql/managedInstances', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    ) \r\n ) on subscriptionId \r\n | project ManagedInstance,SQLRG, SQLLocation, CheckSQLMIAHUB, vCores, LicenseType, SubscriptionName",
                          "size": 0,
                          "title": "SQLMIAHUBDisabled",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "SQLMIAHUBDisabled-Tags"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers\r\n | where type =~ 'Microsoft.Resources/subscriptions' \r\n | extend SubscriptionName=name \r\n | join (resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' |  where type =~ 'Microsoft.Sql/managedInstances' and tostring(properties.['licenseType']) != 'LicenseIncluded'\r\n | extend ManagedInstance=id, SQLRG=resourceGroup, SQLLocation=location, vCores=tostring(sku.capacity),LicenseType = tostring(properties.['licenseType'])\r\n | extend CheckSQLMIAHUB = case(\r\n type =~ 'Microsoft.Sql/managedInstances', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    ) \r\n ) on subscriptionId \r\n | project ManagedInstance,SQLRG, SQLLocation, CheckSQLMIAHUB, vCores, LicenseType, SubscriptionName\r\n",
                          "size": 0,
                          "title": "SQLMIAHUBEnabled",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ]
                        },
                        "conditionalVisibility": {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "true"
                        },
                        "name": "SQLMIAHUBEnabled-Tags"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "# SQL Managed Instances Azure Hybrid Benefit (AHUB) Overview\r\n"
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "Apply to SQL Server 1 to 4 vCPUs exchange: For every 1 core of SQL Server Enterprise Edition, you get 4 vCPUs of SQL Managed Instance or Azure SQL Database general purpose and Hyperscale tiers, or 4 vCPUs of SQL Server Standard edition on Azure VMs.\r\n\r\nThe SQL virtual machines (VMs) with less than 4 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                          "style": "info"
                        },
                        "name": "text - 3"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### AHUB Overview\r\nSummary of all SQL Databases with and without SQL AHUB.",
                          "style": "info"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers\r\n | where type =~ 'Microsoft.Resources/subscriptions' \r\n | extend SubscriptionName=name \r\n | join (resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' |  where type =~ 'Microsoft.Sql/managedInstances' and tostring(properties.['licenseType']) == 'LicenseIncluded'\r\n | extend ManagedInstance=id, SQLRG=resourceGroup, SQLLocation=location, vCores=tostring(sku.capacity),LicenseType = tostring(properties.['licenseType'])\r\n | extend CheckSQLMIAHUB = case(\r\n type =~ 'Microsoft.Sql/managedInstances', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    ) \r\n ) on subscriptionId \r\n| project ManagedInstance,SQLRG, SQLLocation, CheckSQLMIAHUB, vCores, LicenseType, SubscriptionName\r\n| summarize count() by SubscriptionName, CheckSQLMIAHUB",
                          "size": 0,
                          "title": "Summary of SQL MI with or without AHUB per Subscription",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "CheckSQLMIAHUB",
                              "formatter": 1
                            },
                            "subtitleContent": {
                              "columnMatch": "SubscriptionName"
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          },
                          "chartSettings": {
                            "yAxis": [
                              "count_"
                            ],
                            "group": "CheckSQLMIAHUB",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "50",
                        "name": "Summary of SQL MI with or without AHUB per subs"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "ResourceContainers\r\n | where type =~ 'Microsoft.Resources/subscriptions' \r\n | extend SubscriptionName=name \r\n | join (resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' |  where type =~ 'Microsoft.Sql/managedInstances' and tostring(properties.['licenseType']) == 'LicenseIncluded'\r\n | extend ManagedInstance=id, SQLRG=resourceGroup, SQLLocation=location, vCores=tostring(sku.capacity),LicenseType = tostring(properties.['licenseType'])\r\n | extend CheckSQLMIAHUB = case(\r\n type =~ 'Microsoft.Sql/managedInstances', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    ) \r\n ) on subscriptionId \r\n| project ManagedInstance,SQLRG, SQLLocation, CheckSQLMIAHUB, vCores, LicenseType, SubscriptionName\r\n| summarize count() by SubscriptionName, CheckSQLMIAHUB",
                          "size": 0,
                          "title": "Summary of SQL Managed Instance with or without AHUB",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Subscription}"
                          ],
                          "visualization": "piechart",
                          "chartSettings": {
                            "yAxis": [
                              "count_"
                            ],
                            "group": "CheckSQLMIAHUB",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "50",
                        "name": "Summary of SQL MI with or without AHUB "
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Consumed Licenses\r\nTotal number of SQL licenses cores consumed by all SQL Managed Instances.\r\n",
                          "style": "info"
                        },
                        "customWidth": "50",
                        "name": "text - 7"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Number of required Cores to enable SQL Azure Hybrid Benefit\r\nNumber of cores required to enable SQL AHUB across the entire environment.\r\n\r\n\r\n",
                          "style": "info"
                        },
                        "customWidth": "50",
                        "name": "text - 8"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBEnabled-Tags\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCores\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                          "size": 0,
                          "title": "SQL Managed Instance AHUB Consumed Cores per VM",
                          "noDataMessage": "None of your SQL MI have AHUB enabled.",
                          "noDataMessageStyle": 4,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low Priority",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "unknown",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ]
                          },
                          "chartSettings": {
                            "yAxis": [
                              "Consumed Cores"
                            ],
                            "group": "SQLName",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "name": "Summary SQLMI+SKU AHUB Enabled - per VM"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBEnabled-Tags\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCores\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                          "size": 0,
                          "title": "SQL Managed Instance AHUB Consumed Cores per Priority",
                          "noDataMessage": "None of your SQL MI have AHUB enabled.",
                          "noDataMessageStyle": 4,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low Priority",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "unknown",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ]
                          },
                          "chartSettings": {
                            "yAxis": [
                              "Consumed Cores"
                            ],
                            "group": "Prioritize AHUB?",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "name": "Summary SQLMI+SKU AHUB Enabled - per Priority"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBDisabled-Tags\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCores\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                          "size": 0,
                          "title": "SQL Managed Instances AHUB Cores not enabled per AHUB Priority",
                          "noDataMessage": "All of your SQL MI have AHUB enabled.",
                          "noDataMessageStyle": 3,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "==",
                                      "thresholdValue": "Low Priority",
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "unknown",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              }
                            ]
                          },
                          "chartSettings": {
                            "yAxis": [
                              "Consumed Cores"
                            ],
                            "group": "Prioritize AHUB?",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "name": "Summary SQLMI+SKU AHUB Disabled - per Priority"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                              "version": "KqlParameterItem/1.0",
                              "name": "SQLMIAHUBEnabled",
                              "label": "See SQL  MIs with AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "value": "Yes"
                            },
                            {
                              "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                              "version": "KqlParameterItem/1.0",
                              "name": "SQLMIAHUBDisabled",
                              "label": "See SQL MIs without AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                              "value": "Yes"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "parameters - 136"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071ed\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBDisabled-Tags\"}],\"projectRename\":[{\"originalName\":\"[SQLMIAHUBDisabled-Tags].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"}]}",
                          "size": 0,
                          "title": "SQL Managed Instance AHUB Disabled",
                          "noDataMessage": "All of your SQL MIs have AHUB enabled.",
                          "showExportToExcel": true,
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "SubscriptionName",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              }
                            ],
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "SubscriptionName"
                              ],
                              "expandTopLevel": true
                            }
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "SQLMIAHUBDisabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "SQL MI Disabled"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071f9\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBEnabled-Tags\"}],\"projectRename\":[{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"}]}",
                          "size": 0,
                          "title": "SQL Managed Instance AHUB Enabled",
                          "noDataMessage": "None of you SQL MIs have AHUB enabled.",
                          "showExportToExcel": true,
                          "queryType": 7
                        },
                        "conditionalVisibility": {
                          "parameterName": "SQLMIAHUBEnabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "SQL MI AHUB Enabled"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "SelectedSubTab",
                    "comparison": "isEqualTo",
                    "value": "SQLMI"
                  },
                  "name": "SQL MI"
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "SelectedTab",
                "comparison": "isEqualTo",
                "value": "SQL"
              },
              {
                "parameterName": "RG_Filter",
                "comparison": "isEqualTo",
                "value": "Tags"
              }
            ],
            "name": "SQLAHUB - Tag"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Linux Hybrid Benefit",
              "loadType": "explicit",
              "loadButtonText": "Load Linux Recommendations",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "## Linux Azure Hybrid Benefit (AHUB) Overview"
                  },
                  "name": "Linux Text"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{SingleSubHidden}/providers/Microsoft.Compute/skus?$filter=location eq '{Location}'\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2021-07-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*[?(@.resourceType=='virtualMachines')]\",\"columns\":[{\"path\":\"name\",\"columnid\":\"Name\"},{\"path\":\"capabilities[?(@.name=='vCPUs')].value\",\"columnid\":\"vCPUs\"},{\"path\":\"capabilities[?(@.name=='MemoryGB')].value\",\"columnid\":\"MemoryGB\"},{\"path\":\"capabilities[?(@.name=='MaxNetworkInterfaces')].value\",\"columnid\":\"MaxNetworkInterfaces\"},{\"path\":\"capabilities[?(@.name=='HyperVGenerations')].value\",\"columnid\":\"HyperVGenerations\"},{\"path\":\"capabilities[?(@.name=='vCPUsPerCore')].value\",\"columnid\":\"vCPUsPerCore\"}]}}]}",
                    "size": 0,
                    "title": "Get VM vCPU",
                    "exportParameterName": "ResourceSKU",
                    "showExportToExcel": true,
                    "queryType": 12,
                    "gridSettings": {
                      "rowLimit": 5000
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "AlwaysHidden",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "API-Get_VMLinux_SKU"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualmachines' and (properties.storageProfile.imageReference.publisher == 'suse' or properties.storageProfile.imageReference.publisher=='RedHat')\r\n| where isnull ((properties.['licenseType']))\r\n| extend LinuxId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.publisher), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']), VMSSize=tostring(sku.name)\r\n| order by type asc \r\n| project LinuxId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType",
                    "size": 0,
                    "title": "AHUB Disabled",
                    "noDataMessage": "None of your Linux VMs have AHUB enabled.",
                    "noDataMessageStyle": 4,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "AlwaysHidden",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "LinuxAHUBDisabled"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualmachines' and (properties.storageProfile.imageReference.publisher == 'suse' or properties.storageProfile.imageReference.publisher=='RedHat')\r\n| where isnotnull ((properties.['licenseType']))\r\n| extend LinuxId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.publisher), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']), VMSSize=tostring(sku.name)\r\n| order by type asc \r\n| project LinuxId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType",
                    "size": 0,
                    "title": "AHUB Enabled",
                    "noDataMessage": "All of your Linux VMs have AHUB enabled.",
                    "noDataMessageStyle": 3,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "AlwaysHidden",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "LinuxAHUBRGEnabled"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualmachines' and (properties.storageProfile.imageReference.publisher == 'suse' or properties.storageProfile.imageReference.publisher=='RedHat')\r\n| extend LicenseType = tostring(properties.['licenseType'])\r\n| extend CheckAHUBLinux = case(\r\n     type == 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets',\r\n     iff(isnull((properties.['licenseType'])),\r\n      \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not Linux\"\r\n     )\r\n| summarize count() by CheckAHUBLinux",
                    "size": 0,
                    "title": "Summary of Linux VMs with or without AHUB",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "visualization": "piechart"
                  },
                  "customWidth": "50",
                  "name": "Summary of Linux VMs with or without AHUB"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resourcechanges\r\n| where properties.changeType == \"Update\" and properties.targetResourceType == \"microsoft.compute/virtualmachines\"\r\n| mv-expand changes = properties.changes\r\n| mv-expand LicenseChanges=changes.['properties.licenseType']\r\n| where isnotnull(LicenseChanges)\r\n| where  tostring(LicenseChanges.newValue) has \"SLES_BYOS\" or tostring(LicenseChanges.newValue) has \"RHEL_BYOS\"\r\n| project VMID=properties.targetResourceId, NewLicense=tostring(LicenseChanges.newValue), DateofChange=tostring(properties.changeAttributes.timestamp)\r\n",
                    "size": 0,
                    "title": "Linux VM Latest Change Last 7 days",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "AlwaysHidden",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "Linux VM Latest Change Last 7 days"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                        "version": "KqlParameterItem/1.0",
                        "name": "LinuxAHUBEnabled",
                        "label": "See Linux VMs with AHUB",
                        "type": 2,
                        "isRequired": true,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      },
                      {
                        "id": "439c7c8d-4119-4328-b4ca-2b1e676ede28",
                        "version": "KqlParameterItem/1.0",
                        "name": "LinuxEnabledPast7D",
                        "label": "See Linux VMs enabled last 7 days",
                        "type": 2,
                        "isRequired": true,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      },
                      {
                        "id": "4c3ff9fa-d9c8-4d35-94d4-48ba3a1547fd",
                        "version": "KqlParameterItem/1.0",
                        "name": "LinuxAHUBDisabled",
                        "label": "See Linux VMs without AHUB",
                        "type": 2,
                        "isRequired": true,
                        "typeSettings": {
                          "additionalResourceOptions": []
                        },
                        "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "parameters - 13"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "List of Linux VMs with Hybrid Benefit groupped by Subscription."
                  },
                  "conditionalVisibility": {
                    "parameterName": "LinuxAHUBEnabled",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "text - 8"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\",\"mergeType\":\"inner\",\"leftTable\":\"LinuxAHUBRGEnabled\",\"rightTable\":\"API-Get_VMLinux_SKU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[LinuxAHUBRGEnabled].LinuxId\",\"mergedName\":\"VM ID\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBRGEnabled].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBRGEnabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBRGEnabled].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBRGEnabled].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBRGEnabled].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBRGEnabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled].VMName\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[LinuxAHUBEnabled].VMSSize\"},{\"originalName\":\"[LinuxAHUBRGEnabled].VMName\"},{\"originalName\":\"[LinuxAHUBRGEnabled].VMSSize\"}]}",
                    "size": 0,
                    "title": "Linux VMs with AHUB",
                    "noDataMessage": "None of your Linux VMs have AHUB enabled",
                    "noDataMessageStyle": 4,
                    "showExportToExcel": true,
                    "queryType": 7,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Prioritize AHUB?",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High Priority",
                                "representation": "Sev0",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Sev4",
                                "text": "{0}{1}"
                              }
                            ]
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        }
                      ]
                    },
                    "tileSettings": {
                      "showBorder": false,
                      "titleContent": {
                        "columnMatch": "NewLicense",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "vCPUs",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    },
                    "chartSettings": {
                      "xAxis": "VM Name",
                      "yAxis": [
                        "Consumed Cores per VM"
                      ],
                      "group": null,
                      "createOtherGroup": 0,
                      "seriesLabelSettings": [
                        {
                          "seriesName": "Consumed Cores per VM",
                          "color": "grayBlue"
                        }
                      ]
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "LinuxAHUBEnabled",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "Linux-VM+SKU+vCores-AHUB"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "List of Linux VMs without Hybrid Benefit groupped by Subscription."
                  },
                  "conditionalVisibility": {
                    "parameterName": "LinuxAHUBDisabled",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "text - 8 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\",\"mergeType\":\"inner\",\"leftTable\":\"LinuxAHUBDisabled\",\"rightTable\":\"API-Get_VMLinux_SKU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[LinuxAHUBDisabled].LinuxId\",\"mergedName\":\"LinuxId\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled].VMName\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[LinuxAHUBEnabled].VMSSize\"}]}",
                    "size": 0,
                    "title": "Linux VMs without AHUB",
                    "noDataMessage": "None of your Linux VMs have AHUB enabled",
                    "noDataMessageStyle": 4,
                    "showExportToExcel": true,
                    "queryType": 7,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Prioritize AHUB?",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High Priority",
                                "representation": "Sev0",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Sev4",
                                "text": "{0}{1}"
                              }
                            ]
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        }
                      ]
                    },
                    "tileSettings": {
                      "showBorder": false,
                      "titleContent": {
                        "columnMatch": "NewLicense",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "vCPUs",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    },
                    "chartSettings": {
                      "xAxis": "VM Name",
                      "yAxis": [
                        "Consumed Cores per VM"
                      ],
                      "group": null,
                      "createOtherGroup": 0,
                      "seriesLabelSettings": [
                        {
                          "seriesName": "Consumed Cores per VM",
                          "color": "grayBlue"
                        }
                      ]
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "LinuxAHUBDisabled",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "Linux-VM+SKU+vCores-AHUBDisabled"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26168\",\"mergeType\":\"inner\",\"leftTable\":\"Linux VM Latest Change Last 7 days\",\"rightTable\":\"Linux-VM+SKU+vCores-AHUB\",\"leftColumn\":\"VMID\",\"rightColumn\":\"VM ID\"}],\"projectRename\":[{\"originalName\":\"[Linux VM Latest Change Last 7 days].VMID\",\"mergedName\":\"VMID\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux VM Latest Change Last 7 days].NewLicense\",\"mergedName\":\"NewLicense\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux VM Latest Change Last 7 days].DateofChange\",\"mergedName\":\"DateofChange\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].VM ID\",\"mergedName\":\"VM ID\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].Name\",\"mergedName\":\"Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux VM Latest Change Last 7 days].VMID\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].vCPUs\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].OSType\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].OsVersion\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].LicenseType\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].vCPUsPerCore\"}]}",
                    "size": 0,
                    "title": "Linux Total Cores Enabled last 7 Days",
                    "noDataMessage": "There wasn't any Linux AHUB was enabled in the last 7 days.",
                    "showExportToExcel": true,
                    "queryType": 7,
                    "visualization": "table",
                    "tileSettings": {
                      "showBorder": false,
                      "titleContent": {
                        "columnMatch": "NewLicense",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "vCPUs",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    },
                    "chartSettings": {
                      "group": null,
                      "createOtherGroup": 0,
                      "seriesLabelSettings": [
                        {
                          "seriesName": "Consumed Cores per VM",
                          "color": "grayBlue"
                        }
                      ]
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "LinuxEnabledPast7D",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "Linux Total Cores Enabled last 7 Days"
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "SelectedSubTab",
                "comparison": "isEqualTo",
                "value": "LinuxVM"
              },
              {
                "parameterName": "SelectedTab",
                "comparison": "isEqualTo",
                "value": "VM"
              },
              {
                "parameterName": "RG_Filter",
                "comparison": "isEqualTo",
                "value": "Resource Group"
              }
            ],
            "name": "Linux"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Linux Hybrid Benefit",
              "loadType": "explicit",
              "loadButtonText": "Load Linux Recommendations",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "## Linux Azure Hybrid Benefit (AHUB) Overview"
                  },
                  "name": "Linux Text"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualmachines' and (properties.storageProfile.imageReference.publisher == 'suse' or properties.storageProfile.imageReference.publisher=='RedHat')\r\n| where isnotnull ((properties.['licenseType']))\r\n| extend LinuxId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.publisher), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']), VMSSize=tostring(sku.name)\r\n| order by type asc \r\n| project LinuxId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType",
                    "size": 0,
                    "title": "AHUB Enabled-Tag",
                    "noDataMessage": "None of your Linux VMs have AHUB enabled.",
                    "noDataMessageStyle": 4,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "AlwaysHidden",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "LinuxAHUBEnabled-Tag"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualmachines' and (properties.storageProfile.imageReference.publisher == 'suse' or properties.storageProfile.imageReference.publisher=='RedHat')\r\n| where isnull ((properties.['licenseType']))\r\n| extend LinuxId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.publisher), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']), VMSSize=tostring(sku.name)\r\n| order by type asc \r\n| project LinuxId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType",
                    "size": 0,
                    "title": "AHUB Disabled",
                    "noDataMessage": "None of your Linux VMs have AHUB enabled.",
                    "noDataMessageStyle": 4,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "AlwaysHidden",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "LinuxAHUBDisabled-Tag"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualmachines' and (properties.storageProfile.imageReference.publisher == 'suse' or properties.storageProfile.imageReference.publisher=='RedHat')\r\n| extend LicenseType = tostring(properties.['licenseType'])\r\n| extend CheckAHUBLinux = case(\r\n     type == 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets',\r\n     iff(isnull((properties.['licenseType'])),\r\n      \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not Linux\"\r\n     )\r\n| summarize count() by CheckAHUBLinux",
                    "size": 0,
                    "title": "Summary of Linux VMs with or without AHUB",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "visualization": "piechart"
                  },
                  "customWidth": "50",
                  "name": "Summary of Linux VMs with or without AHUB"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "resourcechanges\r\n| where properties.changeType == \"Update\" and properties.targetResourceType == \"microsoft.compute/virtualmachines\"\r\n| mv-expand changes = properties.changes\r\n| mv-expand LicenseChanges=changes.['properties.licenseType']\r\n| where isnotnull(LicenseChanges)\r\n| where  tostring(LicenseChanges.newValue) has \"SLES_BYOS\" or tostring(LicenseChanges.newValue) has \"RHEL_BYOS\"\r\n| project VMID=properties.targetResourceId, NewLicense=tostring(LicenseChanges.newValue), DateofChange=tostring(properties.changeAttributes.timestamp)\r\n",
                    "size": 0,
                    "title": "Linux VM Latest Change Last 7 days",
                    "noDataMessage": "There wasn't any AHUB enabled in the last 7 days.",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "AlwaysHidden",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "Linux VM Latest Change Last 7 days"
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                        "version": "KqlParameterItem/1.0",
                        "name": "LinuxAHUBEnabled",
                        "label": "See Linux VMs with AHUB",
                        "type": 2,
                        "isRequired": true,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": "Yes"
                      },
                      {
                        "id": "439c7c8d-4119-4328-b4ca-2b1e676ede28",
                        "version": "KqlParameterItem/1.0",
                        "name": "LinuxEnabledPast7D",
                        "label": "See Linux VMs enabled last 7 days",
                        "type": 2,
                        "isRequired": true,
                        "typeSettings": {
                          "additionalResourceOptions": [],
                          "showDefault": false
                        },
                        "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": "Yes"
                      },
                      {
                        "id": "4c3ff9fa-d9c8-4d35-94d4-48ba3a1547fd",
                        "version": "KqlParameterItem/1.0",
                        "name": "LinuxAHUBDisabled",
                        "label": "See Linux VMs without AHUB",
                        "type": 2,
                        "isRequired": true,
                        "typeSettings": {
                          "additionalResourceOptions": []
                        },
                        "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "value": "Yes"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "parameters - 13"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "List of Linux VMs with Hybrid Benefit groupped by Subscription."
                  },
                  "conditionalVisibility": {
                    "parameterName": "LinuxAHUBEnabled",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "text - 8"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\",\"mergeType\":\"inner\",\"leftTable\":\"LinuxAHUBEnabled-Tag\",\"rightTable\":\"API-Get_VM_SKU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[LinuxAHUBEnabled-Tag].LinuxId\",\"mergedName\":\"LinuxId\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled-Tag].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled-Tag].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled-Tag].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled-Tag].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled-Tag].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled].VMName\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[LinuxAHUBEnabled].VMSSize\"},{\"originalName\":\"[LinuxAHUBEnabled-Tag].VMName\"},{\"originalName\":\"[LinuxAHUBEnabled-Tag].VMSSize\"}]}",
                    "size": 0,
                    "title": "Linux VMs with AHUB",
                    "noDataMessage": "None of your Linux VMs have AHUB enabled",
                    "noDataMessageStyle": 4,
                    "showExportToExcel": true,
                    "queryType": 7,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Prioritize AHUB?",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High Priority",
                                "representation": "Sev0",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Sev4",
                                "text": "{0}{1}"
                              }
                            ]
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        }
                      ]
                    },
                    "tileSettings": {
                      "showBorder": false,
                      "titleContent": {
                        "columnMatch": "NewLicense",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "vCPUs",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    },
                    "chartSettings": {
                      "xAxis": "VM Name",
                      "yAxis": [
                        "Consumed Cores per VM"
                      ],
                      "group": null,
                      "createOtherGroup": 0,
                      "seriesLabelSettings": [
                        {
                          "seriesName": "Consumed Cores per VM",
                          "color": "grayBlue"
                        }
                      ]
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "LinuxAHUBEnabled",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "Linux-VM+SKU+vCores-AHUB"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "List of Linux VMs without Hybrid Benefit groupped by Subscription."
                  },
                  "conditionalVisibility": {
                    "parameterName": "LinuxAHUBDisabled",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "text - 8 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\",\"mergeType\":\"inner\",\"leftTable\":\"LinuxAHUBDisabled-Tag\",\"rightTable\":\"API-Get_VM_SKU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[LinuxAHUBDisabled-Tag].LinuxId\",\"mergedName\":\"LinuxId\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled-Tag].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled-Tag].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled-Tag].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled-Tag].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled-Tag].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled].VMName\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[LinuxAHUBEnabled].VMSSize\"},{\"originalName\":\"[LinuxAHUBDisabled-Tag].VMName\"},{\"originalName\":\"[LinuxAHUBDisabled-Tag].VMSSize\"}]}",
                    "size": 0,
                    "title": "Linux VMs without AHUB",
                    "noDataMessage": "None of your Linux VMs have AHUB enabled",
                    "noDataMessageStyle": 4,
                    "showExportToExcel": true,
                    "queryType": 7,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Prioritize AHUB?",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "High Priority",
                                "representation": "Sev0",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "Sev4",
                                "text": "{0}{1}"
                              }
                            ]
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        }
                      ]
                    },
                    "tileSettings": {
                      "showBorder": false,
                      "titleContent": {
                        "columnMatch": "NewLicense",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "vCPUs",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    },
                    "chartSettings": {
                      "xAxis": "VM Name",
                      "yAxis": [
                        "Consumed Cores per VM"
                      ],
                      "group": null,
                      "createOtherGroup": 0,
                      "seriesLabelSettings": [
                        {
                          "seriesName": "Consumed Cores per VM",
                          "color": "grayBlue"
                        }
                      ]
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "LinuxAHUBDisabled",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "Linux-VM+SKU+vCores-AHUBDisabled"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26168\",\"mergeType\":\"inner\",\"leftTable\":\"Linux VM Latest Change Last 7 days\",\"rightTable\":\"Linux-VM+SKU+vCores-AHUB\",\"leftColumn\":\"VMID\",\"rightColumn\":\"LinuxId\"}],\"projectRename\":[{\"originalName\":\"[Linux VM Latest Change Last 7 days].VMID\",\"mergedName\":\"VMID\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux VM Latest Change Last 7 days].NewLicense\",\"mergedName\":\"NewLicense\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux VM Latest Change Last 7 days].DateofChange\",\"mergedName\":\"DateofChange\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].LinuxId\",\"mergedName\":\"LinuxId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux VM Latest Change Last 7 days].VMID\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].vCPUs\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].OSType\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].OsVersion\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].LicenseType\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].vCPUsPerCore\"}]}",
                    "size": 0,
                    "title": "Linux Total Cores Enabled last 7 Days",
                    "noDataMessage": "No AHUB has been enabled in the last 7 days.",
                    "showExportToExcel": true,
                    "queryType": 7,
                    "visualization": "table",
                    "tileSettings": {
                      "showBorder": false,
                      "titleContent": {
                        "columnMatch": "NewLicense",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "vCPUs",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "maximumSignificantDigits": 3,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    },
                    "chartSettings": {
                      "group": null,
                      "createOtherGroup": 0,
                      "seriesLabelSettings": [
                        {
                          "seriesName": "Consumed Cores per VM",
                          "color": "grayBlue"
                        }
                      ]
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "LinuxEnabledPast7D",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "Linux Total Cores Enabled last 7 Days"
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "SelectedSubTab",
                "comparison": "isEqualTo",
                "value": "LinuxVM"
              },
              {
                "parameterName": "SelectedTab",
                "comparison": "isEqualTo",
                "value": "VM"
              },
              {
                "parameterName": "RG_Filter",
                "comparison": "isEqualTo",
                "value": "Tags"
              }
            ],
            "name": "Linux - Tag "
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "VMSS",
              "loadType": "explicit",
              "loadButtonText": "Load VMSS Recommendations",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "## Windows Azure Hybrid Benefit (AHUB) Overview - VM Scale Set"
                  },
                  "name": "text - 3"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "Each two-processor license or each set of 16-core licenses, either Datacenter or Standard editions, are entitled to two instances of up to 8 cores, or one instance of up to 16 cores.\r\n\r\nThe virtual machines (VMs) with less than 8 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                    "style": "info"
                  },
                  "name": "text - 4"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualMachineScaleSets'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows' or tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType) == 'Windows'\r\n| where tostring(properties.['licenseType']) !has 'Windows' and tostring(properties.virtualMachineProfile.['licenseType']) !has 'Windows'\r\n| extend WindowsId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType), OsVersion = tostring(properties.virtualMachineProfile.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.virtualMachineProfile.licenseType), VMSSize=tostring(sku.name)\r\n    ) on subscriptionId \r\n| order by type asc \r\n| project WindowsId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType, subscriptionId",
                    "size": 0,
                    "title": "VMSS-AHUB-Disabled",
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "AlwaysHidden",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "VMSS-AHUB-Disabled-Tag"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualMachineScaleSets'\r\n| where tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType) == 'Windows' and tostring(properties.virtualMachineProfile.licenseType) == \"Windows_Server\"\r\n| extend WindowsId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType), OSVersion = tostring(properties.virtualMachineProfile.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.virtualMachineProfile.licenseType), VMSSize=tostring(sku.name)\r\n    ) on subscriptionId \r\n| order by type asc \r\n| project WindowsId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OSVersion,LicenseType, subscriptionId",
                    "size": 0,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "AlwaysHidden",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "VMSSAHUBEnabled-Tag"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{SingleSubHidden}/providers/Microsoft.Compute/skus?$filter=location eq '{Location}'\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2021-07-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*[?(@.resourceType=='virtualMachines')]\",\"columns\":[{\"path\":\"name\",\"columnid\":\"Name\"},{\"path\":\"capabilities[?(@.name=='vCPUs')].value\",\"columnid\":\"vCPUs\"},{\"path\":\"capabilities[?(@.name=='MemoryGB')].value\",\"columnid\":\"MemoryGB\"},{\"path\":\"capabilities[?(@.name=='MaxNetworkInterfaces')].value\",\"columnid\":\"MaxNetworkInterfaces\"},{\"path\":\"capabilities[?(@.name=='HyperVGenerations')].value\",\"columnid\":\"HyperVGenerations\"},{\"path\":\"capabilities[?(@.name=='vCPUsPerCore')].value\",\"columnid\":\"vCPUsPerCore\"}]}}]}",
                    "size": 0,
                    "title": "Get VM vCPU",
                    "exportParameterName": "ResourceSKU",
                    "showExportToExcel": true,
                    "queryType": 12,
                    "gridSettings": {
                      "rowLimit": 5000
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "AlwaysHidden",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "API-Get_VMSS_SKU"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "### Consumed Licenses\r\nTotal number of Windows licenses cores consumed by all Windows virtual machines.\r\n",
                    "style": "info"
                  },
                  "customWidth": "50",
                  "name": "text - 6"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "### Number of required Cores to enable Windows Azure Hybrid Benefit\r\nNumber of cores required to enable AHUB across the entire environment.",
                    "style": "info"
                  },
                  "customWidth": "50",
                  "name": "text - 7"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "loadType": "explicit",
                    "loadButtonText": "Load VMSS Info",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBEnabled-Tag\",\"rightTable\":\"API-Get_VMSS_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\" ([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].OSVersion\",\"mergedName\":\"OSVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"}]}",
                          "size": 0,
                          "title": "Cores not enabled per AHUB Priority",
                          "noDataMessage": "All of your VMs have AHUB enabled",
                          "noDataMessageStyle": 4,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Sev4",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ]
                          },
                          "chartSettings": {
                            "yAxis": [
                              "Consumed Cores per VM"
                            ],
                            "group": "Prioritize AHUB?",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "name": "Cores NOT enabled per AHUB Priority"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBEnabled-Tag\",\"rightTable\":\"API-Get_VMSS_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\" ([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].OSVersion\",\"mergedName\":\"OSVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"}]}",
                          "size": 0,
                          "title": "Consumed Cores per AHUB Priority",
                          "noDataMessage": "None of your VMs have AHUB enabled",
                          "noDataMessageStyle": 4,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Sev4",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ]
                          }
                        },
                        "customWidth": "33",
                        "name": "Consumed Cores per AHUB Priority"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26130\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBEnabled-Tag\",\"rightTable\":\"API-Get_VMSS_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"ConsumedCores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].OSVersion\",\"mergedName\":\"OSVersion\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VMSS_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VMSS_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VMSS_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VMSS_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VMSS_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VMSS_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"}]}",
                          "size": 0,
                          "title": "Consumed Cores per VMSS",
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ConsumedCores",
                                "formatter": 0,
                                "formatOptions": {
                                  "aggregation": "Sum"
                                }
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {},
                            "leftContent": {
                              "columnMatch": "ConsumedCores",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              }
                            },
                            "showBorder": false
                          },
                          "graphSettings": {
                            "type": 0
                          },
                          "chartSettings": {
                            "yAxis": [
                              "ConsumedCores"
                            ],
                            "group": "VMName",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "name": "Consumed Cores per VMSS"
                      }
                    ]
                  },
                  "name": "VMSS RG Overview"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "loadType": "explicit",
                    "loadButtonText": "Load VMSS AHUB Details",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                              "version": "KqlParameterItem/1.0",
                              "name": "VMSSAHUBEnabled",
                              "label": "See VMSS with AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "value": "Yes"
                            },
                            {
                              "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                              "version": "KqlParameterItem/1.0",
                              "name": "VMSSAHUBDisabled",
                              "label": "See VMSS without AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                              "value": "Yes"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBEnabled-Tag\",\"rightTable\":\"API-Get_VM_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"static\",\"resultVal\":\"High Priority\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"Low Priority\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[VMSSAHUBEnabled-Tag].WindowsId\",\"mergedName\":\"VMSS Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].OSVersion\",\"mergedName\":\"OSVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMName\"},{\"originalName\":\"[query - 0].VMSSize\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"},{\"originalName\":\"[WindowsAHUBEnabled].VMName\"},{\"originalName\":\"[VMSSAHUBEnabled].VMSize\"},{\"originalName\":\"[VMSSAHUBEnabled].VMName\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMName\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSize\"}]}",
                          "size": 0,
                          "title": "VMSS with AHUB",
                          "noDataMessage": "None of your VMSS have AHUB enabled",
                          "noDataMessageStyle": 4,
                          "showExportToExcel": true,
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Subscription Name",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              }
                            ],
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "subscriptionId"
                              ],
                              "expandTopLevel": true
                            }
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "VMSSAHUBEnabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "VMSS+SKU+vCores-AHUB"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"VMSS-AHUB-Disabled-Tag\",\"rightTable\":\"API-Get_VMSS_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"static\",\"resultVal\":\"High Priority\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"Low Priority\"}}]},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMName\"},{\"originalName\":\"[query - 0].VMSSize\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[VMSS-AHUB-Disabled].VMName\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMSize\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMName\"}]}",
                          "size": 0,
                          "title": "VMSS without AHUB",
                          "noDataMessage": "All of your VMSS have AHUB enabled",
                          "noDataMessageStyle": 3,
                          "showExportToExcel": true,
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Sev4",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ],
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "subscriptionId"
                              ],
                              "expandTopLevel": true
                            }
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "VMSSAHUBDisabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "VMSS+SKU+vCores"
                      }
                    ]
                  },
                  "name": "VMSS RG Details"
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "SelectedSubTab",
                "comparison": "isEqualTo",
                "value": "VMSS"
              },
              {
                "parameterName": "SelectedTab",
                "comparison": "isEqualTo",
                "value": "VM"
              },
              {
                "parameterName": "RG_Filter",
                "comparison": "isEqualTo",
                "value": "Tags"
              }
            ],
            "name": "VMSS-Tag"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "VMSS",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "## Windows Azure Hybrid Benefit (AHUB) Overview - VM Scale Set"
                  },
                  "name": "text - 3"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "Each two-processor license or each set of 16-core licenses, either Datacenter or Standard editions, are entitled to two instances of up to 8 cores, or one instance of up to 16 cores.\r\n\r\nThe virtual machines (VMs) with less than 8 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                    "style": "info"
                  },
                  "name": "text - 4"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualMachineScaleSets'\r\n| where tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType) == 'Windows' and tostring(properties.virtualMachineProfile.licenseType) == \"Windows_Server\"\r\n| extend WindowsId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType), OSVersion = tostring(properties.virtualMachineProfile.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.virtualMachineProfile.licenseType), VMSSize=tostring(sku.name)\r\n    ) on subscriptionId \r\n| order by type asc \r\n| project WindowsId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OSVersion,LicenseType, subscriptionId",
                    "size": 0,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "LoadVMSSTab",
                      "comparison": "isEqualTo",
                      "value": "Yes"
                    },
                    {
                      "parameterName": "AlwaysHidden",
                      "comparison": "isEqualTo",
                      "value": "True"
                    }
                  ],
                  "name": "VMSSAHUBEnabled-RG"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualMachineScaleSets'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows' or tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType) == 'Windows'\r\n| where tostring(properties.['licenseType']) !has 'Windows' and tostring(properties.virtualMachineProfile.['licenseType']) !has 'Windows'\r\n| extend WindowsId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType), OsVersion = tostring(properties.virtualMachineProfile.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.virtualMachineProfile.licenseType), VMSSize=tostring(sku.name)\r\n    ) on subscriptionId \r\n| order by type asc \r\n| project WindowsId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType, subscriptionId",
                    "size": 0,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "LoadVMSSTab",
                      "comparison": "isEqualTo",
                      "value": "Yes"
                    },
                    {
                      "parameterName": "AlwaysHidden",
                      "comparison": "isEqualTo",
                      "value": "True"
                    }
                  ],
                  "name": "VMSSAHUBDisabled-RG"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "### Consumed Licenses\r\nTotal number of Windows licenses cores consumed by all Windows virtual machines.\r\n",
                    "style": "info"
                  },
                  "customWidth": "50",
                  "name": "text - 6"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "### Number of required Cores to enable Windows Azure Hybrid Benefit\r\nNumber of cores required to enable AHUB across the entire environment.",
                    "style": "info"
                  },
                  "customWidth": "50",
                  "name": "text - 7"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "loadType": "explicit",
                    "loadButtonText": "Load VMSS Info",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBEnabled-RG\",\"rightTable\":\"API-Get_VM_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\" ([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].OSVersion\",\"mergedName\":\"OSVersion\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"unknown\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"unknown\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"unknown\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"unknown\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"unknown\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"unknown\"},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"}]}",
                          "size": 0,
                          "title": "Cores not enabled per AHUB Priority",
                          "noDataMessage": "All of your VMs have AHUB enabled",
                          "noDataMessageStyle": 4,
                          "showRefreshButton": true,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Sev4",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ]
                          },
                          "chartSettings": {
                            "yAxis": [
                              "Consumed Cores per VM"
                            ],
                            "group": "Prioritize AHUB?",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "name": "Cores NOT enabled per AHUB Priority"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBEnabled-RG\",\"rightTable\":\"API-Get_VM_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\" ([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].OSVersion\",\"mergedName\":\"OSVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"}]}",
                          "size": 0,
                          "title": "Consumed Cores per AHUB Priority",
                          "noDataMessage": "None of your VMs have AHUB enabled",
                          "noDataMessageStyle": 4,
                          "showRefreshButton": true,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Sev4",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ]
                          }
                        },
                        "customWidth": "33",
                        "name": "Consumed Cores per AHUB Priority"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26130\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBEnabled-RG\",\"rightTable\":\"API-Get_VM_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"ConsumedCores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].OSVersion\",\"mergedName\":\"OSVersion\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"}]}",
                          "size": 0,
                          "title": "Consumed Cores per VMSS",
                          "showRefreshButton": true,
                          "queryType": 7,
                          "visualization": "piechart",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ConsumedCores",
                                "formatter": 0,
                                "formatOptions": {
                                  "aggregation": "Sum"
                                }
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {},
                            "leftContent": {
                              "columnMatch": "ConsumedCores",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              }
                            },
                            "showBorder": false
                          },
                          "graphSettings": {
                            "type": 0
                          },
                          "chartSettings": {
                            "yAxis": [
                              "ConsumedCores"
                            ],
                            "group": "VMName",
                            "createOtherGroup": null
                          }
                        },
                        "customWidth": "33",
                        "name": "Consumed Cores per VMSS"
                      }
                    ]
                  },
                  "name": "VMSS RG Overview"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                              "version": "KqlParameterItem/1.0",
                              "name": "VMSSAHUBEnabled",
                              "label": "See VMSS with AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                              "version": "KqlParameterItem/1.0",
                              "name": "VMSSAHUBDisabled",
                              "label": "See VMSS without AHUB",
                              "type": 2,
                              "isRequired": true,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBEnabled-RG\",\"rightTable\":\"API-Get_VM_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"static\",\"resultVal\":\"High Priority\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"Low Priority\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[VMSSAHUBEnabled-RG].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].OSVersion\",\"mergedName\":\"OSVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMName\"},{\"originalName\":\"[query - 0].VMSSize\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"},{\"originalName\":\"[WindowsAHUBEnabled].VMName\"},{\"originalName\":\"[VMSSAHUBEnabled].VMSize\"},{\"originalName\":\"[VMSSAHUBEnabled].VMName\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMName\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSize\"}]}",
                          "size": 0,
                          "title": "VMSS with AHUB",
                          "noDataMessage": "None of your VMSS have AHUB enabled",
                          "noDataMessageStyle": 4,
                          "showExportToExcel": true,
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "2",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "subscriptionId",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Subscription Name",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              }
                            ],
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "subscriptionId"
                              ],
                              "expandTopLevel": true
                            }
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "VMSSAHUBEnabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "VMSS+SKU+vCores-AHUB"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBDisabled-RG\",\"rightTable\":\"API-Get_VM_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"static\",\"resultVal\":\"High Priority\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"Low Priority\"}}]},{\"originalName\":\"[VMSSAHUBDisabled-RG].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMName\"},{\"originalName\":\"[query - 0].VMSSize\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[VMSS-AHUB-Disabled].VMName\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMSize\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMName\"}]}",
                          "size": 0,
                          "title": "VMSS without AHUB",
                          "noDataMessage": "All of your VMSS have AHUB enabled",
                          "noDataMessageStyle": 3,
                          "showExportToExcel": true,
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "$gen_group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Group",
                                "formatter": 15,
                                "formatOptions": {
                                  "linkTarget": null,
                                  "showIcon": true
                                }
                              },
                              {
                                "columnMatch": "Prioritize AHUB?",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "High Priority",
                                      "representation": "Sev0",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Sev4",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                },
                                "numberFormat": {
                                  "unit": 17,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              }
                            ],
                            "hierarchySettings": {
                              "treeType": 1,
                              "groupBy": [
                                "subscriptionId"
                              ],
                              "expandTopLevel": true
                            }
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "VMSSAHUBDisabled",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "VMSS+SKU+vCores"
                      }
                    ]
                  },
                  "name": "VMSS RG Details"
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "SelectedSubTab",
                "comparison": "isEqualTo",
                "value": "VMSS"
              },
              {
                "parameterName": "SelectedTab",
                "comparison": "isEqualTo",
                "value": "VM"
              },
              {
                "parameterName": "RG_Filter",
                "comparison": "isEqualTo",
                "value": "Resource Group"
              }
            ],
            "name": "VMSS-RG"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isEqualTo",
        "value": "AHUB"
      },
      "name": "AHUB Overview"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Reservations Overview",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "f2bb2b02-9187-4209-9fb8-eb99c60d9c9d",
                  "version": "KqlParameterItem/1.0",
                  "name": "agreementType",
                  "label": "Agreement Type",
                  "type": 10,
                  "isRequired": true,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[\r\n    {\r\n    \"value\" : \"MCA\",\r\n    \"label\" : \"Microsoft Customer Agreement (MCA)\"\r\n    },\r\n    {\r\n    \"value\" : \"EA\",\r\n    \"label\" : \"Microsoft Enterprise Agreement (EA)\"\r\n    }\r\n]",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "value": "EA"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 0"
          },
          {
            "type": 1,
            "content": {
              "json": "## RBAC Needed\r\n\r\nThis tab will present various reservations-related details.\r\n\r\n\r\n* Consider the following least-privilege (minimum) RBAC permissions to see informations on this tab:\r\n\t* For Enterprise Admin (EA) Customers:\r\n\tEnterprise Administrator (read only) or EA Purchaser. To learn more about how to setup these permissions, check [this link.](https://learn.microsoft.com/en-us/azure/cost-management-billing/manage/understand-ea-roles#organization-structure-and-permissions-by-role)\r\n\t* For Microsoft Customer Agreement (MCA) Customers:\r\n\tBilling profile reader. To learn more about how to setup these permissions, check [this link.](https://learn.microsoft.com/en-us/azure/cost-management-billing/manage/understand-mca-roles#billing-profile-roles-and-tasks)"
            },
            "name": "text - 6"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "1007cfd0-3554-41ea-8e8c-e04d4f67add4",
                  "version": "KqlParameterItem/1.0",
                  "name": "billingAccount",
                  "label": "Billing Account",
                  "type": 2,
                  "isRequired": true,
                  "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/providers/Microsoft.Billing/billingAccounts\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2019-10-01-preview\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"name\",\"columnid\":\"billingAccount\"},{\"path\":\"properties.displayName\",\"columnid\":\"Displayname\"}]}}]}",
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "queryType": 12,
                  "value": "8608480"
                },
                {
                  "id": "38d70cdc-7667-44d8-8a05-f1384c8a92a2",
                  "version": "KqlParameterItem/1.0",
                  "name": "lookBackPeriod",
                  "label": "Look back period",
                  "type": 2,
                  "isRequired": true,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[\r\n    {\r\n    \"value\" : \"Last7Days\",\r\n    \"label\" : \"Last 7 Days\"\r\n    },\r\n    {\r\n    \"value\" : \"Last30Days\",\r\n    \"label\" : \"Last 30 Days\",\r\n    \"selected\" : true\r\n    },\r\n    {\r\n    \"value\" : \"Last60Days\",\r\n    \"label\" : \"Last 60 Days\"\r\n    }\r\n]",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "value": "Last7Days"
                },
                {
                  "id": "9892e53b-bda1-4cb6-a3a1-25de058c4484",
                  "version": "KqlParameterItem/1.0",
                  "name": "scope",
                  "label": "Scope",
                  "type": 10,
                  "isRequired": true,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[\r\n    {\r\n        \"value\": \"properties/scope eq 'Single'\",\r\n        \"label\" : \"Single\",\r\n        \"selected\": true\r\n    },\r\n    {\r\n        \"value\": \"properties/scope eq 'Shared'\",\r\n        \"label\" : \"Shared\",\r\n        \"selected\": true\r\n    }\r\n\r\n]"
                }
              ],
              "style": "pills",
              "queryType": 12
            },
            "conditionalVisibility": {
              "parameterName": "agreementType",
              "comparison": "isNotEqualTo"
            },
            "name": "parameters - 3"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "78948283-c135-4603-b506-a0271660ae26",
                  "version": "KqlParameterItem/1.0",
                  "name": "billingProfile",
                  "label": "Billing profile",
                  "type": 2,
                  "isRequired": true,
                  "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/providers/Microsoft.Billing/billingAccounts/{billingAccount}/billingProfiles\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2020-05-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"name\",\"columnid\":\"Name\"},{\"path\":\"properties.displayName\",\"columnid\":\"DisplayName\"}]}}]}",
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "queryType": 12,
                  "value": null
                }
              ],
              "style": "pills",
              "queryType": 12
            },
            "conditionalVisibility": {
              "parameterName": "agreementType",
              "comparison": "isEqualTo",
              "value": "MCA"
            },
            "name": "parameters - billingProfile"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "5c5c1817-4ccf-438d-a1b4-08ea4451438b",
                  "version": "KqlParameterItem/1.0",
                  "name": "resourceType",
                  "label": "Resource type",
                  "type": 10,
                  "isRequired": true,
                  "typeSettings": {
                    "additionalResourceOptions": []
                  },
                  "jsonData": "[\r\n    {\r\n    \"value\" : \"properties/resourceType eq 'VirtualMachines'\",\r\n    \"label\" : \"VirtualMachines\",\r\n    \"selected\": true\r\n    },\r\n    {\r\n    \"value\" : \"properties/resourceType eq 'SQLDatabases'\",\r\n    \"label\" : \"SQLDatabases\"\r\n    },\r\n    {\r\n    \"value\" : \"properties/resourceType eq 'PostgreSQL'\",\r\n    \"label\" : \"PostgreSQL\"\r\n    },\r\n    {\r\n    \"value\" : \"properties/resourceType eq 'ManagedDisk'\",\r\n    \"label\" : \"ManagedDisk\"\r\n    },\r\n    {\r\n    \"value\" : \"properties/resourceType eq 'MySQL'\",\r\n    \"label\" : \"MySQL\"\r\n    },\r\n    {\r\n    \"value\" : \"properties/resourceType eq 'RedHat'\",\r\n    \"label\" : \"RedHat\"\r\n    },\r\n    {\r\n    \"value\" : \"properties/resourceType eq 'MariaDB'\",\r\n    \"label\" : \"MariaDB\"\r\n    },\r\n    {\r\n    \"value\" : \"properties/resourceType eq 'RedisCache'\",\r\n    \"label\" : \"RedisCache\"\r\n    },\r\n    {\r\n    \"value\" : \"properties/resourceType eq 'CosmosDB'\",\r\n    \"label\" : \"CosmosDB\"\r\n    },\r\n    {\r\n    \"value\" : \"properties/resourceType eq 'CosmosDB'\",\r\n    \"label\" : \"CosmosDB\"\r\n    },\r\n    {\r\n    \"value\" : \"properties/resourceType eq 'SUSELinux'\",\r\n    \"label\" : \"SUSELinux\"\r\n    },\r\n    {\r\n    \"value\" : \"properties/resourceType eq 'AppService'\",\r\n    \"label\" : \"AppService\"\r\n    },\r\n    {\r\n    \"value\" : \"properties/resourceType eq 'BlockBlob'\",\r\n    \"label\" : \"BlockBlob\"\r\n    },\r\n    {\r\n    \"value\" : \"properties/resourceType eq 'AzureDataExplorer'\",\r\n    \"label\" : \"AzureDataExplorer\"\r\n    },\r\n    {\r\n    \"value\" : \"properties/resourceType eq 'VMwareCloudSimple'\",\r\n    \"label\" : \"VMwareCloudSimple\"\r\n    }\r\n]",
                  "timeContext": {
                    "durationMs": 86400000
                  }
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 4"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Reservations recommendations",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/providers/Microsoft.Billing/billingAccounts/{billingAccount}/billingProfiles/{billingProfile}/providers/Microsoft.Consumption/reservationRecommendations?$filter=properties/lookBackPeriod  eq '{lookBackPeriod}' AND {resourceType:escapejson} AND {scope:escapejson} \",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2021-10-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"properties.term\",\"columnid\":\"Term\"},{\"path\":\"properties.scope\",\"columnid\":\"Scope\"},{\"path\":\"properties.subscriptionId\",\"columnid\":\"Subscription\"},{\"path\":\"sku\",\"columnid\":\"SKU\"},{\"path\":\"location\",\"columnid\":\"Location\"},{\"path\":\"properties.recommendedQuantity\",\"columnid\":\"Quantity\"},{\"path\":\"properties.costWithNoReservedInstances\",\"columnid\":\"CostWithoutRI\"},{\"path\":\"properties.totalCostWithReservedInstances\",\"columnid\":\"CostWithRI\"},{\"path\":\"properties.netSavings\",\"columnid\":\"Savings\"},{\"path\":\"properties.lookBackPeriod\",\"columnid\":\"LookBackPeriod\"}]}}]}",
                    "size": 0,
                    "title": "Reservations recommendations",
                    "queryType": 12,
                    "gridSettings": {
                      "filter": true
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "isVisible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "query - reservationRecommendations-MCA"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"06a2581c-98e0-4a40-a99e-45ea9b8f116f\",\"mergeType\":\"table\",\"leftTable\":\"query - reservationRecommendations-MCA\"}],\"projectRename\":[{\"originalName\":\"[query - reservationRecommendations-MCA].Term\",\"mergedName\":\"Term\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f116f\"},{\"originalName\":\"[query - reservationRecommendations-MCA].Scope\",\"mergedName\":\"Scope\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f116f\"},{\"originalName\":\"[query - reservationRecommendations-MCA].Subscription\",\"mergedName\":\"Subscription\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f116f\"},{\"originalName\":\"[query - reservationRecommendations-MCA].SKU\",\"mergedName\":\"SKU\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f116f\"},{\"originalName\":\"[query - reservationRecommendations-MCA].Location\",\"mergedName\":\"Location\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f116f\"},{\"originalName\":\"[query - reservationRecommendations-MCA].Quantity\",\"mergedName\":\"Quantity\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f116f\"},{\"originalName\":\"[query - reservationRecommendations-MCA].CostWithoutRI\",\"mergedName\":\"CostWithoutRI\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f116f\"},{\"originalName\":\"[query - reservationRecommendations-MCA].CostWithRI\",\"mergedName\":\"CostWithRI\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f116f\"},{\"originalName\":\"[query - reservationRecommendations-MCA].Savings\",\"mergedName\":\"Savings\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f116f\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Breakeven point (Months)\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"Term\",\"operator\":\"==\",\"rightValType\":\"static\",\"rightVal\":\"P1Y\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"CostWithRI\\\"]*12/[\\\"CostWithoutRI\\\"],0)\"}},{\"criteriaContext\":{\"leftOperand\":\"Term\",\"operator\":\"==\",\"rightValType\":\"static\",\"rightVal\":\"P3Y\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"CostWithRI\\\"]*12*3/[\\\"CostWithoutRI\\\"],0)\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"column\"}}]},{\"originalName\":\"[query - reservationRecommendations-MCA].LookBackPeriod\",\"mergedName\":\"LookBackPeriod\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f116f\"}]}",
                    "size": 0,
                    "queryType": 7
                  },
                  "showPin": false,
                  "name": "query - 1"
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "agreementType",
                "comparison": "isEqualTo",
                "value": "MCA"
              },
              {
                "parameterName": "billingAccount",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "group - MCA"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Reservations recommendations",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/providers/Microsoft.Billing/billingAccounts/{billingAccount}//providers/Microsoft.Consumption/reservationRecommendations?$filter=properties/lookBackPeriod  eq '{lookBackPeriod}' AND {resourceType:escapejson} AND {scope:escapejson} \",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2021-10-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"properties.term\",\"columnid\":\"Term\"},{\"path\":\"properties.scope\",\"columnid\":\"Scope\"},{\"path\":\"properties.subscriptionId\",\"columnid\":\"Subscription\"},{\"path\":\"sku\",\"columnid\":\"SKU\"},{\"path\":\"location\",\"columnid\":\"Location\"},{\"path\":\"properties.recommendedQuantity\",\"columnid\":\"Quantity\"},{\"path\":\"properties.costWithNoReservedInstances\",\"columnid\":\"CostWithoutRI\"},{\"path\":\"properties.totalCostWithReservedInstances\",\"columnid\":\"CostWithRI\"},{\"path\":\"properties.netSavings\",\"columnid\":\"Savings\"},{\"path\":\"properties.lookBackPeriod\",\"columnid\":\"LookBackPeriod\"}]}}]}",
                    "size": 0,
                    "title": "Reservations recommendations",
                    "noDataMessage": "No reservation recommendations found!",
                    "showExportToExcel": true,
                    "queryType": 12,
                    "gridSettings": {
                      "filter": true
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "isVisible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "query - reservationRecommendations"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "ResourceContainers  | where type =~ 'Microsoft.Resources/subscriptions' | project SubscriptionName = name, subscriptionId ",
                    "size": 0,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "AlwaysHidden",
                    "comparison": "isEqualTo",
                    "value": "True"
                  },
                  "name": "SubNameMapping-Hidden"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"06a2581c-98e0-4a40-a99e-45ea9b8f12ad\",\"mergeType\":\"table\",\"leftTable\":\"query - reservationRecommendations\"}],\"projectRename\":[{\"originalName\":\"[query - reservationRecommendations].Term\",\"mergedName\":\"Term\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f12ad\"},{\"originalName\":\"[query - reservationRecommendations].Scope\",\"mergedName\":\"Scope\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f12ad\"},{\"originalName\":\"[query - reservationRecommendations].Subscription\",\"mergedName\":\"Subscription\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f12ad\"},{\"originalName\":\"[query - reservationRecommendations].SKU\",\"mergedName\":\"SKU\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f12ad\"},{\"originalName\":\"[query - reservationRecommendations].Location\",\"mergedName\":\"Location\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f12ad\"},{\"originalName\":\"[query - reservationRecommendations].Quantity\",\"mergedName\":\"Quantity\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f12ad\"},{\"originalName\":\"[query - reservationRecommendations].CostWithoutRI\",\"mergedName\":\"CostWithoutRI\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f12ad\"},{\"originalName\":\"[query - reservationRecommendations].CostWithRI\",\"mergedName\":\"CostWithRI\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f12ad\"},{\"originalName\":\"[query - reservationRecommendations].Savings\",\"mergedName\":\"Savings\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f12ad\"},{\"originalName\":\"[query - reservationRecommendations].LookBackPeriod\",\"mergedName\":\"LookBackPeriod\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f12ad\"}]}",
                    "size": 0,
                    "title": "Top savings by Sku",
                    "queryType": 7,
                    "visualization": "barchart",
                    "chartSettings": {
                      "xAxis": "SKU",
                      "yAxis": [
                        "CostWithRI"
                      ],
                      "group": "SKU",
                      "createOtherGroup": 50,
                      "showLegend": true
                    }
                  },
                  "showPin": false,
                  "name": "query - SavingsChart"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"06a2581c-98e0-4a40-a99e-45ea9b8f10de\",\"mergeType\":\"leftouter\",\"leftTable\":\"query - reservationRecommendations\",\"rightTable\":\"SubNameMapping-Hidden\",\"leftColumn\":\"Subscription\",\"rightColumn\":\"subscriptionId\"}],\"projectRename\":[{\"originalName\":\"[SubNameMapping-Hidden].SubscriptionName\",\"mergedName\":\"SubscriptionName1\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f10de\"},{\"originalName\":\"SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - reservationRecommendations].LookBackPeriod\",\"mergedName\":\"LookBackPeriod\",\"fromId\":\"unknown\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Breakeven point (Months)\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"Term\",\"operator\":\"==\",\"rightValType\":\"static\",\"rightVal\":\"P1Y\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"CostWithRI\\\"]*12/[\\\"CostWithoutRI\\\"],0)\"}},{\"criteriaContext\":{\"leftOperand\":\"Term\",\"operator\":\"==\",\"rightValType\":\"static\",\"rightVal\":\"P3Y\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"CostWithRI\\\"]*12*3/[\\\"CostWithoutRI\\\"],0)\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"column\"}}]},{\"originalName\":\"subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - reservationRecommendations].Term\",\"mergedName\":\"Term\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f10de\"},{\"originalName\":\"[query - reservationRecommendations].Scope\",\"mergedName\":\"Scope\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f10de\"},{\"originalName\":\"[query - reservationRecommendations].Subscription\",\"mergedName\":\"Subscription\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f10de\"},{\"originalName\":\"[query - reservationRecommendations].SKU\",\"mergedName\":\"SKU\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f10de\"},{\"originalName\":\"[query - reservationRecommendations].Location\",\"mergedName\":\"Location\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f10de\"},{\"originalName\":\"[query - reservationRecommendations].Quantity\",\"mergedName\":\"Quantity\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f10de\"},{\"originalName\":\"[query - reservationRecommendations].CostWithoutRI\",\"mergedName\":\"CostWithoutRI\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f10de\"},{\"originalName\":\"[query - reservationRecommendations].CostWithRI\",\"mergedName\":\"CostWithRI\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f10de\"},{\"originalName\":\"[query - reservationRecommendations].Savings\",\"mergedName\":\"Savings\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f10de\"},{\"originalName\":\"[SubNameMapping-Hidden].subscriptionId\",\"mergedName\":\"subscriptionId1\",\"fromId\":\"06a2581c-98e0-4a40-a99e-45ea9b8f10de\"},{\"originalName\":\"[query - Get All subscriptions].zones\"},{\"originalName\":\"[query - Get All subscriptions].identity\"},{\"originalName\":\"[query - Get All subscriptions].tags\"},{\"originalName\":\"[query - Get All subscriptions].properties\"},{\"originalName\":\"[query - Get All subscriptions].plan\"},{\"originalName\":\"[query - Get All subscriptions].sku\"},{\"originalName\":\"[query - Get All subscriptions].managedBy\"},{\"originalName\":\"[query - Get All subscriptions].resourceGroup\"},{\"originalName\":\"[query - Get All subscriptions].location\"},{\"originalName\":\"[query - Get All subscriptions].kind\"},{\"originalName\":\"[query - Get All subscriptions].tenantId\"},{\"originalName\":\"[query - Get All subscriptions].type\"},{\"originalName\":\"[query - Get All subscriptions].subscriptionId\"},{\"originalName\":\"[query - Get All subscriptions].extendedLocation\"},{\"originalName\":\"[query - Get All subscriptions].name\"},{\"originalName\":\"[query - Get All subscriptions].id\"}]}",
                    "size": 0,
                    "title": "Reservations recommendations",
                    "queryType": 7,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Group",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "CostWithRI",
                          "formatter": 0,
                          "formatOptions": {
                            "aggregation": "Sum"
                          }
                        }
                      ],
                      "hierarchySettings": {
                        "treeType": 1,
                        "groupBy": [
                          "Term",
                          "SubscriptionName1"
                        ]
                      }
                    },
                    "sortBy": []
                  },
                  "name": "query - Reservations recommendations"
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "agreementType",
                "comparison": "isEqualTo",
                "value": "EA"
              },
              {
                "parameterName": "billingAccount",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "group - EA"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isEqualTo",
        "value": "Reservations"
      },
      "name": "Reservations Overview"
    }
  ],
  "fallbackResourceIds": [
    "Azure Monitor"
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}
